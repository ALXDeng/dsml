=== RUN   TestInitCommunicator
--- PASS: TestInitCommunicator (0.01s)
=== RUN   TestMemcpyToGPUs
--- PASS: TestMemcpyToGPUs (0.01s)
=== RUN   TestGroupOperations
--- PASS: TestGroupOperations (0.02s)
=== RUN   TestAllReduce
--- PASS: TestAllReduce (0.15s)
=== RUN   TestStatusChecking
--- PASS: TestStatusChecking (0.02s)
=== RUN   TestMemcpyFromGPU
--- PASS: TestMemcpyFromGPU (0.01s)
=== RUN   TestCompleteWorkflow
--- PASS: TestCompleteWorkflow (0.15s)
=== RUN   TestNaiveAllReduce
    gpu_test.go:987: Initializing device 0 with value 1.000000
    gpu_test.go:987: Initializing device 1 with value 2.000000
    gpu_test.go:987: Initializing device 2 with value 3.000000
    gpu_test.go:987: Initializing device 3 with value 4.000000
2024/12/17 17:36:11 Naive AllReduce: Gathering all data to device 0 (data size: 64 bytes)
2024/12/17 17:36:11 Gathered and reduced data from device 1
2024/12/17 17:36:11 Gathered and reduced data from device 2
2024/12/17 17:36:11 Gathered and reduced data from device 3
2024/12/17 17:36:11 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:11 Broadcast complete to device 1
2024/12/17 17:36:11 Broadcast complete to device 2
2024/12/17 17:36:11 Broadcast complete to device 3
    gpu_test.go:1048: Device 0 results verified
    gpu_test.go:1048: Device 1 results verified
    gpu_test.go:1048: Device 2 results verified
    gpu_test.go:1048: Device 3 results verified
--- PASS: TestNaiveAllReduce (0.04s)
=== RUN   TestAllReducePerformance
=== RUN   TestAllReducePerformance/Tiny
    gpu_test.go:1267: Running Tiny size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:11 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:11 Gathered and reduced data from device 1
2024/12/17 17:36:11 Gathered and reduced data from device 2
2024/12/17 17:36:11 Gathered and reduced data from device 3
2024/12/17 17:36:11 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:11 Broadcast complete to device 1
2024/12/17 17:36:11 Broadcast complete to device 2
2024/12/17 17:36:11 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.221708ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 28.420917ms
    gpu_test.go:1267: Running Tiny size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:11 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:11 Gathered and reduced data from device 1
2024/12/17 17:36:11 Gathered and reduced data from device 2
2024/12/17 17:36:11 Gathered and reduced data from device 3
2024/12/17 17:36:11 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:11 Broadcast complete to device 1
2024/12/17 17:36:11 Broadcast complete to device 2
2024/12/17 17:36:11 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.126792ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 20.574458ms
    gpu_test.go:1267: Running Tiny size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:11 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:11 Gathered and reduced data from device 1
2024/12/17 17:36:11 Gathered and reduced data from device 2
2024/12/17 17:36:11 Gathered and reduced data from device 3
2024/12/17 17:36:11 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:11 Broadcast complete to device 1
2024/12/17 17:36:11 Broadcast complete to device 2
2024/12/17 17:36:11 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.298917ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 24.748709ms
    gpu_test.go:1267: Running Tiny size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:11 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:12 Gathered and reduced data from device 1
2024/12/17 17:36:12 Gathered and reduced data from device 2
2024/12/17 17:36:12 Gathered and reduced data from device 3
2024/12/17 17:36:12 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:12 Broadcast complete to device 1
2024/12/17 17:36:12 Broadcast complete to device 2
2024/12/17 17:36:12 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 9.112583ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 25.163541ms
    gpu_test.go:1267: Running Tiny size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:12 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:12 Gathered and reduced data from device 1
2024/12/17 17:36:12 Gathered and reduced data from device 2
2024/12/17 17:36:12 Gathered and reduced data from device 3
2024/12/17 17:36:12 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:12 Broadcast complete to device 1
2024/12/17 17:36:12 Broadcast complete to device 2
2024/12/17 17:36:12 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 1.899834ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 24.72175ms
    gpu_test.go:1358: 
        Performance comparison for Tiny size (1000 elements, 0.01 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 4.331966ms
    gpu_test.go:1361: Ring AllReduce:  24.725875ms
    gpu_test.go:1362: Speedup: 0.18x
=== RUN   TestAllReducePerformance/Small
    gpu_test.go:1267: Running Small size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:12 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:12 Gathered and reduced data from device 1
2024/12/17 17:36:12 Gathered and reduced data from device 2
2024/12/17 17:36:12 Gathered and reduced data from device 3
2024/12/17 17:36:12 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:12 Broadcast complete to device 1
2024/12/17 17:36:12 Broadcast complete to device 2
2024/12/17 17:36:12 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 16.921625ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 26.874792ms
    gpu_test.go:1267: Running Small size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:12 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:12 Gathered and reduced data from device 1
2024/12/17 17:36:12 Gathered and reduced data from device 2
2024/12/17 17:36:12 Gathered and reduced data from device 3
2024/12/17 17:36:12 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:12 Broadcast complete to device 1
2024/12/17 17:36:12 Broadcast complete to device 2
2024/12/17 17:36:12 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.427125ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 27.519625ms
    gpu_test.go:1267: Running Small size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:12 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:12 Gathered and reduced data from device 1
2024/12/17 17:36:12 Gathered and reduced data from device 2
2024/12/17 17:36:12 Gathered and reduced data from device 3
2024/12/17 17:36:12 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:12 Broadcast complete to device 1
2024/12/17 17:36:12 Broadcast complete to device 2
2024/12/17 17:36:12 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.121875ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 31.552208ms
    gpu_test.go:1267: Running Small size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:12 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:12 Gathered and reduced data from device 1
2024/12/17 17:36:12 Gathered and reduced data from device 2
2024/12/17 17:36:12 Gathered and reduced data from device 3
2024/12/17 17:36:12 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:12 Broadcast complete to device 1
2024/12/17 17:36:12 Broadcast complete to device 2
2024/12/17 17:36:12 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.905917ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 31.726625ms
    gpu_test.go:1267: Running Small size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:12 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:12 Gathered and reduced data from device 1
2024/12/17 17:36:12 Gathered and reduced data from device 2
2024/12/17 17:36:12 Gathered and reduced data from device 3
2024/12/17 17:36:12 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:12 Broadcast complete to device 1
2024/12/17 17:36:12 Broadcast complete to device 2
2024/12/17 17:36:12 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.672ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 21.500125ms
    gpu_test.go:1358: 
        Performance comparison for Small size (10000 elements, 0.08 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 6.609708ms
    gpu_test.go:1361: Ring AllReduce:  27.834675ms
    gpu_test.go:1362: Speedup: 0.24x
=== RUN   TestAllReducePerformance/Medium
    gpu_test.go:1267: Running Medium size iteration 1/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:13 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:13 Gathered and reduced data from device 1
2024/12/17 17:36:13 Gathered and reduced data from device 2
2024/12/17 17:36:13 Gathered and reduced data from device 3
2024/12/17 17:36:13 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:13 Broadcast complete to device 1
2024/12/17 17:36:13 Broadcast complete to device 2
2024/12/17 17:36:13 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 11.85425ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 36.978625ms
    gpu_test.go:1267: Running Medium size iteration 2/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:13 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:13 Gathered and reduced data from device 1
2024/12/17 17:36:13 Gathered and reduced data from device 2
2024/12/17 17:36:13 Gathered and reduced data from device 3
2024/12/17 17:36:13 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:13 Broadcast complete to device 1
2024/12/17 17:36:13 Broadcast complete to device 2
2024/12/17 17:36:13 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 50.6735ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 42.702ms
    gpu_test.go:1267: Running Medium size iteration 3/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:13 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:13 Gathered and reduced data from device 1
2024/12/17 17:36:13 Gathered and reduced data from device 2
2024/12/17 17:36:13 Gathered and reduced data from device 3
2024/12/17 17:36:13 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:13 Broadcast complete to device 1
2024/12/17 17:36:13 Broadcast complete to device 2
2024/12/17 17:36:13 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 74.090916ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 62.642584ms
    gpu_test.go:1358: 
        Performance comparison for Medium size (50000 elements, 0.38 MB), averaged over 3 iterations:
    gpu_test.go:1360: Naive AllReduce: 45.539555ms
    gpu_test.go:1361: Ring AllReduce:  47.441069ms
    gpu_test.go:1362: Speedup: 0.96x
=== RUN   TestAllReducePerformance/Large
    gpu_test.go:1267: Running Large size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:36:13 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:36:13 Gathered and reduced data from device 1
2024/12/17 17:36:13 Gathered and reduced data from device 2
2024/12/17 17:36:13 Gathered and reduced data from device 3
2024/12/17 17:36:13 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:13 Broadcast complete to device 1
2024/12/17 17:36:13 Broadcast complete to device 2
2024/12/17 17:36:13 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 132.365833ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 77.911792ms
    gpu_test.go:1267: Running Large size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:36:14 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:36:14 Gathered and reduced data from device 1
2024/12/17 17:36:14 Gathered and reduced data from device 2
2024/12/17 17:36:14 Gathered and reduced data from device 3
2024/12/17 17:36:14 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:14 Broadcast complete to device 1
2024/12/17 17:36:14 Broadcast complete to device 2
2024/12/17 17:36:14 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 40.627375ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 52.910834ms
    gpu_test.go:1358: 
        Performance comparison for Large size (100000 elements, 0.76 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 86.496604ms
    gpu_test.go:1361: Ring AllReduce:  65.411313ms
    gpu_test.go:1362: Speedup: 1.32x
=== RUN   TestAllReducePerformance/XLarge
    gpu_test.go:1267: Running XLarge size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:36:14 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:36:14 Gathered and reduced data from device 1
2024/12/17 17:36:14 Gathered and reduced data from device 2
2024/12/17 17:36:14 Gathered and reduced data from device 3
2024/12/17 17:36:14 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:14 Broadcast complete to device 1
2024/12/17 17:36:14 Broadcast complete to device 2
2024/12/17 17:36:14 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 36.180333ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 62.377666ms
    gpu_test.go:1267: Running XLarge size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:36:14 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:36:14 Gathered and reduced data from device 1
2024/12/17 17:36:14 Gathered and reduced data from device 2
2024/12/17 17:36:14 Gathered and reduced data from device 3
2024/12/17 17:36:14 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:14 Broadcast complete to device 1
2024/12/17 17:36:15 Broadcast complete to device 2
2024/12/17 17:36:15 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 329.000292ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 140.447375ms
    gpu_test.go:1358: 
        Performance comparison for XLarge size (200000 elements, 1.53 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 182.590312ms
    gpu_test.go:1361: Ring AllReduce:  101.41252ms
    gpu_test.go:1362: Speedup: 1.80x
=== RUN   TestAllReducePerformance/XXLarge
    gpu_test.go:1267: Running XXLarge size iteration 1/1...
    gpu_test.go:1305: Starting Naive AllReduce for size XXLarge...
2024/12/17 17:36:15 Naive AllReduce: Gathering all data to device 0 (data size: 3200000 bytes)
2024/12/17 17:36:15 Gathered and reduced data from device 1
2024/12/17 17:36:15 Gathered and reduced data from device 2
2024/12/17 17:36:15 Gathered and reduced data from device 3
2024/12/17 17:36:15 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:15 Broadcast complete to device 1
2024/12/17 17:36:15 Broadcast complete to device 2
2024/12/17 17:36:15 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 32.024084ms
    gpu_test.go:1322: Starting Ring AllReduce for size XXLarge...
    gpu_test.go:1343: Ring completed in 179.575875ms
    gpu_test.go:1358: 
        Performance comparison for XXLarge size (400000 elements, 3.05 MB), averaged over 1 iterations:
    gpu_test.go:1360: Naive AllReduce: 32.024084ms
    gpu_test.go:1361: Ring AllReduce:  179.575875ms
    gpu_test.go:1362: Speedup: 0.18x
--- PASS: TestAllReducePerformance (4.66s)
    --- PASS: TestAllReducePerformance/Tiny (0.89s)
    --- PASS: TestAllReducePerformance/Small (0.78s)
    --- PASS: TestAllReducePerformance/Medium (0.69s)
    --- PASS: TestAllReducePerformance/Large (0.64s)
    --- PASS: TestAllReducePerformance/XLarge (1.01s)
    --- PASS: TestAllReducePerformance/XXLarge (0.64s)
PASS
ok  	dsml/pkg/tests	5.107s
=== RUN   TestInitCommunicator
--- PASS: TestInitCommunicator (0.01s)
=== RUN   TestMemcpyToGPUs
--- PASS: TestMemcpyToGPUs (0.00s)
=== RUN   TestGroupOperations
--- PASS: TestGroupOperations (0.00s)
=== RUN   TestAllReduce
--- PASS: TestAllReduce (0.14s)
=== RUN   TestStatusChecking
--- PASS: TestStatusChecking (0.03s)
=== RUN   TestMemcpyFromGPU
--- PASS: TestMemcpyFromGPU (0.01s)
=== RUN   TestCompleteWorkflow
--- PASS: TestCompleteWorkflow (0.15s)
=== RUN   TestNaiveAllReduce
    gpu_test.go:987: Initializing device 0 with value 1.000000
    gpu_test.go:987: Initializing device 1 with value 2.000000
    gpu_test.go:987: Initializing device 2 with value 3.000000
    gpu_test.go:987: Initializing device 3 with value 4.000000
2024/12/17 17:36:16 Naive AllReduce: Gathering all data to device 0 (data size: 64 bytes)
2024/12/17 17:36:16 Gathered and reduced data from device 1
2024/12/17 17:36:16 Gathered and reduced data from device 2
2024/12/17 17:36:16 Gathered and reduced data from device 3
2024/12/17 17:36:16 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:16 Broadcast complete to device 1
2024/12/17 17:36:16 Broadcast complete to device 2
2024/12/17 17:36:16 Broadcast complete to device 3
    gpu_test.go:1048: Device 0 results verified
    gpu_test.go:1048: Device 1 results verified
    gpu_test.go:1048: Device 2 results verified
    gpu_test.go:1048: Device 3 results verified
--- PASS: TestNaiveAllReduce (0.02s)
=== RUN   TestAllReducePerformance
=== RUN   TestAllReducePerformance/Tiny
    gpu_test.go:1267: Running Tiny size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:16 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:16 Gathered and reduced data from device 1
2024/12/17 17:36:16 Gathered and reduced data from device 2
2024/12/17 17:36:16 Gathered and reduced data from device 3
2024/12/17 17:36:16 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:16 Broadcast complete to device 1
2024/12/17 17:36:16 Broadcast complete to device 2
2024/12/17 17:36:16 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.906084ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 26.8545ms
    gpu_test.go:1267: Running Tiny size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:17 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:17 Gathered and reduced data from device 1
2024/12/17 17:36:17 Gathered and reduced data from device 2
2024/12/17 17:36:17 Gathered and reduced data from device 3
2024/12/17 17:36:17 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:17 Broadcast complete to device 1
2024/12/17 17:36:17 Broadcast complete to device 2
2024/12/17 17:36:17 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.050209ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 28.670291ms
    gpu_test.go:1267: Running Tiny size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:17 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:17 Gathered and reduced data from device 1
2024/12/17 17:36:17 Gathered and reduced data from device 2
2024/12/17 17:36:17 Gathered and reduced data from device 3
2024/12/17 17:36:17 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:17 Broadcast complete to device 1
2024/12/17 17:36:17 Broadcast complete to device 2
2024/12/17 17:36:17 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.234875ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 28.513417ms
    gpu_test.go:1267: Running Tiny size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:17 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:17 Gathered and reduced data from device 1
2024/12/17 17:36:17 Gathered and reduced data from device 2
2024/12/17 17:36:17 Gathered and reduced data from device 3
2024/12/17 17:36:17 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:17 Broadcast complete to device 1
2024/12/17 17:36:17 Broadcast complete to device 2
2024/12/17 17:36:17 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.463875ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 34.972959ms
    gpu_test.go:1267: Running Tiny size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:17 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:17 Gathered and reduced data from device 1
2024/12/17 17:36:17 Gathered and reduced data from device 2
2024/12/17 17:36:17 Gathered and reduced data from device 3
2024/12/17 17:36:17 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:17 Broadcast complete to device 1
2024/12/17 17:36:17 Broadcast complete to device 2
2024/12/17 17:36:17 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.241792ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 24.005833ms
    gpu_test.go:1358: 
        Performance comparison for Tiny size (1000 elements, 0.01 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 3.779367ms
    gpu_test.go:1361: Ring AllReduce:  28.6034ms
    gpu_test.go:1362: Speedup: 0.13x
=== RUN   TestAllReducePerformance/Small
    gpu_test.go:1267: Running Small size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:17 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:17 Gathered and reduced data from device 1
2024/12/17 17:36:17 Gathered and reduced data from device 2
2024/12/17 17:36:17 Gathered and reduced data from device 3
2024/12/17 17:36:17 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:17 Broadcast complete to device 1
2024/12/17 17:36:17 Broadcast complete to device 2
2024/12/17 17:36:17 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.500791ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 28.913542ms
    gpu_test.go:1267: Running Small size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:17 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:17 Gathered and reduced data from device 1
2024/12/17 17:36:17 Gathered and reduced data from device 2
2024/12/17 17:36:17 Gathered and reduced data from device 3
2024/12/17 17:36:17 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:17 Broadcast complete to device 1
2024/12/17 17:36:17 Broadcast complete to device 2
2024/12/17 17:36:17 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.129542ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 37.365792ms
    gpu_test.go:1267: Running Small size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:18 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:18 Gathered and reduced data from device 1
2024/12/17 17:36:18 Gathered and reduced data from device 2
2024/12/17 17:36:18 Gathered and reduced data from device 3
2024/12/17 17:36:18 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:18 Broadcast complete to device 1
2024/12/17 17:36:18 Broadcast complete to device 2
2024/12/17 17:36:18 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 6.77125ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 45.311209ms
    gpu_test.go:1267: Running Small size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:18 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:18 Gathered and reduced data from device 1
2024/12/17 17:36:18 Gathered and reduced data from device 2
2024/12/17 17:36:18 Gathered and reduced data from device 3
2024/12/17 17:36:18 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:18 Broadcast complete to device 1
2024/12/17 17:36:18 Broadcast complete to device 2
2024/12/17 17:36:18 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.703833ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 23.070292ms
    gpu_test.go:1267: Running Small size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:18 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:18 Gathered and reduced data from device 1
2024/12/17 17:36:18 Gathered and reduced data from device 2
2024/12/17 17:36:18 Gathered and reduced data from device 3
2024/12/17 17:36:18 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:18 Broadcast complete to device 1
2024/12/17 17:36:18 Broadcast complete to device 2
2024/12/17 17:36:18 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 8.237417ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 27.620667ms
    gpu_test.go:1358: 
        Performance comparison for Small size (10000 elements, 0.08 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 6.268566ms
    gpu_test.go:1361: Ring AllReduce:  32.4563ms
    gpu_test.go:1362: Speedup: 0.19x
=== RUN   TestAllReducePerformance/Medium
    gpu_test.go:1267: Running Medium size iteration 1/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:18 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:18 Gathered and reduced data from device 1
2024/12/17 17:36:18 Gathered and reduced data from device 2
2024/12/17 17:36:18 Gathered and reduced data from device 3
2024/12/17 17:36:18 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:18 Broadcast complete to device 1
2024/12/17 17:36:18 Broadcast complete to device 2
2024/12/17 17:36:18 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 25.59ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 33.067542ms
    gpu_test.go:1267: Running Medium size iteration 2/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:18 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:18 Gathered and reduced data from device 1
2024/12/17 17:36:18 Gathered and reduced data from device 2
2024/12/17 17:36:18 Gathered and reduced data from device 3
2024/12/17 17:36:18 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:18 Broadcast complete to device 1
2024/12/17 17:36:18 Broadcast complete to device 2
2024/12/17 17:36:18 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 36.708167ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 33.127834ms
    gpu_test.go:1267: Running Medium size iteration 3/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:19 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:19 Gathered and reduced data from device 1
2024/12/17 17:36:19 Gathered and reduced data from device 2
2024/12/17 17:36:19 Gathered and reduced data from device 3
2024/12/17 17:36:19 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:19 Broadcast complete to device 1
2024/12/17 17:36:19 Broadcast complete to device 2
2024/12/17 17:36:19 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.349166ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 26.792042ms
    gpu_test.go:1358: 
        Performance comparison for Medium size (50000 elements, 0.38 MB), averaged over 3 iterations:
    gpu_test.go:1360: Naive AllReduce: 22.215777ms
    gpu_test.go:1361: Ring AllReduce:  30.995806ms
    gpu_test.go:1362: Speedup: 0.72x
=== RUN   TestAllReducePerformance/Large
    gpu_test.go:1267: Running Large size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:36:19 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:36:19 Gathered and reduced data from device 1
2024/12/17 17:36:19 Gathered and reduced data from device 2
2024/12/17 17:36:19 Gathered and reduced data from device 3
2024/12/17 17:36:19 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:19 Broadcast complete to device 1
2024/12/17 17:36:19 Broadcast complete to device 2
2024/12/17 17:36:19 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 10.793375ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 81.570375ms
    gpu_test.go:1267: Running Large size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:36:19 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:36:19 Gathered and reduced data from device 1
2024/12/17 17:36:19 Gathered and reduced data from device 2
2024/12/17 17:36:19 Gathered and reduced data from device 3
2024/12/17 17:36:19 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:19 Broadcast complete to device 1
2024/12/17 17:36:19 Broadcast complete to device 2
2024/12/17 17:36:19 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 58.803792ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 41.191458ms
    gpu_test.go:1358: 
        Performance comparison for Large size (100000 elements, 0.76 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 34.798583ms
    gpu_test.go:1361: Ring AllReduce:  61.380916ms
    gpu_test.go:1362: Speedup: 0.57x
=== RUN   TestAllReducePerformance/XLarge
    gpu_test.go:1267: Running XLarge size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:36:19 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:36:19 Gathered and reduced data from device 1
2024/12/17 17:36:19 Gathered and reduced data from device 2
2024/12/17 17:36:19 Gathered and reduced data from device 3
2024/12/17 17:36:19 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:19 Broadcast complete to device 1
2024/12/17 17:36:19 Broadcast complete to device 2
2024/12/17 17:36:19 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 44.732166ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 44.346417ms
    gpu_test.go:1267: Running XLarge size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:36:20 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:36:20 Gathered and reduced data from device 1
2024/12/17 17:36:20 Gathered and reduced data from device 2
2024/12/17 17:36:20 Gathered and reduced data from device 3
2024/12/17 17:36:20 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:20 Broadcast complete to device 1
2024/12/17 17:36:20 Broadcast complete to device 2
2024/12/17 17:36:20 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 359.009792ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 257.100083ms
    gpu_test.go:1358: 
        Performance comparison for XLarge size (200000 elements, 1.53 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 201.870979ms
    gpu_test.go:1361: Ring AllReduce:  150.72325ms
    gpu_test.go:1362: Speedup: 1.34x
=== RUN   TestAllReducePerformance/XXLarge
    gpu_test.go:1267: Running XXLarge size iteration 1/1...
    gpu_test.go:1305: Starting Naive AllReduce for size XXLarge...
2024/12/17 17:36:20 Naive AllReduce: Gathering all data to device 0 (data size: 3200000 bytes)
2024/12/17 17:36:20 Gathered and reduced data from device 1
2024/12/17 17:36:20 Gathered and reduced data from device 2
2024/12/17 17:36:20 Gathered and reduced data from device 3
2024/12/17 17:36:20 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:21 Broadcast complete to device 1
2024/12/17 17:36:21 Broadcast complete to device 2
2024/12/17 17:36:21 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 89.545375ms
    gpu_test.go:1322: Starting Ring AllReduce for size XXLarge...
    gpu_test.go:1343: Ring completed in 345.280167ms
    gpu_test.go:1358: 
        Performance comparison for XXLarge size (400000 elements, 3.05 MB), averaged over 1 iterations:
    gpu_test.go:1360: Naive AllReduce: 89.545375ms
    gpu_test.go:1361: Ring AllReduce:  345.280167ms
    gpu_test.go:1362: Speedup: 0.26x
--- PASS: TestAllReducePerformance (4.57s)
    --- PASS: TestAllReducePerformance/Tiny (0.77s)
    --- PASS: TestAllReducePerformance/Small (0.83s)
    --- PASS: TestAllReducePerformance/Medium (0.68s)
    --- PASS: TestAllReducePerformance/Large (0.54s)
    --- PASS: TestAllReducePerformance/XLarge (1.09s)
    --- PASS: TestAllReducePerformance/XXLarge (0.66s)
PASS
ok  	dsml/pkg/tests	5.007s
=== RUN   TestInitCommunicator
--- PASS: TestInitCommunicator (0.01s)
=== RUN   TestMemcpyToGPUs
--- PASS: TestMemcpyToGPUs (0.01s)
=== RUN   TestGroupOperations
--- PASS: TestGroupOperations (0.01s)
=== RUN   TestAllReduce
--- PASS: TestAllReduce (0.14s)
=== RUN   TestStatusChecking
--- PASS: TestStatusChecking (0.02s)
=== RUN   TestMemcpyFromGPU
--- PASS: TestMemcpyFromGPU (0.03s)
=== RUN   TestCompleteWorkflow
--- PASS: TestCompleteWorkflow (0.15s)
=== RUN   TestNaiveAllReduce
    gpu_test.go:987: Initializing device 0 with value 1.000000
    gpu_test.go:987: Initializing device 1 with value 2.000000
    gpu_test.go:987: Initializing device 2 with value 3.000000
    gpu_test.go:987: Initializing device 3 with value 4.000000
2024/12/17 17:36:22 Naive AllReduce: Gathering all data to device 0 (data size: 64 bytes)
2024/12/17 17:36:22 Gathered and reduced data from device 1
2024/12/17 17:36:22 Gathered and reduced data from device 2
2024/12/17 17:36:22 Gathered and reduced data from device 3
2024/12/17 17:36:22 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:22 Broadcast complete to device 1
2024/12/17 17:36:22 Broadcast complete to device 2
2024/12/17 17:36:22 Broadcast complete to device 3
    gpu_test.go:1048: Device 0 results verified
    gpu_test.go:1048: Device 1 results verified
    gpu_test.go:1048: Device 2 results verified
    gpu_test.go:1048: Device 3 results verified
--- PASS: TestNaiveAllReduce (0.02s)
=== RUN   TestAllReducePerformance
=== RUN   TestAllReducePerformance/Tiny
    gpu_test.go:1267: Running Tiny size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:22 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:22 Gathered and reduced data from device 1
2024/12/17 17:36:22 Gathered and reduced data from device 2
2024/12/17 17:36:22 Gathered and reduced data from device 3
2024/12/17 17:36:22 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:22 Broadcast complete to device 1
2024/12/17 17:36:22 Broadcast complete to device 2
2024/12/17 17:36:22 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.239958ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 24.313042ms
    gpu_test.go:1267: Running Tiny size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:22 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:22 Gathered and reduced data from device 1
2024/12/17 17:36:22 Gathered and reduced data from device 2
2024/12/17 17:36:22 Gathered and reduced data from device 3
2024/12/17 17:36:22 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:22 Broadcast complete to device 1
2024/12/17 17:36:22 Broadcast complete to device 2
2024/12/17 17:36:22 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.241875ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 25.715417ms
    gpu_test.go:1267: Running Tiny size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:22 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:22 Gathered and reduced data from device 1
2024/12/17 17:36:22 Gathered and reduced data from device 2
2024/12/17 17:36:22 Gathered and reduced data from device 3
2024/12/17 17:36:22 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:22 Broadcast complete to device 1
2024/12/17 17:36:22 Broadcast complete to device 2
2024/12/17 17:36:22 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.25975ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 22.67225ms
    gpu_test.go:1267: Running Tiny size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:22 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:22 Gathered and reduced data from device 1
2024/12/17 17:36:22 Gathered and reduced data from device 2
2024/12/17 17:36:22 Gathered and reduced data from device 3
2024/12/17 17:36:22 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:22 Broadcast complete to device 1
2024/12/17 17:36:22 Broadcast complete to device 2
2024/12/17 17:36:22 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.00875ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 24.984083ms
    gpu_test.go:1267: Running Tiny size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:23 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:23 Gathered and reduced data from device 1
2024/12/17 17:36:23 Gathered and reduced data from device 2
2024/12/17 17:36:23 Gathered and reduced data from device 3
2024/12/17 17:36:23 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:23 Broadcast complete to device 1
2024/12/17 17:36:23 Broadcast complete to device 2
2024/12/17 17:36:23 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.526291ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 24.958667ms
    gpu_test.go:1358: 
        Performance comparison for Tiny size (1000 elements, 0.01 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 3.455324ms
    gpu_test.go:1361: Ring AllReduce:  24.528691ms
    gpu_test.go:1362: Speedup: 0.14x
=== RUN   TestAllReducePerformance/Small
    gpu_test.go:1267: Running Small size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:23 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:23 Gathered and reduced data from device 1
2024/12/17 17:36:23 Gathered and reduced data from device 2
2024/12/17 17:36:23 Gathered and reduced data from device 3
2024/12/17 17:36:23 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:23 Broadcast complete to device 1
2024/12/17 17:36:23 Broadcast complete to device 2
2024/12/17 17:36:23 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 6.078459ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 32.927792ms
    gpu_test.go:1267: Running Small size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:23 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:23 Gathered and reduced data from device 1
2024/12/17 17:36:23 Gathered and reduced data from device 2
2024/12/17 17:36:23 Gathered and reduced data from device 3
2024/12/17 17:36:23 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:23 Broadcast complete to device 1
2024/12/17 17:36:23 Broadcast complete to device 2
2024/12/17 17:36:23 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.852958ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 34.968334ms
    gpu_test.go:1267: Running Small size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:23 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:23 Gathered and reduced data from device 1
2024/12/17 17:36:23 Gathered and reduced data from device 2
2024/12/17 17:36:23 Gathered and reduced data from device 3
2024/12/17 17:36:23 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:23 Broadcast complete to device 1
2024/12/17 17:36:23 Broadcast complete to device 2
2024/12/17 17:36:23 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 13.548791ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 39.532209ms
    gpu_test.go:1267: Running Small size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:23 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:23 Gathered and reduced data from device 1
2024/12/17 17:36:23 Gathered and reduced data from device 2
2024/12/17 17:36:23 Gathered and reduced data from device 3
2024/12/17 17:36:23 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:23 Broadcast complete to device 1
2024/12/17 17:36:23 Broadcast complete to device 2
2024/12/17 17:36:23 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.419167ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 24.50375ms
    gpu_test.go:1267: Running Small size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:23 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:23 Gathered and reduced data from device 1
2024/12/17 17:36:23 Gathered and reduced data from device 2
2024/12/17 17:36:23 Gathered and reduced data from device 3
2024/12/17 17:36:23 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:23 Broadcast complete to device 1
2024/12/17 17:36:23 Broadcast complete to device 2
2024/12/17 17:36:23 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.75125ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 25.372709ms
    gpu_test.go:1358: 
        Performance comparison for Small size (10000 elements, 0.08 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 6.730125ms
    gpu_test.go:1361: Ring AllReduce:  31.460958ms
    gpu_test.go:1362: Speedup: 0.21x
=== RUN   TestAllReducePerformance/Medium
    gpu_test.go:1267: Running Medium size iteration 1/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:24 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:24 Gathered and reduced data from device 1
2024/12/17 17:36:24 Gathered and reduced data from device 2
2024/12/17 17:36:24 Gathered and reduced data from device 3
2024/12/17 17:36:24 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:24 Broadcast complete to device 1
2024/12/17 17:36:24 Broadcast complete to device 2
2024/12/17 17:36:24 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 6.789375ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 39.56775ms
    gpu_test.go:1267: Running Medium size iteration 2/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:24 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:24 Gathered and reduced data from device 1
2024/12/17 17:36:24 Gathered and reduced data from device 2
2024/12/17 17:36:24 Gathered and reduced data from device 3
2024/12/17 17:36:24 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:24 Broadcast complete to device 1
2024/12/17 17:36:24 Broadcast complete to device 2
2024/12/17 17:36:24 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 13.938042ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 44.640459ms
    gpu_test.go:1267: Running Medium size iteration 3/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:24 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:24 Gathered and reduced data from device 1
2024/12/17 17:36:24 Gathered and reduced data from device 2
2024/12/17 17:36:24 Gathered and reduced data from device 3
2024/12/17 17:36:24 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:24 Broadcast complete to device 1
2024/12/17 17:36:24 Broadcast complete to device 2
2024/12/17 17:36:24 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 7.423709ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 29.245959ms
    gpu_test.go:1358: 
        Performance comparison for Medium size (50000 elements, 0.38 MB), averaged over 3 iterations:
    gpu_test.go:1360: Naive AllReduce: 9.383708ms
    gpu_test.go:1361: Ring AllReduce:  37.818056ms
    gpu_test.go:1362: Speedup: 0.25x
=== RUN   TestAllReducePerformance/Large
    gpu_test.go:1267: Running Large size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:36:24 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:36:24 Gathered and reduced data from device 1
2024/12/17 17:36:24 Gathered and reduced data from device 2
2024/12/17 17:36:24 Gathered and reduced data from device 3
2024/12/17 17:36:24 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:24 Broadcast complete to device 1
2024/12/17 17:36:24 Broadcast complete to device 2
2024/12/17 17:36:24 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 25.66275ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 51.306458ms
    gpu_test.go:1267: Running Large size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:36:24 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:36:24 Gathered and reduced data from device 1
2024/12/17 17:36:24 Gathered and reduced data from device 2
2024/12/17 17:36:24 Gathered and reduced data from device 3
2024/12/17 17:36:24 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:24 Broadcast complete to device 1
2024/12/17 17:36:24 Broadcast complete to device 2
2024/12/17 17:36:24 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 34.243625ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 32.432ms
    gpu_test.go:1358: 
        Performance comparison for Large size (100000 elements, 0.76 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 29.953187ms
    gpu_test.go:1361: Ring AllReduce:  41.869229ms
    gpu_test.go:1362: Speedup: 0.72x
=== RUN   TestAllReducePerformance/XLarge
    gpu_test.go:1267: Running XLarge size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:36:25 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:36:25 Gathered and reduced data from device 1
2024/12/17 17:36:25 Gathered and reduced data from device 2
2024/12/17 17:36:25 Gathered and reduced data from device 3
2024/12/17 17:36:25 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:25 Broadcast complete to device 1
2024/12/17 17:36:25 Broadcast complete to device 2
2024/12/17 17:36:25 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 31.568292ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 33.26375ms
    gpu_test.go:1267: Running XLarge size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:36:25 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:36:25 Gathered and reduced data from device 1
2024/12/17 17:36:25 Gathered and reduced data from device 2
2024/12/17 17:36:25 Gathered and reduced data from device 3
2024/12/17 17:36:25 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:25 Broadcast complete to device 1
2024/12/17 17:36:25 Broadcast complete to device 2
2024/12/17 17:36:25 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 17.924542ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 179.648ms
    gpu_test.go:1358: 
        Performance comparison for XLarge size (200000 elements, 1.53 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 24.746417ms
    gpu_test.go:1361: Ring AllReduce:  106.455875ms
    gpu_test.go:1362: Speedup: 0.23x
=== RUN   TestAllReducePerformance/XXLarge
    gpu_test.go:1267: Running XXLarge size iteration 1/1...
    gpu_test.go:1305: Starting Naive AllReduce for size XXLarge...
2024/12/17 17:36:25 Naive AllReduce: Gathering all data to device 0 (data size: 3200000 bytes)
2024/12/17 17:36:25 Gathered and reduced data from device 1
2024/12/17 17:36:25 Gathered and reduced data from device 2
2024/12/17 17:36:25 Gathered and reduced data from device 3
2024/12/17 17:36:25 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:25 Broadcast complete to device 1
2024/12/17 17:36:25 Broadcast complete to device 2
2024/12/17 17:36:25 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 67.78475ms
    gpu_test.go:1322: Starting Ring AllReduce for size XXLarge...
    gpu_test.go:1343: Ring completed in 70.927751ms
    gpu_test.go:1358: 
        Performance comparison for XXLarge size (400000 elements, 3.05 MB), averaged over 1 iterations:
    gpu_test.go:1360: Naive AllReduce: 67.78475ms
    gpu_test.go:1361: Ring AllReduce:  70.927751ms
    gpu_test.go:1362: Speedup: 0.96x
--- PASS: TestAllReducePerformance (3.50s)
    --- PASS: TestAllReducePerformance/Tiny (0.77s)
    --- PASS: TestAllReducePerformance/Small (0.80s)
    --- PASS: TestAllReducePerformance/Medium (0.54s)
    --- PASS: TestAllReducePerformance/Large (0.48s)
    --- PASS: TestAllReducePerformance/XLarge (0.53s)
    --- PASS: TestAllReducePerformance/XXLarge (0.38s)
PASS
ok  	dsml/pkg/tests	3.934s
=== RUN   TestInitCommunicator
--- PASS: TestInitCommunicator (0.01s)
=== RUN   TestMemcpyToGPUs
--- PASS: TestMemcpyToGPUs (0.00s)
=== RUN   TestGroupOperations
--- PASS: TestGroupOperations (0.00s)
=== RUN   TestAllReduce
--- PASS: TestAllReduce (0.13s)
=== RUN   TestStatusChecking
--- PASS: TestStatusChecking (0.02s)
=== RUN   TestMemcpyFromGPU
--- PASS: TestMemcpyFromGPU (0.01s)
=== RUN   TestCompleteWorkflow
--- PASS: TestCompleteWorkflow (0.17s)
=== RUN   TestNaiveAllReduce
    gpu_test.go:987: Initializing device 0 with value 1.000000
    gpu_test.go:987: Initializing device 1 with value 2.000000
    gpu_test.go:987: Initializing device 2 with value 3.000000
    gpu_test.go:987: Initializing device 3 with value 4.000000
2024/12/17 17:36:26 Naive AllReduce: Gathering all data to device 0 (data size: 64 bytes)
2024/12/17 17:36:26 Gathered and reduced data from device 1
2024/12/17 17:36:26 Gathered and reduced data from device 2
2024/12/17 17:36:26 Gathered and reduced data from device 3
2024/12/17 17:36:26 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:26 Broadcast complete to device 1
2024/12/17 17:36:26 Broadcast complete to device 2
2024/12/17 17:36:26 Broadcast complete to device 3
    gpu_test.go:1048: Device 0 results verified
    gpu_test.go:1048: Device 1 results verified
    gpu_test.go:1048: Device 2 results verified
    gpu_test.go:1048: Device 3 results verified
--- PASS: TestNaiveAllReduce (0.01s)
=== RUN   TestAllReducePerformance
=== RUN   TestAllReducePerformance/Tiny
    gpu_test.go:1267: Running Tiny size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:26 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:26 Gathered and reduced data from device 1
2024/12/17 17:36:26 Gathered and reduced data from device 2
2024/12/17 17:36:26 Gathered and reduced data from device 3
2024/12/17 17:36:26 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:26 Broadcast complete to device 1
2024/12/17 17:36:26 Broadcast complete to device 2
2024/12/17 17:36:26 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.078708ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 29.216125ms
    gpu_test.go:1267: Running Tiny size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:27 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:27 Gathered and reduced data from device 1
2024/12/17 17:36:27 Gathered and reduced data from device 2
2024/12/17 17:36:27 Gathered and reduced data from device 3
2024/12/17 17:36:27 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:27 Broadcast complete to device 1
2024/12/17 17:36:27 Broadcast complete to device 2
2024/12/17 17:36:27 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.254417ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 32.000917ms
    gpu_test.go:1267: Running Tiny size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:27 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:27 Gathered and reduced data from device 1
2024/12/17 17:36:27 Gathered and reduced data from device 2
2024/12/17 17:36:27 Gathered and reduced data from device 3
2024/12/17 17:36:27 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:27 Broadcast complete to device 1
2024/12/17 17:36:27 Broadcast complete to device 2
2024/12/17 17:36:27 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.799375ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 30.843084ms
    gpu_test.go:1267: Running Tiny size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:27 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:27 Gathered and reduced data from device 1
2024/12/17 17:36:27 Gathered and reduced data from device 2
2024/12/17 17:36:27 Gathered and reduced data from device 3
2024/12/17 17:36:27 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:27 Broadcast complete to device 1
2024/12/17 17:36:27 Broadcast complete to device 2
2024/12/17 17:36:27 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.741958ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 26.724583ms
    gpu_test.go:1267: Running Tiny size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:27 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:27 Gathered and reduced data from device 1
2024/12/17 17:36:27 Gathered and reduced data from device 2
2024/12/17 17:36:27 Gathered and reduced data from device 3
2024/12/17 17:36:27 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:27 Broadcast complete to device 1
2024/12/17 17:36:27 Broadcast complete to device 2
2024/12/17 17:36:27 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 7.454708ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 35.9145ms
    gpu_test.go:1358: 
        Performance comparison for Tiny size (1000 elements, 0.01 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 4.465833ms
    gpu_test.go:1361: Ring AllReduce:  30.939841ms
    gpu_test.go:1362: Speedup: 0.14x
=== RUN   TestAllReducePerformance/Small
    gpu_test.go:1267: Running Small size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:27 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:27 Gathered and reduced data from device 1
2024/12/17 17:36:27 Gathered and reduced data from device 2
2024/12/17 17:36:27 Gathered and reduced data from device 3
2024/12/17 17:36:27 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:27 Broadcast complete to device 1
2024/12/17 17:36:27 Broadcast complete to device 2
2024/12/17 17:36:27 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.904209ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 29.239916ms
    gpu_test.go:1267: Running Small size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:27 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:27 Gathered and reduced data from device 1
2024/12/17 17:36:27 Gathered and reduced data from device 2
2024/12/17 17:36:27 Gathered and reduced data from device 3
2024/12/17 17:36:27 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:27 Broadcast complete to device 1
2024/12/17 17:36:27 Broadcast complete to device 2
2024/12/17 17:36:27 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.625833ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 31.063667ms
    gpu_test.go:1267: Running Small size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:27 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:27 Gathered and reduced data from device 1
2024/12/17 17:36:27 Gathered and reduced data from device 2
2024/12/17 17:36:27 Gathered and reduced data from device 3
2024/12/17 17:36:27 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:27 Broadcast complete to device 1
2024/12/17 17:36:27 Broadcast complete to device 2
2024/12/17 17:36:27 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 14.862125ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 31.911875ms
    gpu_test.go:1267: Running Small size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:28 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:28 Gathered and reduced data from device 1
2024/12/17 17:36:28 Gathered and reduced data from device 2
2024/12/17 17:36:28 Gathered and reduced data from device 3
2024/12/17 17:36:28 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:28 Broadcast complete to device 1
2024/12/17 17:36:28 Broadcast complete to device 2
2024/12/17 17:36:28 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 6.391875ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 28.36675ms
    gpu_test.go:1267: Running Small size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:28 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:28 Gathered and reduced data from device 1
2024/12/17 17:36:28 Gathered and reduced data from device 2
2024/12/17 17:36:28 Gathered and reduced data from device 3
2024/12/17 17:36:28 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:28 Broadcast complete to device 1
2024/12/17 17:36:28 Broadcast complete to device 2
2024/12/17 17:36:28 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 8.402208ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 31.892084ms
    gpu_test.go:1358: 
        Performance comparison for Small size (10000 elements, 0.08 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 8.03725ms
    gpu_test.go:1361: Ring AllReduce:  30.494858ms
    gpu_test.go:1362: Speedup: 0.26x
=== RUN   TestAllReducePerformance/Medium
    gpu_test.go:1267: Running Medium size iteration 1/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:28 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:28 Gathered and reduced data from device 1
2024/12/17 17:36:28 Gathered and reduced data from device 2
2024/12/17 17:36:28 Gathered and reduced data from device 3
2024/12/17 17:36:28 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:28 Broadcast complete to device 1
2024/12/17 17:36:28 Broadcast complete to device 2
2024/12/17 17:36:28 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 16.715417ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 47.554792ms
    gpu_test.go:1267: Running Medium size iteration 2/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:28 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:28 Gathered and reduced data from device 1
2024/12/17 17:36:28 Gathered and reduced data from device 2
2024/12/17 17:36:28 Gathered and reduced data from device 3
2024/12/17 17:36:28 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:28 Broadcast complete to device 1
2024/12/17 17:36:28 Broadcast complete to device 2
2024/12/17 17:36:28 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 18.409833ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 43.899042ms
    gpu_test.go:1267: Running Medium size iteration 3/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:28 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:28 Gathered and reduced data from device 1
2024/12/17 17:36:28 Gathered and reduced data from device 2
2024/12/17 17:36:28 Gathered and reduced data from device 3
2024/12/17 17:36:28 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:28 Broadcast complete to device 1
2024/12/17 17:36:28 Broadcast complete to device 2
2024/12/17 17:36:28 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 6.156583ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 25.382125ms
    gpu_test.go:1358: 
        Performance comparison for Medium size (50000 elements, 0.38 MB), averaged over 3 iterations:
    gpu_test.go:1360: Naive AllReduce: 13.760611ms
    gpu_test.go:1361: Ring AllReduce:  38.945319ms
    gpu_test.go:1362: Speedup: 0.35x
=== RUN   TestAllReducePerformance/Large
    gpu_test.go:1267: Running Large size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:36:29 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:36:29 Gathered and reduced data from device 1
2024/12/17 17:36:29 Gathered and reduced data from device 2
2024/12/17 17:36:29 Gathered and reduced data from device 3
2024/12/17 17:36:29 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:29 Broadcast complete to device 1
2024/12/17 17:36:29 Broadcast complete to device 2
2024/12/17 17:36:29 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 41.740417ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 66.808417ms
    gpu_test.go:1267: Running Large size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:36:29 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:36:29 Gathered and reduced data from device 1
2024/12/17 17:36:29 Gathered and reduced data from device 2
2024/12/17 17:36:29 Gathered and reduced data from device 3
2024/12/17 17:36:29 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:29 Broadcast complete to device 1
2024/12/17 17:36:29 Broadcast complete to device 2
2024/12/17 17:36:29 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 39.1965ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 34.729917ms
    gpu_test.go:1358: 
        Performance comparison for Large size (100000 elements, 0.76 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 40.468458ms
    gpu_test.go:1361: Ring AllReduce:  50.769167ms
    gpu_test.go:1362: Speedup: 0.80x
=== RUN   TestAllReducePerformance/XLarge
    gpu_test.go:1267: Running XLarge size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:36:29 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:36:29 Gathered and reduced data from device 1
2024/12/17 17:36:29 Gathered and reduced data from device 2
2024/12/17 17:36:29 Gathered and reduced data from device 3
2024/12/17 17:36:29 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:29 Broadcast complete to device 1
2024/12/17 17:36:29 Broadcast complete to device 2
2024/12/17 17:36:29 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 34.839083ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 37.93625ms
    gpu_test.go:1267: Running XLarge size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:36:29 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:36:29 Gathered and reduced data from device 1
2024/12/17 17:36:29 Gathered and reduced data from device 2
2024/12/17 17:36:29 Gathered and reduced data from device 3
2024/12/17 17:36:29 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:29 Broadcast complete to device 1
2024/12/17 17:36:29 Broadcast complete to device 2
2024/12/17 17:36:29 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 18.273834ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 200.141917ms
    gpu_test.go:1358: 
        Performance comparison for XLarge size (200000 elements, 1.53 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 26.556458ms
    gpu_test.go:1361: Ring AllReduce:  119.039083ms
    gpu_test.go:1362: Speedup: 0.22x
=== RUN   TestAllReducePerformance/XXLarge
    gpu_test.go:1267: Running XXLarge size iteration 1/1...
    gpu_test.go:1305: Starting Naive AllReduce for size XXLarge...
2024/12/17 17:36:30 Naive AllReduce: Gathering all data to device 0 (data size: 3200000 bytes)
2024/12/17 17:36:30 Gathered and reduced data from device 1
2024/12/17 17:36:30 Gathered and reduced data from device 2
2024/12/17 17:36:30 Gathered and reduced data from device 3
2024/12/17 17:36:30 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:30 Broadcast complete to device 1
2024/12/17 17:36:30 Broadcast complete to device 2
2024/12/17 17:36:30 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 103.972334ms
    gpu_test.go:1322: Starting Ring AllReduce for size XXLarge...
    gpu_test.go:1343: Ring completed in 83.60725ms
    gpu_test.go:1358: 
        Performance comparison for XXLarge size (400000 elements, 3.05 MB), averaged over 1 iterations:
    gpu_test.go:1360: Naive AllReduce: 103.972334ms
    gpu_test.go:1361: Ring AllReduce:  83.60725ms
    gpu_test.go:1362: Speedup: 1.24x
--- PASS: TestAllReducePerformance (3.77s)
    --- PASS: TestAllReducePerformance/Tiny (0.79s)
    --- PASS: TestAllReducePerformance/Small (0.83s)
    --- PASS: TestAllReducePerformance/Medium (0.60s)
    --- PASS: TestAllReducePerformance/Large (0.57s)
    --- PASS: TestAllReducePerformance/XLarge (0.56s)
    --- PASS: TestAllReducePerformance/XXLarge (0.42s)
PASS
ok  	dsml/pkg/tests	4.181s
=== RUN   TestInitCommunicator
--- PASS: TestInitCommunicator (0.01s)
=== RUN   TestMemcpyToGPUs
--- PASS: TestMemcpyToGPUs (0.01s)
=== RUN   TestGroupOperations
--- PASS: TestGroupOperations (0.03s)
=== RUN   TestAllReduce
--- PASS: TestAllReduce (0.14s)
=== RUN   TestStatusChecking
--- PASS: TestStatusChecking (0.02s)
=== RUN   TestMemcpyFromGPU
--- PASS: TestMemcpyFromGPU (0.01s)
=== RUN   TestCompleteWorkflow
--- PASS: TestCompleteWorkflow (0.15s)
=== RUN   TestNaiveAllReduce
    gpu_test.go:987: Initializing device 0 with value 1.000000
    gpu_test.go:987: Initializing device 1 with value 2.000000
    gpu_test.go:987: Initializing device 2 with value 3.000000
    gpu_test.go:987: Initializing device 3 with value 4.000000
2024/12/17 17:36:31 Naive AllReduce: Gathering all data to device 0 (data size: 64 bytes)
2024/12/17 17:36:31 Gathered and reduced data from device 1
2024/12/17 17:36:31 Gathered and reduced data from device 2
2024/12/17 17:36:31 Gathered and reduced data from device 3
2024/12/17 17:36:31 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:31 Broadcast complete to device 1
2024/12/17 17:36:31 Broadcast complete to device 2
2024/12/17 17:36:31 Broadcast complete to device 3
    gpu_test.go:1048: Device 0 results verified
    gpu_test.go:1048: Device 1 results verified
    gpu_test.go:1048: Device 2 results verified
    gpu_test.go:1048: Device 3 results verified
--- PASS: TestNaiveAllReduce (0.04s)
=== RUN   TestAllReducePerformance
=== RUN   TestAllReducePerformance/Tiny
    gpu_test.go:1267: Running Tiny size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:31 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:31 Gathered and reduced data from device 1
2024/12/17 17:36:31 Gathered and reduced data from device 2
2024/12/17 17:36:31 Gathered and reduced data from device 3
2024/12/17 17:36:31 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:31 Broadcast complete to device 1
2024/12/17 17:36:31 Broadcast complete to device 2
2024/12/17 17:36:31 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 1.495708ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 28.65875ms
    gpu_test.go:1267: Running Tiny size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:31 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:31 Gathered and reduced data from device 1
2024/12/17 17:36:31 Gathered and reduced data from device 2
2024/12/17 17:36:31 Gathered and reduced data from device 3
2024/12/17 17:36:31 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:31 Broadcast complete to device 1
2024/12/17 17:36:31 Broadcast complete to device 2
2024/12/17 17:36:31 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 1.704667ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 24.748791ms
    gpu_test.go:1267: Running Tiny size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:31 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:31 Gathered and reduced data from device 1
2024/12/17 17:36:31 Gathered and reduced data from device 2
2024/12/17 17:36:31 Gathered and reduced data from device 3
2024/12/17 17:36:31 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:31 Broadcast complete to device 1
2024/12/17 17:36:31 Broadcast complete to device 2
2024/12/17 17:36:31 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 1.809ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 23.769292ms
    gpu_test.go:1267: Running Tiny size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:32 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:32 Gathered and reduced data from device 1
2024/12/17 17:36:32 Gathered and reduced data from device 2
2024/12/17 17:36:32 Gathered and reduced data from device 3
2024/12/17 17:36:32 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:32 Broadcast complete to device 1
2024/12/17 17:36:32 Broadcast complete to device 2
2024/12/17 17:36:32 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 1.766667ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 27.139ms
    gpu_test.go:1267: Running Tiny size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:32 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:32 Gathered and reduced data from device 1
2024/12/17 17:36:32 Gathered and reduced data from device 2
2024/12/17 17:36:32 Gathered and reduced data from device 3
2024/12/17 17:36:32 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:32 Broadcast complete to device 1
2024/12/17 17:36:32 Broadcast complete to device 2
2024/12/17 17:36:32 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.472875ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 31.4925ms
    gpu_test.go:1358: 
        Performance comparison for Tiny size (1000 elements, 0.01 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 1.849783ms
    gpu_test.go:1361: Ring AllReduce:  27.161666ms
    gpu_test.go:1362: Speedup: 0.07x
=== RUN   TestAllReducePerformance/Small
    gpu_test.go:1267: Running Small size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:32 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:32 Gathered and reduced data from device 1
2024/12/17 17:36:32 Gathered and reduced data from device 2
2024/12/17 17:36:32 Gathered and reduced data from device 3
2024/12/17 17:36:32 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:32 Broadcast complete to device 1
2024/12/17 17:36:32 Broadcast complete to device 2
2024/12/17 17:36:32 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.953083ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 52.883583ms
    gpu_test.go:1267: Running Small size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:32 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:32 Gathered and reduced data from device 1
2024/12/17 17:36:32 Gathered and reduced data from device 2
2024/12/17 17:36:32 Gathered and reduced data from device 3
2024/12/17 17:36:32 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:32 Broadcast complete to device 1
2024/12/17 17:36:32 Broadcast complete to device 2
2024/12/17 17:36:32 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.173959ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 33.947458ms
    gpu_test.go:1267: Running Small size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:32 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:32 Gathered and reduced data from device 1
2024/12/17 17:36:32 Gathered and reduced data from device 2
2024/12/17 17:36:32 Gathered and reduced data from device 3
2024/12/17 17:36:32 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:32 Broadcast complete to device 1
2024/12/17 17:36:32 Broadcast complete to device 2
2024/12/17 17:36:32 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.6795ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 23.34825ms
    gpu_test.go:1267: Running Small size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:32 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:32 Gathered and reduced data from device 1
2024/12/17 17:36:32 Gathered and reduced data from device 2
2024/12/17 17:36:32 Gathered and reduced data from device 3
2024/12/17 17:36:32 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:32 Broadcast complete to device 1
2024/12/17 17:36:32 Broadcast complete to device 2
2024/12/17 17:36:32 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 13.479458ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 28.184709ms
    gpu_test.go:1267: Running Small size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:32 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:32 Gathered and reduced data from device 1
2024/12/17 17:36:32 Gathered and reduced data from device 2
2024/12/17 17:36:32 Gathered and reduced data from device 3
2024/12/17 17:36:32 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:32 Broadcast complete to device 1
2024/12/17 17:36:32 Broadcast complete to device 2
2024/12/17 17:36:32 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.775375ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 41.064542ms
    gpu_test.go:1358: 
        Performance comparison for Small size (10000 elements, 0.08 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 6.012275ms
    gpu_test.go:1361: Ring AllReduce:  35.885708ms
    gpu_test.go:1362: Speedup: 0.17x
=== RUN   TestAllReducePerformance/Medium
    gpu_test.go:1267: Running Medium size iteration 1/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:33 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:33 Gathered and reduced data from device 1
2024/12/17 17:36:33 Gathered and reduced data from device 2
2024/12/17 17:36:33 Gathered and reduced data from device 3
2024/12/17 17:36:33 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:33 Broadcast complete to device 1
2024/12/17 17:36:33 Broadcast complete to device 2
2024/12/17 17:36:33 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 37.117375ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 35.475833ms
    gpu_test.go:1267: Running Medium size iteration 2/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:33 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:33 Gathered and reduced data from device 1
2024/12/17 17:36:33 Gathered and reduced data from device 2
2024/12/17 17:36:33 Gathered and reduced data from device 3
2024/12/17 17:36:33 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:33 Broadcast complete to device 1
2024/12/17 17:36:33 Broadcast complete to device 2
2024/12/17 17:36:33 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 15.820625ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 49.450458ms
    gpu_test.go:1267: Running Medium size iteration 3/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:33 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:33 Gathered and reduced data from device 1
2024/12/17 17:36:33 Gathered and reduced data from device 2
2024/12/17 17:36:33 Gathered and reduced data from device 3
2024/12/17 17:36:33 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:33 Broadcast complete to device 1
2024/12/17 17:36:33 Broadcast complete to device 2
2024/12/17 17:36:33 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 9.620667ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 30.983708ms
    gpu_test.go:1358: 
        Performance comparison for Medium size (50000 elements, 0.38 MB), averaged over 3 iterations:
    gpu_test.go:1360: Naive AllReduce: 20.852889ms
    gpu_test.go:1361: Ring AllReduce:  38.636666ms
    gpu_test.go:1362: Speedup: 0.54x
=== RUN   TestAllReducePerformance/Large
    gpu_test.go:1267: Running Large size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:36:33 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:36:33 Gathered and reduced data from device 1
2024/12/17 17:36:33 Gathered and reduced data from device 2
2024/12/17 17:36:33 Gathered and reduced data from device 3
2024/12/17 17:36:33 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:33 Broadcast complete to device 1
2024/12/17 17:36:33 Broadcast complete to device 2
2024/12/17 17:36:33 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 19.976375ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 50.468542ms
    gpu_test.go:1267: Running Large size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:36:34 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:36:34 Gathered and reduced data from device 1
2024/12/17 17:36:34 Gathered and reduced data from device 2
2024/12/17 17:36:34 Gathered and reduced data from device 3
2024/12/17 17:36:34 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:34 Broadcast complete to device 1
2024/12/17 17:36:34 Broadcast complete to device 2
2024/12/17 17:36:34 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 95.776666ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 61.408917ms
    gpu_test.go:1358: 
        Performance comparison for Large size (100000 elements, 0.76 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 57.87652ms
    gpu_test.go:1361: Ring AllReduce:  55.938729ms
    gpu_test.go:1362: Speedup: 1.03x
=== RUN   TestAllReducePerformance/XLarge
    gpu_test.go:1267: Running XLarge size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:36:34 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:36:34 Gathered and reduced data from device 1
2024/12/17 17:36:34 Gathered and reduced data from device 2
2024/12/17 17:36:34 Gathered and reduced data from device 3
2024/12/17 17:36:34 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:34 Broadcast complete to device 1
2024/12/17 17:36:34 Broadcast complete to device 2
2024/12/17 17:36:34 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 50.495917ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 84.447ms
    gpu_test.go:1267: Running XLarge size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:36:34 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:36:34 Gathered and reduced data from device 1
2024/12/17 17:36:34 Gathered and reduced data from device 2
2024/12/17 17:36:34 Gathered and reduced data from device 3
2024/12/17 17:36:34 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:34 Broadcast complete to device 1
2024/12/17 17:36:34 Broadcast complete to device 2
2024/12/17 17:36:34 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 30.622916ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 85.294875ms
    gpu_test.go:1358: 
        Performance comparison for XLarge size (200000 elements, 1.53 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 40.559416ms
    gpu_test.go:1361: Ring AllReduce:  84.870937ms
    gpu_test.go:1362: Speedup: 0.48x
=== RUN   TestAllReducePerformance/XXLarge
    gpu_test.go:1267: Running XXLarge size iteration 1/1...
    gpu_test.go:1305: Starting Naive AllReduce for size XXLarge...
2024/12/17 17:36:34 Naive AllReduce: Gathering all data to device 0 (data size: 3200000 bytes)
2024/12/17 17:36:35 Gathered and reduced data from device 1
2024/12/17 17:36:35 Gathered and reduced data from device 2
2024/12/17 17:36:35 Gathered and reduced data from device 3
2024/12/17 17:36:35 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:35 Broadcast complete to device 1
2024/12/17 17:36:35 Broadcast complete to device 2
2024/12/17 17:36:35 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 97.3065ms
    gpu_test.go:1322: Starting Ring AllReduce for size XXLarge...
    gpu_test.go:1343: Ring completed in 66.981292ms
    gpu_test.go:1358: 
        Performance comparison for XXLarge size (400000 elements, 3.05 MB), averaged over 1 iterations:
    gpu_test.go:1360: Naive AllReduce: 97.3065ms
    gpu_test.go:1361: Ring AllReduce:  66.981292ms
    gpu_test.go:1362: Speedup: 1.45x
--- PASS: TestAllReducePerformance (3.68s)
    --- PASS: TestAllReducePerformance/Tiny (0.70s)
    --- PASS: TestAllReducePerformance/Small (0.81s)
    --- PASS: TestAllReducePerformance/Medium (0.59s)
    --- PASS: TestAllReducePerformance/Large (0.64s)
    --- PASS: TestAllReducePerformance/XLarge (0.57s)
    --- PASS: TestAllReducePerformance/XXLarge (0.37s)
PASS
ok  	dsml/pkg/tests	4.122s
=== RUN   TestInitCommunicator
--- PASS: TestInitCommunicator (0.00s)
=== RUN   TestMemcpyToGPUs
--- PASS: TestMemcpyToGPUs (0.01s)
=== RUN   TestGroupOperations
--- PASS: TestGroupOperations (0.01s)
=== RUN   TestAllReduce
--- PASS: TestAllReduce (0.14s)
=== RUN   TestStatusChecking
--- PASS: TestStatusChecking (0.02s)
=== RUN   TestMemcpyFromGPU
--- PASS: TestMemcpyFromGPU (0.02s)
=== RUN   TestCompleteWorkflow
--- PASS: TestCompleteWorkflow (0.14s)
=== RUN   TestNaiveAllReduce
    gpu_test.go:987: Initializing device 0 with value 1.000000
    gpu_test.go:987: Initializing device 1 with value 2.000000
    gpu_test.go:987: Initializing device 2 with value 3.000000
    gpu_test.go:987: Initializing device 3 with value 4.000000
2024/12/17 17:36:36 Naive AllReduce: Gathering all data to device 0 (data size: 64 bytes)
2024/12/17 17:36:36 Gathered and reduced data from device 1
2024/12/17 17:36:36 Gathered and reduced data from device 2
2024/12/17 17:36:36 Gathered and reduced data from device 3
2024/12/17 17:36:36 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:36 Broadcast complete to device 1
2024/12/17 17:36:36 Broadcast complete to device 2
2024/12/17 17:36:36 Broadcast complete to device 3
    gpu_test.go:1048: Device 0 results verified
    gpu_test.go:1048: Device 1 results verified
    gpu_test.go:1048: Device 2 results verified
    gpu_test.go:1048: Device 3 results verified
--- PASS: TestNaiveAllReduce (0.02s)
=== RUN   TestAllReducePerformance
=== RUN   TestAllReducePerformance/Tiny
    gpu_test.go:1267: Running Tiny size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:36 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:36 Gathered and reduced data from device 1
2024/12/17 17:36:36 Gathered and reduced data from device 2
2024/12/17 17:36:36 Gathered and reduced data from device 3
2024/12/17 17:36:36 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:36 Broadcast complete to device 1
2024/12/17 17:36:36 Broadcast complete to device 2
2024/12/17 17:36:36 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.384ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 22.439042ms
    gpu_test.go:1267: Running Tiny size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:36 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:36 Gathered and reduced data from device 1
2024/12/17 17:36:36 Gathered and reduced data from device 2
2024/12/17 17:36:36 Gathered and reduced data from device 3
2024/12/17 17:36:36 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:36 Broadcast complete to device 1
2024/12/17 17:36:36 Broadcast complete to device 2
2024/12/17 17:36:36 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 10.2375ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 23.052125ms
    gpu_test.go:1267: Running Tiny size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:36 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:36 Gathered and reduced data from device 1
2024/12/17 17:36:36 Gathered and reduced data from device 2
2024/12/17 17:36:36 Gathered and reduced data from device 3
2024/12/17 17:36:36 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:36 Broadcast complete to device 1
2024/12/17 17:36:36 Broadcast complete to device 2
2024/12/17 17:36:36 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.755166ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 26.095166ms
    gpu_test.go:1267: Running Tiny size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:36 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:36 Gathered and reduced data from device 1
2024/12/17 17:36:36 Gathered and reduced data from device 2
2024/12/17 17:36:36 Gathered and reduced data from device 3
2024/12/17 17:36:36 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:36 Broadcast complete to device 1
2024/12/17 17:36:36 Broadcast complete to device 2
2024/12/17 17:36:36 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.200125ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 24.732625ms
    gpu_test.go:1267: Running Tiny size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:36 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:36 Gathered and reduced data from device 1
2024/12/17 17:36:36 Gathered and reduced data from device 2
2024/12/17 17:36:36 Gathered and reduced data from device 3
2024/12/17 17:36:36 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:36 Broadcast complete to device 1
2024/12/17 17:36:36 Broadcast complete to device 2
2024/12/17 17:36:36 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.611417ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 21.65075ms
    gpu_test.go:1358: 
        Performance comparison for Tiny size (1000 elements, 0.01 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 5.037641ms
    gpu_test.go:1361: Ring AllReduce:  23.593941ms
    gpu_test.go:1362: Speedup: 0.21x
=== RUN   TestAllReducePerformance/Small
    gpu_test.go:1267: Running Small size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:37 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:37 Gathered and reduced data from device 1
2024/12/17 17:36:37 Gathered and reduced data from device 2
2024/12/17 17:36:37 Gathered and reduced data from device 3
2024/12/17 17:36:37 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:37 Broadcast complete to device 1
2024/12/17 17:36:37 Broadcast complete to device 2
2024/12/17 17:36:37 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.804625ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 26.229041ms
    gpu_test.go:1267: Running Small size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:37 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:37 Gathered and reduced data from device 1
2024/12/17 17:36:37 Gathered and reduced data from device 2
2024/12/17 17:36:37 Gathered and reduced data from device 3
2024/12/17 17:36:37 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:37 Broadcast complete to device 1
2024/12/17 17:36:37 Broadcast complete to device 2
2024/12/17 17:36:37 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.369417ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 31.038875ms
    gpu_test.go:1267: Running Small size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:37 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:37 Gathered and reduced data from device 1
2024/12/17 17:36:37 Gathered and reduced data from device 2
2024/12/17 17:36:37 Gathered and reduced data from device 3
2024/12/17 17:36:37 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:37 Broadcast complete to device 1
2024/12/17 17:36:37 Broadcast complete to device 2
2024/12/17 17:36:37 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.69275ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 32.173084ms
    gpu_test.go:1267: Running Small size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:37 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:37 Gathered and reduced data from device 1
2024/12/17 17:36:37 Gathered and reduced data from device 2
2024/12/17 17:36:37 Gathered and reduced data from device 3
2024/12/17 17:36:37 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:37 Broadcast complete to device 1
2024/12/17 17:36:37 Broadcast complete to device 2
2024/12/17 17:36:37 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 8.001292ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 33.804375ms
    gpu_test.go:1267: Running Small size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:37 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:37 Gathered and reduced data from device 1
2024/12/17 17:36:37 Gathered and reduced data from device 2
2024/12/17 17:36:37 Gathered and reduced data from device 3
2024/12/17 17:36:37 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:37 Broadcast complete to device 1
2024/12/17 17:36:37 Broadcast complete to device 2
2024/12/17 17:36:37 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.059916ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 33.022958ms
    gpu_test.go:1358: 
        Performance comparison for Small size (10000 elements, 0.08 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 5.3856ms
    gpu_test.go:1361: Ring AllReduce:  31.253666ms
    gpu_test.go:1362: Speedup: 0.17x
=== RUN   TestAllReducePerformance/Medium
    gpu_test.go:1267: Running Medium size iteration 1/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:37 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:37 Gathered and reduced data from device 1
2024/12/17 17:36:37 Gathered and reduced data from device 2
2024/12/17 17:36:37 Gathered and reduced data from device 3
2024/12/17 17:36:37 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:37 Broadcast complete to device 1
2024/12/17 17:36:37 Broadcast complete to device 2
2024/12/17 17:36:37 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 10.922917ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 41.316333ms
    gpu_test.go:1267: Running Medium size iteration 2/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:38 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:38 Gathered and reduced data from device 1
2024/12/17 17:36:38 Gathered and reduced data from device 2
2024/12/17 17:36:38 Gathered and reduced data from device 3
2024/12/17 17:36:38 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:38 Broadcast complete to device 1
2024/12/17 17:36:38 Broadcast complete to device 2
2024/12/17 17:36:38 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 37.370791ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 37.418708ms
    gpu_test.go:1267: Running Medium size iteration 3/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:38 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:38 Gathered and reduced data from device 1
2024/12/17 17:36:38 Gathered and reduced data from device 2
2024/12/17 17:36:38 Gathered and reduced data from device 3
2024/12/17 17:36:38 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:38 Broadcast complete to device 1
2024/12/17 17:36:38 Broadcast complete to device 2
2024/12/17 17:36:38 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 53.088708ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 45.341958ms
    gpu_test.go:1358: 
        Performance comparison for Medium size (50000 elements, 0.38 MB), averaged over 3 iterations:
    gpu_test.go:1360: Naive AllReduce: 33.794138ms
    gpu_test.go:1361: Ring AllReduce:  41.358999ms
    gpu_test.go:1362: Speedup: 0.82x
=== RUN   TestAllReducePerformance/Large
    gpu_test.go:1267: Running Large size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:36:38 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:36:38 Gathered and reduced data from device 1
2024/12/17 17:36:38 Gathered and reduced data from device 2
2024/12/17 17:36:38 Gathered and reduced data from device 3
2024/12/17 17:36:38 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:38 Broadcast complete to device 1
2024/12/17 17:36:38 Broadcast complete to device 2
2024/12/17 17:36:38 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 52.080875ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 74.044458ms
    gpu_test.go:1267: Running Large size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:36:38 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:36:38 Gathered and reduced data from device 1
2024/12/17 17:36:38 Gathered and reduced data from device 2
2024/12/17 17:36:38 Gathered and reduced data from device 3
2024/12/17 17:36:38 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:38 Broadcast complete to device 1
2024/12/17 17:36:38 Broadcast complete to device 2
2024/12/17 17:36:38 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 18.932042ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 30.330792ms
    gpu_test.go:1358: 
        Performance comparison for Large size (100000 elements, 0.76 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 35.506458ms
    gpu_test.go:1361: Ring AllReduce:  52.187625ms
    gpu_test.go:1362: Speedup: 0.68x
=== RUN   TestAllReducePerformance/XLarge
    gpu_test.go:1267: Running XLarge size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:36:39 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:36:39 Gathered and reduced data from device 1
2024/12/17 17:36:39 Gathered and reduced data from device 2
2024/12/17 17:36:39 Gathered and reduced data from device 3
2024/12/17 17:36:39 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:39 Broadcast complete to device 1
2024/12/17 17:36:39 Broadcast complete to device 2
2024/12/17 17:36:39 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 20.753208ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 47.849042ms
    gpu_test.go:1267: Running XLarge size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:36:39 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:36:39 Gathered and reduced data from device 1
2024/12/17 17:36:39 Gathered and reduced data from device 2
2024/12/17 17:36:39 Gathered and reduced data from device 3
2024/12/17 17:36:39 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:39 Broadcast complete to device 1
2024/12/17 17:36:39 Broadcast complete to device 2
2024/12/17 17:36:39 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 81.401666ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 56.768459ms
    gpu_test.go:1358: 
        Performance comparison for XLarge size (200000 elements, 1.53 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 51.077437ms
    gpu_test.go:1361: Ring AllReduce:  52.30875ms
    gpu_test.go:1362: Speedup: 0.98x
=== RUN   TestAllReducePerformance/XXLarge
    gpu_test.go:1267: Running XXLarge size iteration 1/1...
    gpu_test.go:1305: Starting Naive AllReduce for size XXLarge...
2024/12/17 17:36:39 Naive AllReduce: Gathering all data to device 0 (data size: 3200000 bytes)
2024/12/17 17:36:39 Gathered and reduced data from device 1
2024/12/17 17:36:39 Gathered and reduced data from device 2
2024/12/17 17:36:39 Gathered and reduced data from device 3
2024/12/17 17:36:39 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:39 Broadcast complete to device 1
2024/12/17 17:36:39 Broadcast complete to device 2
2024/12/17 17:36:39 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 37.598667ms
    gpu_test.go:1322: Starting Ring AllReduce for size XXLarge...
    gpu_test.go:1343: Ring completed in 107.401042ms
    gpu_test.go:1358: 
        Performance comparison for XXLarge size (400000 elements, 3.05 MB), averaged over 1 iterations:
    gpu_test.go:1360: Naive AllReduce: 37.598667ms
    gpu_test.go:1361: Ring AllReduce:  107.401042ms
    gpu_test.go:1362: Speedup: 0.35x
--- PASS: TestAllReducePerformance (3.69s)
    --- PASS: TestAllReducePerformance/Tiny (0.77s)
    --- PASS: TestAllReducePerformance/Small (0.97s)
    --- PASS: TestAllReducePerformance/Medium (0.62s)
    --- PASS: TestAllReducePerformance/Large (0.48s)
    --- PASS: TestAllReducePerformance/XLarge (0.49s)
    --- PASS: TestAllReducePerformance/XXLarge (0.35s)
PASS
ok  	dsml/pkg/tests	4.100s
=== RUN   TestInitCommunicator
--- PASS: TestInitCommunicator (0.01s)
=== RUN   TestMemcpyToGPUs
--- PASS: TestMemcpyToGPUs (0.01s)
=== RUN   TestGroupOperations
--- PASS: TestGroupOperations (0.01s)
=== RUN   TestAllReduce
--- PASS: TestAllReduce (0.14s)
=== RUN   TestStatusChecking
--- PASS: TestStatusChecking (0.02s)
=== RUN   TestMemcpyFromGPU
--- PASS: TestMemcpyFromGPU (0.01s)
=== RUN   TestCompleteWorkflow
--- PASS: TestCompleteWorkflow (0.13s)
=== RUN   TestNaiveAllReduce
    gpu_test.go:987: Initializing device 0 with value 1.000000
    gpu_test.go:987: Initializing device 1 with value 2.000000
    gpu_test.go:987: Initializing device 2 with value 3.000000
    gpu_test.go:987: Initializing device 3 with value 4.000000
2024/12/17 17:36:40 Naive AllReduce: Gathering all data to device 0 (data size: 64 bytes)
2024/12/17 17:36:40 Gathered and reduced data from device 1
2024/12/17 17:36:40 Gathered and reduced data from device 2
2024/12/17 17:36:40 Gathered and reduced data from device 3
2024/12/17 17:36:40 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:40 Broadcast complete to device 1
2024/12/17 17:36:40 Broadcast complete to device 2
2024/12/17 17:36:40 Broadcast complete to device 3
    gpu_test.go:1048: Device 0 results verified
    gpu_test.go:1048: Device 1 results verified
    gpu_test.go:1048: Device 2 results verified
    gpu_test.go:1048: Device 3 results verified
--- PASS: TestNaiveAllReduce (0.01s)
=== RUN   TestAllReducePerformance
=== RUN   TestAllReducePerformance/Tiny
    gpu_test.go:1267: Running Tiny size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:40 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:40 Gathered and reduced data from device 1
2024/12/17 17:36:40 Gathered and reduced data from device 2
2024/12/17 17:36:40 Gathered and reduced data from device 3
2024/12/17 17:36:40 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:40 Broadcast complete to device 1
2024/12/17 17:36:40 Broadcast complete to device 2
2024/12/17 17:36:40 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.891834ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 26.5365ms
    gpu_test.go:1267: Running Tiny size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:40 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:40 Gathered and reduced data from device 1
2024/12/17 17:36:40 Gathered and reduced data from device 2
2024/12/17 17:36:40 Gathered and reduced data from device 3
2024/12/17 17:36:40 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:40 Broadcast complete to device 1
2024/12/17 17:36:40 Broadcast complete to device 2
2024/12/17 17:36:40 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.176ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 30.348667ms
    gpu_test.go:1267: Running Tiny size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:41 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:41 Gathered and reduced data from device 1
2024/12/17 17:36:41 Gathered and reduced data from device 2
2024/12/17 17:36:41 Gathered and reduced data from device 3
2024/12/17 17:36:41 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:41 Broadcast complete to device 1
2024/12/17 17:36:41 Broadcast complete to device 2
2024/12/17 17:36:41 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.525042ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 30.672833ms
    gpu_test.go:1267: Running Tiny size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:41 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:41 Gathered and reduced data from device 1
2024/12/17 17:36:41 Gathered and reduced data from device 2
2024/12/17 17:36:41 Gathered and reduced data from device 3
2024/12/17 17:36:41 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:41 Broadcast complete to device 1
2024/12/17 17:36:41 Broadcast complete to device 2
2024/12/17 17:36:41 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.440708ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 25.407667ms
    gpu_test.go:1267: Running Tiny size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:41 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:41 Gathered and reduced data from device 1
2024/12/17 17:36:41 Gathered and reduced data from device 2
2024/12/17 17:36:41 Gathered and reduced data from device 3
2024/12/17 17:36:41 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:41 Broadcast complete to device 1
2024/12/17 17:36:41 Broadcast complete to device 2
2024/12/17 17:36:41 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.714958ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 46.050167ms
    gpu_test.go:1358: 
        Performance comparison for Tiny size (1000 elements, 0.01 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 4.149708ms
    gpu_test.go:1361: Ring AllReduce:  31.803166ms
    gpu_test.go:1362: Speedup: 0.13x
=== RUN   TestAllReducePerformance/Small
    gpu_test.go:1267: Running Small size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:41 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:41 Gathered and reduced data from device 1
2024/12/17 17:36:41 Gathered and reduced data from device 2
2024/12/17 17:36:41 Gathered and reduced data from device 3
2024/12/17 17:36:41 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:41 Broadcast complete to device 1
2024/12/17 17:36:41 Broadcast complete to device 2
2024/12/17 17:36:41 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.497083ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 26.257ms
    gpu_test.go:1267: Running Small size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:41 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:41 Gathered and reduced data from device 1
2024/12/17 17:36:41 Gathered and reduced data from device 2
2024/12/17 17:36:41 Gathered and reduced data from device 3
2024/12/17 17:36:41 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:41 Broadcast complete to device 1
2024/12/17 17:36:41 Broadcast complete to device 2
2024/12/17 17:36:41 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 8.6065ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 29.981416ms
    gpu_test.go:1267: Running Small size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:41 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:41 Gathered and reduced data from device 1
2024/12/17 17:36:41 Gathered and reduced data from device 2
2024/12/17 17:36:41 Gathered and reduced data from device 3
2024/12/17 17:36:41 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:41 Broadcast complete to device 1
2024/12/17 17:36:41 Broadcast complete to device 2
2024/12/17 17:36:41 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 7.063042ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 25.695375ms
    gpu_test.go:1267: Running Small size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:42 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:42 Gathered and reduced data from device 1
2024/12/17 17:36:42 Gathered and reduced data from device 2
2024/12/17 17:36:42 Gathered and reduced data from device 3
2024/12/17 17:36:42 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:42 Broadcast complete to device 1
2024/12/17 17:36:42 Broadcast complete to device 2
2024/12/17 17:36:42 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 9.350334ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 29.949084ms
    gpu_test.go:1267: Running Small size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:42 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:42 Gathered and reduced data from device 1
2024/12/17 17:36:42 Gathered and reduced data from device 2
2024/12/17 17:36:42 Gathered and reduced data from device 3
2024/12/17 17:36:42 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:42 Broadcast complete to device 1
2024/12/17 17:36:42 Broadcast complete to device 2
2024/12/17 17:36:42 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 7.813334ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 36.49075ms
    gpu_test.go:1358: 
        Performance comparison for Small size (10000 elements, 0.08 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 7.666058ms
    gpu_test.go:1361: Ring AllReduce:  29.674725ms
    gpu_test.go:1362: Speedup: 0.26x
=== RUN   TestAllReducePerformance/Medium
    gpu_test.go:1267: Running Medium size iteration 1/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:42 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:42 Gathered and reduced data from device 1
2024/12/17 17:36:42 Gathered and reduced data from device 2
2024/12/17 17:36:42 Gathered and reduced data from device 3
2024/12/17 17:36:42 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:42 Broadcast complete to device 1
2024/12/17 17:36:42 Broadcast complete to device 2
2024/12/17 17:36:42 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 12.978416ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 30.050333ms
    gpu_test.go:1267: Running Medium size iteration 2/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:42 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:42 Gathered and reduced data from device 1
2024/12/17 17:36:42 Gathered and reduced data from device 2
2024/12/17 17:36:42 Gathered and reduced data from device 3
2024/12/17 17:36:42 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:42 Broadcast complete to device 1
2024/12/17 17:36:42 Broadcast complete to device 2
2024/12/17 17:36:42 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 20.771667ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 40.977875ms
    gpu_test.go:1267: Running Medium size iteration 3/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:42 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:42 Gathered and reduced data from device 1
2024/12/17 17:36:42 Gathered and reduced data from device 2
2024/12/17 17:36:42 Gathered and reduced data from device 3
2024/12/17 17:36:42 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:42 Broadcast complete to device 1
2024/12/17 17:36:42 Broadcast complete to device 2
2024/12/17 17:36:42 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 53.210375ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 46.394666ms
    gpu_test.go:1358: 
        Performance comparison for Medium size (50000 elements, 0.38 MB), averaged over 3 iterations:
    gpu_test.go:1360: Naive AllReduce: 28.986819ms
    gpu_test.go:1361: Ring AllReduce:  39.140958ms
    gpu_test.go:1362: Speedup: 0.74x
=== RUN   TestAllReducePerformance/Large
    gpu_test.go:1267: Running Large size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:36:43 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:36:43 Gathered and reduced data from device 1
2024/12/17 17:36:43 Gathered and reduced data from device 2
2024/12/17 17:36:43 Gathered and reduced data from device 3
2024/12/17 17:36:43 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:43 Broadcast complete to device 1
2024/12/17 17:36:43 Broadcast complete to device 2
2024/12/17 17:36:43 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 55.841333ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 67.730958ms
    gpu_test.go:1267: Running Large size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:36:43 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:36:43 Gathered and reduced data from device 1
2024/12/17 17:36:43 Gathered and reduced data from device 2
2024/12/17 17:36:43 Gathered and reduced data from device 3
2024/12/17 17:36:43 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:43 Broadcast complete to device 1
2024/12/17 17:36:43 Broadcast complete to device 2
2024/12/17 17:36:43 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 25.08ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 35.547083ms
    gpu_test.go:1358: 
        Performance comparison for Large size (100000 elements, 0.76 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 40.460666ms
    gpu_test.go:1361: Ring AllReduce:  51.63902ms
    gpu_test.go:1362: Speedup: 0.78x
=== RUN   TestAllReducePerformance/XLarge
    gpu_test.go:1267: Running XLarge size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:36:43 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:36:43 Gathered and reduced data from device 1
2024/12/17 17:36:43 Gathered and reduced data from device 2
2024/12/17 17:36:43 Gathered and reduced data from device 3
2024/12/17 17:36:43 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:43 Broadcast complete to device 1
2024/12/17 17:36:43 Broadcast complete to device 2
2024/12/17 17:36:43 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 20.18675ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 52.750083ms
    gpu_test.go:1267: Running XLarge size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:36:43 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:36:43 Gathered and reduced data from device 1
2024/12/17 17:36:43 Gathered and reduced data from device 2
2024/12/17 17:36:43 Gathered and reduced data from device 3
2024/12/17 17:36:43 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:43 Broadcast complete to device 1
2024/12/17 17:36:43 Broadcast complete to device 2
2024/12/17 17:36:43 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 57.754708ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 51.918041ms
    gpu_test.go:1358: 
        Performance comparison for XLarge size (200000 elements, 1.53 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 38.970729ms
    gpu_test.go:1361: Ring AllReduce:  52.334062ms
    gpu_test.go:1362: Speedup: 0.74x
=== RUN   TestAllReducePerformance/XXLarge
    gpu_test.go:1267: Running XXLarge size iteration 1/1...
    gpu_test.go:1305: Starting Naive AllReduce for size XXLarge...
2024/12/17 17:36:43 Naive AllReduce: Gathering all data to device 0 (data size: 3200000 bytes)
2024/12/17 17:36:43 Gathered and reduced data from device 1
2024/12/17 17:36:43 Gathered and reduced data from device 2
2024/12/17 17:36:43 Gathered and reduced data from device 3
2024/12/17 17:36:43 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:43 Broadcast complete to device 1
2024/12/17 17:36:44 Broadcast complete to device 2
2024/12/17 17:36:44 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 29.560959ms
    gpu_test.go:1322: Starting Ring AllReduce for size XXLarge...
    gpu_test.go:1343: Ring completed in 79.969791ms
    gpu_test.go:1358: 
        Performance comparison for XXLarge size (400000 elements, 3.05 MB), averaged over 1 iterations:
    gpu_test.go:1360: Naive AllReduce: 29.560959ms
    gpu_test.go:1361: Ring AllReduce:  79.969791ms
    gpu_test.go:1362: Speedup: 0.37x
--- PASS: TestAllReducePerformance (3.50s)
    --- PASS: TestAllReducePerformance/Tiny (0.82s)
    --- PASS: TestAllReducePerformance/Small (0.85s)
    --- PASS: TestAllReducePerformance/Medium (0.62s)
    --- PASS: TestAllReducePerformance/Large (0.49s)
    --- PASS: TestAllReducePerformance/XLarge (0.46s)
    --- PASS: TestAllReducePerformance/XXLarge (0.26s)
PASS
ok  	dsml/pkg/tests	3.899s
=== RUN   TestInitCommunicator
--- PASS: TestInitCommunicator (0.01s)
=== RUN   TestMemcpyToGPUs
--- PASS: TestMemcpyToGPUs (0.01s)
=== RUN   TestGroupOperations
--- PASS: TestGroupOperations (0.00s)
=== RUN   TestAllReduce
--- PASS: TestAllReduce (0.13s)
=== RUN   TestStatusChecking
--- PASS: TestStatusChecking (0.02s)
=== RUN   TestMemcpyFromGPU
--- PASS: TestMemcpyFromGPU (0.03s)
=== RUN   TestCompleteWorkflow
--- PASS: TestCompleteWorkflow (0.14s)
=== RUN   TestNaiveAllReduce
    gpu_test.go:987: Initializing device 0 with value 1.000000
    gpu_test.go:987: Initializing device 1 with value 2.000000
    gpu_test.go:987: Initializing device 2 with value 3.000000
    gpu_test.go:987: Initializing device 3 with value 4.000000
2024/12/17 17:36:45 Naive AllReduce: Gathering all data to device 0 (data size: 64 bytes)
2024/12/17 17:36:45 Gathered and reduced data from device 1
2024/12/17 17:36:45 Gathered and reduced data from device 2
2024/12/17 17:36:45 Gathered and reduced data from device 3
2024/12/17 17:36:45 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:45 Broadcast complete to device 1
2024/12/17 17:36:45 Broadcast complete to device 2
2024/12/17 17:36:45 Broadcast complete to device 3
    gpu_test.go:1048: Device 0 results verified
    gpu_test.go:1048: Device 1 results verified
    gpu_test.go:1048: Device 2 results verified
    gpu_test.go:1048: Device 3 results verified
--- PASS: TestNaiveAllReduce (0.04s)
=== RUN   TestAllReducePerformance
=== RUN   TestAllReducePerformance/Tiny
    gpu_test.go:1267: Running Tiny size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:45 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:45 Gathered and reduced data from device 1
2024/12/17 17:36:45 Gathered and reduced data from device 2
2024/12/17 17:36:45 Gathered and reduced data from device 3
2024/12/17 17:36:45 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:45 Broadcast complete to device 1
2024/12/17 17:36:45 Broadcast complete to device 2
2024/12/17 17:36:45 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.002166ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 25.769625ms
    gpu_test.go:1267: Running Tiny size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:45 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:45 Gathered and reduced data from device 1
2024/12/17 17:36:45 Gathered and reduced data from device 2
2024/12/17 17:36:45 Gathered and reduced data from device 3
2024/12/17 17:36:45 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:45 Broadcast complete to device 1
2024/12/17 17:36:45 Broadcast complete to device 2
2024/12/17 17:36:45 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.126042ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 27.426209ms
    gpu_test.go:1267: Running Tiny size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:45 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:45 Gathered and reduced data from device 1
2024/12/17 17:36:45 Gathered and reduced data from device 2
2024/12/17 17:36:45 Gathered and reduced data from device 3
2024/12/17 17:36:45 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:45 Broadcast complete to device 1
2024/12/17 17:36:45 Broadcast complete to device 2
2024/12/17 17:36:45 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.642ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 24.749542ms
    gpu_test.go:1267: Running Tiny size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:45 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:45 Gathered and reduced data from device 1
2024/12/17 17:36:45 Gathered and reduced data from device 2
2024/12/17 17:36:45 Gathered and reduced data from device 3
2024/12/17 17:36:45 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:45 Broadcast complete to device 1
2024/12/17 17:36:45 Broadcast complete to device 2
2024/12/17 17:36:45 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.811208ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 45.409292ms
    gpu_test.go:1267: Running Tiny size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:45 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:45 Gathered and reduced data from device 1
2024/12/17 17:36:45 Gathered and reduced data from device 2
2024/12/17 17:36:45 Gathered and reduced data from device 3
2024/12/17 17:36:45 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:45 Broadcast complete to device 1
2024/12/17 17:36:45 Broadcast complete to device 2
2024/12/17 17:36:45 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.765917ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 21.238375ms
    gpu_test.go:1358: 
        Performance comparison for Tiny size (1000 elements, 0.01 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 3.069466ms
    gpu_test.go:1361: Ring AllReduce:  28.918608ms
    gpu_test.go:1362: Speedup: 0.11x
=== RUN   TestAllReducePerformance/Small
    gpu_test.go:1267: Running Small size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:45 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:45 Gathered and reduced data from device 1
2024/12/17 17:36:45 Gathered and reduced data from device 2
2024/12/17 17:36:45 Gathered and reduced data from device 3
2024/12/17 17:36:45 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:45 Broadcast complete to device 1
2024/12/17 17:36:45 Broadcast complete to device 2
2024/12/17 17:36:45 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 11.341958ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 40.677375ms
    gpu_test.go:1267: Running Small size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:46 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:46 Gathered and reduced data from device 1
2024/12/17 17:36:46 Gathered and reduced data from device 2
2024/12/17 17:36:46 Gathered and reduced data from device 3
2024/12/17 17:36:46 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:46 Broadcast complete to device 1
2024/12/17 17:36:46 Broadcast complete to device 2
2024/12/17 17:36:46 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.232042ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 22.821416ms
    gpu_test.go:1267: Running Small size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:46 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:46 Gathered and reduced data from device 1
2024/12/17 17:36:46 Gathered and reduced data from device 2
2024/12/17 17:36:46 Gathered and reduced data from device 3
2024/12/17 17:36:46 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:46 Broadcast complete to device 1
2024/12/17 17:36:46 Broadcast complete to device 2
2024/12/17 17:36:46 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 6.259334ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 35.19125ms
    gpu_test.go:1267: Running Small size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:46 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:46 Gathered and reduced data from device 1
2024/12/17 17:36:46 Gathered and reduced data from device 2
2024/12/17 17:36:46 Gathered and reduced data from device 3
2024/12/17 17:36:46 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:46 Broadcast complete to device 1
2024/12/17 17:36:46 Broadcast complete to device 2
2024/12/17 17:36:46 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 11.132416ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 28.22625ms
    gpu_test.go:1267: Running Small size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:46 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:46 Gathered and reduced data from device 1
2024/12/17 17:36:46 Gathered and reduced data from device 2
2024/12/17 17:36:46 Gathered and reduced data from device 3
2024/12/17 17:36:46 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:46 Broadcast complete to device 1
2024/12/17 17:36:46 Broadcast complete to device 2
2024/12/17 17:36:46 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 10.257083ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 34.552667ms
    gpu_test.go:1358: 
        Performance comparison for Small size (10000 elements, 0.08 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 8.444566ms
    gpu_test.go:1361: Ring AllReduce:  32.293791ms
    gpu_test.go:1362: Speedup: 0.26x
=== RUN   TestAllReducePerformance/Medium
    gpu_test.go:1267: Running Medium size iteration 1/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:46 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:46 Gathered and reduced data from device 1
2024/12/17 17:36:46 Gathered and reduced data from device 2
2024/12/17 17:36:46 Gathered and reduced data from device 3
2024/12/17 17:36:46 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:46 Broadcast complete to device 1
2024/12/17 17:36:46 Broadcast complete to device 2
2024/12/17 17:36:46 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 18.913375ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 45.196417ms
    gpu_test.go:1267: Running Medium size iteration 2/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:46 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:46 Gathered and reduced data from device 1
2024/12/17 17:36:46 Gathered and reduced data from device 2
2024/12/17 17:36:46 Gathered and reduced data from device 3
2024/12/17 17:36:46 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:47 Broadcast complete to device 1
2024/12/17 17:36:47 Broadcast complete to device 2
2024/12/17 17:36:47 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 31.039667ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 50.807208ms
    gpu_test.go:1267: Running Medium size iteration 3/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:47 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:47 Gathered and reduced data from device 1
2024/12/17 17:36:47 Gathered and reduced data from device 2
2024/12/17 17:36:47 Gathered and reduced data from device 3
2024/12/17 17:36:47 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:47 Broadcast complete to device 1
2024/12/17 17:36:47 Broadcast complete to device 2
2024/12/17 17:36:47 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 6.188875ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 26.8895ms
    gpu_test.go:1358: 
        Performance comparison for Medium size (50000 elements, 0.38 MB), averaged over 3 iterations:
    gpu_test.go:1360: Naive AllReduce: 18.713972ms
    gpu_test.go:1361: Ring AllReduce:  40.964375ms
    gpu_test.go:1362: Speedup: 0.46x
=== RUN   TestAllReducePerformance/Large
    gpu_test.go:1267: Running Large size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:36:47 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:36:47 Gathered and reduced data from device 1
2024/12/17 17:36:47 Gathered and reduced data from device 2
2024/12/17 17:36:47 Gathered and reduced data from device 3
2024/12/17 17:36:47 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:47 Broadcast complete to device 1
2024/12/17 17:36:47 Broadcast complete to device 2
2024/12/17 17:36:47 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 19.851958ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 57.9345ms
    gpu_test.go:1267: Running Large size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:36:47 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:36:47 Gathered and reduced data from device 1
2024/12/17 17:36:47 Gathered and reduced data from device 2
2024/12/17 17:36:47 Gathered and reduced data from device 3
2024/12/17 17:36:47 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:47 Broadcast complete to device 1
2024/12/17 17:36:47 Broadcast complete to device 2
2024/12/17 17:36:47 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 46.735ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 42.476042ms
    gpu_test.go:1358: 
        Performance comparison for Large size (100000 elements, 0.76 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 33.293479ms
    gpu_test.go:1361: Ring AllReduce:  50.205271ms
    gpu_test.go:1362: Speedup: 0.66x
=== RUN   TestAllReducePerformance/XLarge
    gpu_test.go:1267: Running XLarge size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:36:47 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:36:47 Gathered and reduced data from device 1
2024/12/17 17:36:47 Gathered and reduced data from device 2
2024/12/17 17:36:47 Gathered and reduced data from device 3
2024/12/17 17:36:47 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:47 Broadcast complete to device 1
2024/12/17 17:36:47 Broadcast complete to device 2
2024/12/17 17:36:47 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 32.299667ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 28.108084ms
    gpu_test.go:1267: Running XLarge size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:36:48 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:36:48 Gathered and reduced data from device 1
2024/12/17 17:36:48 Gathered and reduced data from device 2
2024/12/17 17:36:48 Gathered and reduced data from device 3
2024/12/17 17:36:48 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:48 Broadcast complete to device 1
2024/12/17 17:36:48 Broadcast complete to device 2
2024/12/17 17:36:48 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 16.521375ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 52.980292ms
    gpu_test.go:1358: 
        Performance comparison for XLarge size (200000 elements, 1.53 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 24.410521ms
    gpu_test.go:1361: Ring AllReduce:  40.544188ms
    gpu_test.go:1362: Speedup: 0.60x
=== RUN   TestAllReducePerformance/XXLarge
    gpu_test.go:1267: Running XXLarge size iteration 1/1...
    gpu_test.go:1305: Starting Naive AllReduce for size XXLarge...
2024/12/17 17:36:48 Naive AllReduce: Gathering all data to device 0 (data size: 3200000 bytes)
2024/12/17 17:36:48 Gathered and reduced data from device 1
2024/12/17 17:36:48 Gathered and reduced data from device 2
2024/12/17 17:36:48 Gathered and reduced data from device 3
2024/12/17 17:36:48 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:48 Broadcast complete to device 1
2024/12/17 17:36:48 Broadcast complete to device 2
2024/12/17 17:36:48 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 124.212292ms
    gpu_test.go:1322: Starting Ring AllReduce for size XXLarge...
    gpu_test.go:1343: Ring completed in 116.444084ms
    gpu_test.go:1358: 
        Performance comparison for XXLarge size (400000 elements, 3.05 MB), averaged over 1 iterations:
    gpu_test.go:1360: Naive AllReduce: 124.212292ms
    gpu_test.go:1361: Ring AllReduce:  116.444084ms
    gpu_test.go:1362: Speedup: 1.07x
--- PASS: TestAllReducePerformance (3.66s)
    --- PASS: TestAllReducePerformance/Tiny (0.78s)
    --- PASS: TestAllReducePerformance/Small (0.85s)
    --- PASS: TestAllReducePerformance/Medium (0.60s)
    --- PASS: TestAllReducePerformance/Large (0.50s)
    --- PASS: TestAllReducePerformance/XLarge (0.42s)
    --- PASS: TestAllReducePerformance/XXLarge (0.51s)
PASS
ok  	dsml/pkg/tests	4.094s
=== RUN   TestInitCommunicator
--- PASS: TestInitCommunicator (0.01s)
=== RUN   TestMemcpyToGPUs
--- PASS: TestMemcpyToGPUs (0.01s)
=== RUN   TestGroupOperations
--- PASS: TestGroupOperations (0.01s)
=== RUN   TestAllReduce
--- PASS: TestAllReduce (0.14s)
=== RUN   TestStatusChecking
--- PASS: TestStatusChecking (0.02s)
=== RUN   TestMemcpyFromGPU
--- PASS: TestMemcpyFromGPU (0.02s)
=== RUN   TestCompleteWorkflow
--- PASS: TestCompleteWorkflow (0.14s)
=== RUN   TestNaiveAllReduce
    gpu_test.go:987: Initializing device 0 with value 1.000000
    gpu_test.go:987: Initializing device 1 with value 2.000000
    gpu_test.go:987: Initializing device 2 with value 3.000000
    gpu_test.go:987: Initializing device 3 with value 4.000000
2024/12/17 17:36:49 Naive AllReduce: Gathering all data to device 0 (data size: 64 bytes)
2024/12/17 17:36:49 Gathered and reduced data from device 1
2024/12/17 17:36:49 Gathered and reduced data from device 2
2024/12/17 17:36:49 Gathered and reduced data from device 3
2024/12/17 17:36:49 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:49 Broadcast complete to device 1
2024/12/17 17:36:49 Broadcast complete to device 2
2024/12/17 17:36:49 Broadcast complete to device 3
    gpu_test.go:1048: Device 0 results verified
    gpu_test.go:1048: Device 1 results verified
    gpu_test.go:1048: Device 2 results verified
    gpu_test.go:1048: Device 3 results verified
--- PASS: TestNaiveAllReduce (0.02s)
=== RUN   TestAllReducePerformance
=== RUN   TestAllReducePerformance/Tiny
    gpu_test.go:1267: Running Tiny size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:49 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:49 Gathered and reduced data from device 1
2024/12/17 17:36:49 Gathered and reduced data from device 2
2024/12/17 17:36:49 Gathered and reduced data from device 3
2024/12/17 17:36:49 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:49 Broadcast complete to device 1
2024/12/17 17:36:49 Broadcast complete to device 2
2024/12/17 17:36:49 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.477917ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 25.1565ms
    gpu_test.go:1267: Running Tiny size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:49 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:49 Gathered and reduced data from device 1
2024/12/17 17:36:49 Gathered and reduced data from device 2
2024/12/17 17:36:49 Gathered and reduced data from device 3
2024/12/17 17:36:49 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:49 Broadcast complete to device 1
2024/12/17 17:36:49 Broadcast complete to device 2
2024/12/17 17:36:49 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.374083ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 24.506958ms
    gpu_test.go:1267: Running Tiny size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:49 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:49 Gathered and reduced data from device 1
2024/12/17 17:36:49 Gathered and reduced data from device 2
2024/12/17 17:36:49 Gathered and reduced data from device 3
2024/12/17 17:36:49 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:49 Broadcast complete to device 1
2024/12/17 17:36:49 Broadcast complete to device 2
2024/12/17 17:36:49 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.609042ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 27.619042ms
    gpu_test.go:1267: Running Tiny size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:50 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:50 Gathered and reduced data from device 1
2024/12/17 17:36:50 Gathered and reduced data from device 2
2024/12/17 17:36:50 Gathered and reduced data from device 3
2024/12/17 17:36:50 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:50 Broadcast complete to device 1
2024/12/17 17:36:50 Broadcast complete to device 2
2024/12/17 17:36:50 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.44175ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 21.705125ms
    gpu_test.go:1267: Running Tiny size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:50 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:50 Gathered and reduced data from device 1
2024/12/17 17:36:50 Gathered and reduced data from device 2
2024/12/17 17:36:50 Gathered and reduced data from device 3
2024/12/17 17:36:50 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:50 Broadcast complete to device 1
2024/12/17 17:36:50 Broadcast complete to device 2
2024/12/17 17:36:50 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.209083ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 36.86725ms
    gpu_test.go:1358: 
        Performance comparison for Tiny size (1000 elements, 0.01 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 4.222375ms
    gpu_test.go:1361: Ring AllReduce:  27.170975ms
    gpu_test.go:1362: Speedup: 0.16x
=== RUN   TestAllReducePerformance/Small
    gpu_test.go:1267: Running Small size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:50 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:50 Gathered and reduced data from device 1
2024/12/17 17:36:50 Gathered and reduced data from device 2
2024/12/17 17:36:50 Gathered and reduced data from device 3
2024/12/17 17:36:50 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:50 Broadcast complete to device 1
2024/12/17 17:36:50 Broadcast complete to device 2
2024/12/17 17:36:50 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 6.360625ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 35.643583ms
    gpu_test.go:1267: Running Small size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:50 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:50 Gathered and reduced data from device 1
2024/12/17 17:36:50 Gathered and reduced data from device 2
2024/12/17 17:36:50 Gathered and reduced data from device 3
2024/12/17 17:36:50 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:50 Broadcast complete to device 1
2024/12/17 17:36:50 Broadcast complete to device 2
2024/12/17 17:36:50 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 6.479083ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 33.863583ms
    gpu_test.go:1267: Running Small size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:50 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:50 Gathered and reduced data from device 1
2024/12/17 17:36:50 Gathered and reduced data from device 2
2024/12/17 17:36:50 Gathered and reduced data from device 3
2024/12/17 17:36:50 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:50 Broadcast complete to device 1
2024/12/17 17:36:50 Broadcast complete to device 2
2024/12/17 17:36:50 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.611583ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 28.998417ms
    gpu_test.go:1267: Running Small size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:50 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:50 Gathered and reduced data from device 1
2024/12/17 17:36:50 Gathered and reduced data from device 2
2024/12/17 17:36:50 Gathered and reduced data from device 3
2024/12/17 17:36:50 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:50 Broadcast complete to device 1
2024/12/17 17:36:50 Broadcast complete to device 2
2024/12/17 17:36:50 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 24.192792ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 25.978083ms
    gpu_test.go:1267: Running Small size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:51 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:51 Gathered and reduced data from device 1
2024/12/17 17:36:51 Gathered and reduced data from device 2
2024/12/17 17:36:51 Gathered and reduced data from device 3
2024/12/17 17:36:51 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:51 Broadcast complete to device 1
2024/12/17 17:36:51 Broadcast complete to device 2
2024/12/17 17:36:51 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 6.649875ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 36.305ms
    gpu_test.go:1358: 
        Performance comparison for Small size (10000 elements, 0.08 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 9.858791ms
    gpu_test.go:1361: Ring AllReduce:  32.157733ms
    gpu_test.go:1362: Speedup: 0.31x
=== RUN   TestAllReducePerformance/Medium
    gpu_test.go:1267: Running Medium size iteration 1/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:51 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:51 Gathered and reduced data from device 1
2024/12/17 17:36:51 Gathered and reduced data from device 2
2024/12/17 17:36:51 Gathered and reduced data from device 3
2024/12/17 17:36:51 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:51 Broadcast complete to device 1
2024/12/17 17:36:51 Broadcast complete to device 2
2024/12/17 17:36:51 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 29.015ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 32.05275ms
    gpu_test.go:1267: Running Medium size iteration 2/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:51 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:51 Gathered and reduced data from device 1
2024/12/17 17:36:51 Gathered and reduced data from device 2
2024/12/17 17:36:51 Gathered and reduced data from device 3
2024/12/17 17:36:51 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:51 Broadcast complete to device 1
2024/12/17 17:36:51 Broadcast complete to device 2
2024/12/17 17:36:51 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 21.412834ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 30.655958ms
    gpu_test.go:1267: Running Medium size iteration 3/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:51 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:51 Gathered and reduced data from device 1
2024/12/17 17:36:51 Gathered and reduced data from device 2
2024/12/17 17:36:51 Gathered and reduced data from device 3
2024/12/17 17:36:51 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:51 Broadcast complete to device 1
2024/12/17 17:36:51 Broadcast complete to device 2
2024/12/17 17:36:51 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 35.8845ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 40.692416ms
    gpu_test.go:1358: 
        Performance comparison for Medium size (50000 elements, 0.38 MB), averaged over 3 iterations:
    gpu_test.go:1360: Naive AllReduce: 28.770778ms
    gpu_test.go:1361: Ring AllReduce:  34.467041ms
    gpu_test.go:1362: Speedup: 0.83x
=== RUN   TestAllReducePerformance/Large
    gpu_test.go:1267: Running Large size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:36:51 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:36:51 Gathered and reduced data from device 1
2024/12/17 17:36:51 Gathered and reduced data from device 2
2024/12/17 17:36:51 Gathered and reduced data from device 3
2024/12/17 17:36:51 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:51 Broadcast complete to device 1
2024/12/17 17:36:52 Broadcast complete to device 2
2024/12/17 17:36:52 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 71.315084ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 41.937167ms
    gpu_test.go:1267: Running Large size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:36:52 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:36:52 Gathered and reduced data from device 1
2024/12/17 17:36:52 Gathered and reduced data from device 2
2024/12/17 17:36:52 Gathered and reduced data from device 3
2024/12/17 17:36:52 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:52 Broadcast complete to device 1
2024/12/17 17:36:52 Broadcast complete to device 2
2024/12/17 17:36:52 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 36.792709ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 31.462917ms
    gpu_test.go:1358: 
        Performance comparison for Large size (100000 elements, 0.76 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 54.053896ms
    gpu_test.go:1361: Ring AllReduce:  36.700042ms
    gpu_test.go:1362: Speedup: 1.47x
=== RUN   TestAllReducePerformance/XLarge
    gpu_test.go:1267: Running XLarge size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:36:52 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:36:52 Gathered and reduced data from device 1
2024/12/17 17:36:52 Gathered and reduced data from device 2
2024/12/17 17:36:52 Gathered and reduced data from device 3
2024/12/17 17:36:52 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:52 Broadcast complete to device 1
2024/12/17 17:36:52 Broadcast complete to device 2
2024/12/17 17:36:52 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 21.198167ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 48.179084ms
    gpu_test.go:1267: Running XLarge size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:36:52 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:36:52 Gathered and reduced data from device 1
2024/12/17 17:36:52 Gathered and reduced data from device 2
2024/12/17 17:36:52 Gathered and reduced data from device 3
2024/12/17 17:36:52 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:52 Broadcast complete to device 1
2024/12/17 17:36:52 Broadcast complete to device 2
2024/12/17 17:36:52 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 44.18625ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 51.285166ms
    gpu_test.go:1358: 
        Performance comparison for XLarge size (200000 elements, 1.53 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 32.692208ms
    gpu_test.go:1361: Ring AllReduce:  49.732125ms
    gpu_test.go:1362: Speedup: 0.66x
=== RUN   TestAllReducePerformance/XXLarge
    gpu_test.go:1267: Running XXLarge size iteration 1/1...
    gpu_test.go:1305: Starting Naive AllReduce for size XXLarge...
2024/12/17 17:36:52 Naive AllReduce: Gathering all data to device 0 (data size: 3200000 bytes)
2024/12/17 17:36:52 Gathered and reduced data from device 1
2024/12/17 17:36:52 Gathered and reduced data from device 2
2024/12/17 17:36:52 Gathered and reduced data from device 3
2024/12/17 17:36:52 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:52 Broadcast complete to device 1
2024/12/17 17:36:52 Broadcast complete to device 2
2024/12/17 17:36:52 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 27.51825ms
    gpu_test.go:1322: Starting Ring AllReduce for size XXLarge...
    gpu_test.go:1343: Ring completed in 83.693042ms
    gpu_test.go:1358: 
        Performance comparison for XXLarge size (400000 elements, 3.05 MB), averaged over 1 iterations:
    gpu_test.go:1360: Naive AllReduce: 27.51825ms
    gpu_test.go:1361: Ring AllReduce:  83.693042ms
    gpu_test.go:1362: Speedup: 0.33x
--- PASS: TestAllReducePerformance (3.47s)
    --- PASS: TestAllReducePerformance/Tiny (0.80s)
    --- PASS: TestAllReducePerformance/Small (0.83s)
    --- PASS: TestAllReducePerformance/Medium (0.64s)
    --- PASS: TestAllReducePerformance/Large (0.46s)
    --- PASS: TestAllReducePerformance/XLarge (0.47s)
    --- PASS: TestAllReducePerformance/XXLarge (0.28s)
PASS
ok  	dsml/pkg/tests	3.908s
=== RUN   TestInitCommunicator
--- PASS: TestInitCommunicator (0.01s)
=== RUN   TestMemcpyToGPUs
--- PASS: TestMemcpyToGPUs (0.03s)
=== RUN   TestGroupOperations
--- PASS: TestGroupOperations (0.01s)
=== RUN   TestAllReduce
--- PASS: TestAllReduce (0.14s)
=== RUN   TestStatusChecking
--- PASS: TestStatusChecking (0.02s)
=== RUN   TestMemcpyFromGPU
--- PASS: TestMemcpyFromGPU (0.03s)
=== RUN   TestCompleteWorkflow
--- PASS: TestCompleteWorkflow (0.14s)
=== RUN   TestNaiveAllReduce
    gpu_test.go:987: Initializing device 0 with value 1.000000
    gpu_test.go:987: Initializing device 1 with value 2.000000
    gpu_test.go:987: Initializing device 2 with value 3.000000
    gpu_test.go:987: Initializing device 3 with value 4.000000
2024/12/17 17:36:54 Naive AllReduce: Gathering all data to device 0 (data size: 64 bytes)
2024/12/17 17:36:54 Gathered and reduced data from device 1
2024/12/17 17:36:54 Gathered and reduced data from device 2
2024/12/17 17:36:54 Gathered and reduced data from device 3
2024/12/17 17:36:54 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:54 Broadcast complete to device 1
2024/12/17 17:36:54 Broadcast complete to device 2
2024/12/17 17:36:54 Broadcast complete to device 3
    gpu_test.go:1048: Device 0 results verified
    gpu_test.go:1048: Device 1 results verified
    gpu_test.go:1048: Device 2 results verified
    gpu_test.go:1048: Device 3 results verified
--- PASS: TestNaiveAllReduce (0.02s)
=== RUN   TestAllReducePerformance
=== RUN   TestAllReducePerformance/Tiny
    gpu_test.go:1267: Running Tiny size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:54 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:54 Gathered and reduced data from device 1
2024/12/17 17:36:54 Gathered and reduced data from device 2
2024/12/17 17:36:54 Gathered and reduced data from device 3
2024/12/17 17:36:54 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:54 Broadcast complete to device 1
2024/12/17 17:36:54 Broadcast complete to device 2
2024/12/17 17:36:54 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 1.736167ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 26.824292ms
    gpu_test.go:1267: Running Tiny size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:54 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:54 Gathered and reduced data from device 1
2024/12/17 17:36:54 Gathered and reduced data from device 2
2024/12/17 17:36:54 Gathered and reduced data from device 3
2024/12/17 17:36:54 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:54 Broadcast complete to device 1
2024/12/17 17:36:54 Broadcast complete to device 2
2024/12/17 17:36:54 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.567542ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 27.640459ms
    gpu_test.go:1267: Running Tiny size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:54 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:54 Gathered and reduced data from device 1
2024/12/17 17:36:54 Gathered and reduced data from device 2
2024/12/17 17:36:54 Gathered and reduced data from device 3
2024/12/17 17:36:54 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:54 Broadcast complete to device 1
2024/12/17 17:36:54 Broadcast complete to device 2
2024/12/17 17:36:54 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.525459ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 22.277791ms
    gpu_test.go:1267: Running Tiny size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:54 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:54 Gathered and reduced data from device 1
2024/12/17 17:36:54 Gathered and reduced data from device 2
2024/12/17 17:36:54 Gathered and reduced data from device 3
2024/12/17 17:36:54 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:54 Broadcast complete to device 1
2024/12/17 17:36:54 Broadcast complete to device 2
2024/12/17 17:36:54 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 21.477792ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 27.998667ms
    gpu_test.go:1267: Running Tiny size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:54 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:54 Gathered and reduced data from device 1
2024/12/17 17:36:54 Gathered and reduced data from device 2
2024/12/17 17:36:54 Gathered and reduced data from device 3
2024/12/17 17:36:54 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:54 Broadcast complete to device 1
2024/12/17 17:36:54 Broadcast complete to device 2
2024/12/17 17:36:54 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.599542ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 33.391542ms
    gpu_test.go:1358: 
        Performance comparison for Tiny size (1000 elements, 0.01 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 6.3813ms
    gpu_test.go:1361: Ring AllReduce:  27.62655ms
    gpu_test.go:1362: Speedup: 0.23x
=== RUN   TestAllReducePerformance/Small
    gpu_test.go:1267: Running Small size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:55 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:55 Gathered and reduced data from device 1
2024/12/17 17:36:55 Gathered and reduced data from device 2
2024/12/17 17:36:55 Gathered and reduced data from device 3
2024/12/17 17:36:55 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:55 Broadcast complete to device 1
2024/12/17 17:36:55 Broadcast complete to device 2
2024/12/17 17:36:55 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 8.13675ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 50.488958ms
    gpu_test.go:1267: Running Small size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:55 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:55 Gathered and reduced data from device 1
2024/12/17 17:36:55 Gathered and reduced data from device 2
2024/12/17 17:36:55 Gathered and reduced data from device 3
2024/12/17 17:36:55 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:55 Broadcast complete to device 1
2024/12/17 17:36:55 Broadcast complete to device 2
2024/12/17 17:36:55 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.181666ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 26.175334ms
    gpu_test.go:1267: Running Small size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:55 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:55 Gathered and reduced data from device 1
2024/12/17 17:36:55 Gathered and reduced data from device 2
2024/12/17 17:36:55 Gathered and reduced data from device 3
2024/12/17 17:36:55 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:55 Broadcast complete to device 1
2024/12/17 17:36:55 Broadcast complete to device 2
2024/12/17 17:36:55 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.683666ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 37.625292ms
    gpu_test.go:1267: Running Small size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:55 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:55 Gathered and reduced data from device 1
2024/12/17 17:36:55 Gathered and reduced data from device 2
2024/12/17 17:36:55 Gathered and reduced data from device 3
2024/12/17 17:36:55 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:55 Broadcast complete to device 1
2024/12/17 17:36:55 Broadcast complete to device 2
2024/12/17 17:36:55 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.985792ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 39.742459ms
    gpu_test.go:1267: Running Small size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:55 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:55 Gathered and reduced data from device 1
2024/12/17 17:36:55 Gathered and reduced data from device 2
2024/12/17 17:36:55 Gathered and reduced data from device 3
2024/12/17 17:36:55 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:55 Broadcast complete to device 1
2024/12/17 17:36:55 Broadcast complete to device 2
2024/12/17 17:36:55 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.189917ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 29.437292ms
    gpu_test.go:1358: 
        Performance comparison for Small size (10000 elements, 0.08 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 5.635558ms
    gpu_test.go:1361: Ring AllReduce:  36.693867ms
    gpu_test.go:1362: Speedup: 0.15x
=== RUN   TestAllReducePerformance/Medium
    gpu_test.go:1267: Running Medium size iteration 1/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:55 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:55 Gathered and reduced data from device 1
2024/12/17 17:36:55 Gathered and reduced data from device 2
2024/12/17 17:36:55 Gathered and reduced data from device 3
2024/12/17 17:36:55 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:55 Broadcast complete to device 1
2024/12/17 17:36:55 Broadcast complete to device 2
2024/12/17 17:36:55 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 12.455959ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 36.507917ms
    gpu_test.go:1267: Running Medium size iteration 2/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:56 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:56 Gathered and reduced data from device 1
2024/12/17 17:36:56 Gathered and reduced data from device 2
2024/12/17 17:36:56 Gathered and reduced data from device 3
2024/12/17 17:36:56 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:56 Broadcast complete to device 1
2024/12/17 17:36:56 Broadcast complete to device 2
2024/12/17 17:36:56 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 20.301458ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 37.289833ms
    gpu_test.go:1267: Running Medium size iteration 3/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:36:56 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:36:56 Gathered and reduced data from device 1
2024/12/17 17:36:56 Gathered and reduced data from device 2
2024/12/17 17:36:56 Gathered and reduced data from device 3
2024/12/17 17:36:56 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:56 Broadcast complete to device 1
2024/12/17 17:36:56 Broadcast complete to device 2
2024/12/17 17:36:56 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 21.561042ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 29.543167ms
    gpu_test.go:1358: 
        Performance comparison for Medium size (50000 elements, 0.38 MB), averaged over 3 iterations:
    gpu_test.go:1360: Naive AllReduce: 18.106153ms
    gpu_test.go:1361: Ring AllReduce:  34.446972ms
    gpu_test.go:1362: Speedup: 0.53x
=== RUN   TestAllReducePerformance/Large
    gpu_test.go:1267: Running Large size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:36:56 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:36:56 Gathered and reduced data from device 1
2024/12/17 17:36:56 Gathered and reduced data from device 2
2024/12/17 17:36:56 Gathered and reduced data from device 3
2024/12/17 17:36:56 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:56 Broadcast complete to device 1
2024/12/17 17:36:56 Broadcast complete to device 2
2024/12/17 17:36:56 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 30.02025ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 70.417125ms
    gpu_test.go:1267: Running Large size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:36:56 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:36:56 Gathered and reduced data from device 1
2024/12/17 17:36:56 Gathered and reduced data from device 2
2024/12/17 17:36:56 Gathered and reduced data from device 3
2024/12/17 17:36:56 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:56 Broadcast complete to device 1
2024/12/17 17:36:56 Broadcast complete to device 2
2024/12/17 17:36:56 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 48.016334ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 32.276417ms
    gpu_test.go:1358: 
        Performance comparison for Large size (100000 elements, 0.76 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 39.018292ms
    gpu_test.go:1361: Ring AllReduce:  51.346771ms
    gpu_test.go:1362: Speedup: 0.76x
=== RUN   TestAllReducePerformance/XLarge
    gpu_test.go:1267: Running XLarge size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:36:56 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:36:56 Gathered and reduced data from device 1
2024/12/17 17:36:56 Gathered and reduced data from device 2
2024/12/17 17:36:56 Gathered and reduced data from device 3
2024/12/17 17:36:56 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:56 Broadcast complete to device 1
2024/12/17 17:36:56 Broadcast complete to device 2
2024/12/17 17:36:56 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 57.917166ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 44.054541ms
    gpu_test.go:1267: Running XLarge size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:36:57 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:36:57 Gathered and reduced data from device 1
2024/12/17 17:36:57 Gathered and reduced data from device 2
2024/12/17 17:36:57 Gathered and reduced data from device 3
2024/12/17 17:36:57 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:57 Broadcast complete to device 1
2024/12/17 17:36:57 Broadcast complete to device 2
2024/12/17 17:36:57 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 13.640292ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 76.022625ms
    gpu_test.go:1358: 
        Performance comparison for XLarge size (200000 elements, 1.53 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 35.778729ms
    gpu_test.go:1361: Ring AllReduce:  60.038583ms
    gpu_test.go:1362: Speedup: 0.60x
=== RUN   TestAllReducePerformance/XXLarge
    gpu_test.go:1267: Running XXLarge size iteration 1/1...
    gpu_test.go:1305: Starting Naive AllReduce for size XXLarge...
2024/12/17 17:36:57 Naive AllReduce: Gathering all data to device 0 (data size: 3200000 bytes)
2024/12/17 17:36:57 Gathered and reduced data from device 1
2024/12/17 17:36:57 Gathered and reduced data from device 2
2024/12/17 17:36:57 Gathered and reduced data from device 3
2024/12/17 17:36:57 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:57 Broadcast complete to device 1
2024/12/17 17:36:57 Broadcast complete to device 2
2024/12/17 17:36:57 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 137.745791ms
    gpu_test.go:1322: Starting Ring AllReduce for size XXLarge...
    gpu_test.go:1343: Ring completed in 112.32625ms
    gpu_test.go:1358: 
        Performance comparison for XXLarge size (400000 elements, 3.05 MB), averaged over 1 iterations:
    gpu_test.go:1360: Naive AllReduce: 137.745791ms
    gpu_test.go:1361: Ring AllReduce:  112.32625ms
    gpu_test.go:1362: Speedup: 1.23x
--- PASS: TestAllReducePerformance (3.69s)
    --- PASS: TestAllReducePerformance/Tiny (0.87s)
    --- PASS: TestAllReducePerformance/Small (0.82s)
    --- PASS: TestAllReducePerformance/Medium (0.57s)
    --- PASS: TestAllReducePerformance/Large (0.50s)
    --- PASS: TestAllReducePerformance/XLarge (0.44s)
    --- PASS: TestAllReducePerformance/XXLarge (0.47s)
PASS
ok  	dsml/pkg/tests	4.166s
=== RUN   TestInitCommunicator
--- PASS: TestInitCommunicator (0.01s)
=== RUN   TestMemcpyToGPUs
--- PASS: TestMemcpyToGPUs (0.00s)
=== RUN   TestGroupOperations
--- PASS: TestGroupOperations (0.01s)
=== RUN   TestAllReduce
--- PASS: TestAllReduce (0.14s)
=== RUN   TestStatusChecking
--- PASS: TestStatusChecking (0.04s)
=== RUN   TestMemcpyFromGPU
--- PASS: TestMemcpyFromGPU (0.02s)
=== RUN   TestCompleteWorkflow
--- PASS: TestCompleteWorkflow (0.14s)
=== RUN   TestNaiveAllReduce
    gpu_test.go:987: Initializing device 0 with value 1.000000
    gpu_test.go:987: Initializing device 1 with value 2.000000
    gpu_test.go:987: Initializing device 2 with value 3.000000
    gpu_test.go:987: Initializing device 3 with value 4.000000
2024/12/17 17:36:58 Naive AllReduce: Gathering all data to device 0 (data size: 64 bytes)
2024/12/17 17:36:58 Gathered and reduced data from device 1
2024/12/17 17:36:58 Gathered and reduced data from device 2
2024/12/17 17:36:58 Gathered and reduced data from device 3
2024/12/17 17:36:58 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:58 Broadcast complete to device 1
2024/12/17 17:36:58 Broadcast complete to device 2
2024/12/17 17:36:58 Broadcast complete to device 3
    gpu_test.go:1048: Device 0 results verified
    gpu_test.go:1048: Device 1 results verified
    gpu_test.go:1048: Device 2 results verified
    gpu_test.go:1048: Device 3 results verified
--- PASS: TestNaiveAllReduce (0.02s)
=== RUN   TestAllReducePerformance
=== RUN   TestAllReducePerformance/Tiny
    gpu_test.go:1267: Running Tiny size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:58 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:58 Gathered and reduced data from device 1
2024/12/17 17:36:58 Gathered and reduced data from device 2
2024/12/17 17:36:58 Gathered and reduced data from device 3
2024/12/17 17:36:58 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:58 Broadcast complete to device 1
2024/12/17 17:36:58 Broadcast complete to device 2
2024/12/17 17:36:58 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.62075ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 28.163ms
    gpu_test.go:1267: Running Tiny size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:58 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:58 Gathered and reduced data from device 1
2024/12/17 17:36:58 Gathered and reduced data from device 2
2024/12/17 17:36:58 Gathered and reduced data from device 3
2024/12/17 17:36:58 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:58 Broadcast complete to device 1
2024/12/17 17:36:58 Broadcast complete to device 2
2024/12/17 17:36:58 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.657166ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 23.4375ms
    gpu_test.go:1267: Running Tiny size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:59 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:59 Gathered and reduced data from device 1
2024/12/17 17:36:59 Gathered and reduced data from device 2
2024/12/17 17:36:59 Gathered and reduced data from device 3
2024/12/17 17:36:59 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:59 Broadcast complete to device 1
2024/12/17 17:36:59 Broadcast complete to device 2
2024/12/17 17:36:59 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.289958ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 32.611083ms
    gpu_test.go:1267: Running Tiny size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:59 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:59 Gathered and reduced data from device 1
2024/12/17 17:36:59 Gathered and reduced data from device 2
2024/12/17 17:36:59 Gathered and reduced data from device 3
2024/12/17 17:36:59 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:59 Broadcast complete to device 1
2024/12/17 17:36:59 Broadcast complete to device 2
2024/12/17 17:36:59 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 1.905917ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 25.354083ms
    gpu_test.go:1267: Running Tiny size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:36:59 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:36:59 Gathered and reduced data from device 1
2024/12/17 17:36:59 Gathered and reduced data from device 2
2024/12/17 17:36:59 Gathered and reduced data from device 3
2024/12/17 17:36:59 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:59 Broadcast complete to device 1
2024/12/17 17:36:59 Broadcast complete to device 2
2024/12/17 17:36:59 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.660458ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 29.595875ms
    gpu_test.go:1358: 
        Performance comparison for Tiny size (1000 elements, 0.01 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 3.026849ms
    gpu_test.go:1361: Ring AllReduce:  27.832308ms
    gpu_test.go:1362: Speedup: 0.11x
=== RUN   TestAllReducePerformance/Small
    gpu_test.go:1267: Running Small size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:59 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:59 Gathered and reduced data from device 1
2024/12/17 17:36:59 Gathered and reduced data from device 2
2024/12/17 17:36:59 Gathered and reduced data from device 3
2024/12/17 17:36:59 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:59 Broadcast complete to device 1
2024/12/17 17:36:59 Broadcast complete to device 2
2024/12/17 17:36:59 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.836125ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 26.392292ms
    gpu_test.go:1267: Running Small size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:59 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:59 Gathered and reduced data from device 1
2024/12/17 17:36:59 Gathered and reduced data from device 2
2024/12/17 17:36:59 Gathered and reduced data from device 3
2024/12/17 17:36:59 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:59 Broadcast complete to device 1
2024/12/17 17:36:59 Broadcast complete to device 2
2024/12/17 17:36:59 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.330291ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 22.603583ms
    gpu_test.go:1267: Running Small size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:36:59 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:36:59 Gathered and reduced data from device 1
2024/12/17 17:36:59 Gathered and reduced data from device 2
2024/12/17 17:36:59 Gathered and reduced data from device 3
2024/12/17 17:36:59 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:36:59 Broadcast complete to device 1
2024/12/17 17:36:59 Broadcast complete to device 2
2024/12/17 17:36:59 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 15.133667ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 25.91325ms
    gpu_test.go:1267: Running Small size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:00 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:00 Gathered and reduced data from device 1
2024/12/17 17:37:00 Gathered and reduced data from device 2
2024/12/17 17:37:00 Gathered and reduced data from device 3
2024/12/17 17:37:00 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:00 Broadcast complete to device 1
2024/12/17 17:37:00 Broadcast complete to device 2
2024/12/17 17:37:00 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 6.242084ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 34.497292ms
    gpu_test.go:1267: Running Small size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:00 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:00 Gathered and reduced data from device 1
2024/12/17 17:37:00 Gathered and reduced data from device 2
2024/12/17 17:37:00 Gathered and reduced data from device 3
2024/12/17 17:37:00 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:00 Broadcast complete to device 1
2024/12/17 17:37:00 Broadcast complete to device 2
2024/12/17 17:37:00 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.732875ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 28.712709ms
    gpu_test.go:1358: 
        Performance comparison for Small size (10000 elements, 0.08 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 7.055008ms
    gpu_test.go:1361: Ring AllReduce:  27.623825ms
    gpu_test.go:1362: Speedup: 0.26x
=== RUN   TestAllReducePerformance/Medium
    gpu_test.go:1267: Running Medium size iteration 1/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:00 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:00 Gathered and reduced data from device 1
2024/12/17 17:37:00 Gathered and reduced data from device 2
2024/12/17 17:37:00 Gathered and reduced data from device 3
2024/12/17 17:37:00 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:00 Broadcast complete to device 1
2024/12/17 17:37:00 Broadcast complete to device 2
2024/12/17 17:37:00 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 11.624041ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 40.871209ms
    gpu_test.go:1267: Running Medium size iteration 2/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:00 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:00 Gathered and reduced data from device 1
2024/12/17 17:37:00 Gathered and reduced data from device 2
2024/12/17 17:37:00 Gathered and reduced data from device 3
2024/12/17 17:37:00 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:00 Broadcast complete to device 1
2024/12/17 17:37:00 Broadcast complete to device 2
2024/12/17 17:37:00 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 17.279792ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 43.259958ms
    gpu_test.go:1267: Running Medium size iteration 3/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:00 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:00 Gathered and reduced data from device 1
2024/12/17 17:37:00 Gathered and reduced data from device 2
2024/12/17 17:37:00 Gathered and reduced data from device 3
2024/12/17 17:37:00 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:00 Broadcast complete to device 1
2024/12/17 17:37:00 Broadcast complete to device 2
2024/12/17 17:37:00 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 31.198625ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 51.328834ms
    gpu_test.go:1358: 
        Performance comparison for Medium size (50000 elements, 0.38 MB), averaged over 3 iterations:
    gpu_test.go:1360: Naive AllReduce: 20.034152ms
    gpu_test.go:1361: Ring AllReduce:  45.153333ms
    gpu_test.go:1362: Speedup: 0.44x
=== RUN   TestAllReducePerformance/Large
    gpu_test.go:1267: Running Large size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:37:01 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:37:01 Gathered and reduced data from device 1
2024/12/17 17:37:01 Gathered and reduced data from device 2
2024/12/17 17:37:01 Gathered and reduced data from device 3
2024/12/17 17:37:01 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:01 Broadcast complete to device 1
2024/12/17 17:37:01 Broadcast complete to device 2
2024/12/17 17:37:01 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 47.571333ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 48.627833ms
    gpu_test.go:1267: Running Large size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:37:01 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:37:01 Gathered and reduced data from device 1
2024/12/17 17:37:01 Gathered and reduced data from device 2
2024/12/17 17:37:01 Gathered and reduced data from device 3
2024/12/17 17:37:01 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:01 Broadcast complete to device 1
2024/12/17 17:37:01 Broadcast complete to device 2
2024/12/17 17:37:01 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 21.179334ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 32.598959ms
    gpu_test.go:1358: 
        Performance comparison for Large size (100000 elements, 0.76 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 34.375333ms
    gpu_test.go:1361: Ring AllReduce:  40.613396ms
    gpu_test.go:1362: Speedup: 0.85x
=== RUN   TestAllReducePerformance/XLarge
    gpu_test.go:1267: Running XLarge size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:37:01 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:37:01 Gathered and reduced data from device 1
2024/12/17 17:37:01 Gathered and reduced data from device 2
2024/12/17 17:37:01 Gathered and reduced data from device 3
2024/12/17 17:37:01 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:01 Broadcast complete to device 1
2024/12/17 17:37:01 Broadcast complete to device 2
2024/12/17 17:37:01 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 18.668ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 41.437917ms
    gpu_test.go:1267: Running XLarge size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:37:01 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:37:01 Gathered and reduced data from device 1
2024/12/17 17:37:01 Gathered and reduced data from device 2
2024/12/17 17:37:01 Gathered and reduced data from device 3
2024/12/17 17:37:01 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:01 Broadcast complete to device 1
2024/12/17 17:37:01 Broadcast complete to device 2
2024/12/17 17:37:01 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 73.130791ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 58.974375ms
    gpu_test.go:1358: 
        Performance comparison for XLarge size (200000 elements, 1.53 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 45.899395ms
    gpu_test.go:1361: Ring AllReduce:  50.206146ms
    gpu_test.go:1362: Speedup: 0.91x
=== RUN   TestAllReducePerformance/XXLarge
    gpu_test.go:1267: Running XXLarge size iteration 1/1...
    gpu_test.go:1305: Starting Naive AllReduce for size XXLarge...
2024/12/17 17:37:01 Naive AllReduce: Gathering all data to device 0 (data size: 3200000 bytes)
2024/12/17 17:37:01 Gathered and reduced data from device 1
2024/12/17 17:37:01 Gathered and reduced data from device 2
2024/12/17 17:37:01 Gathered and reduced data from device 3
2024/12/17 17:37:01 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:01 Broadcast complete to device 1
2024/12/17 17:37:01 Broadcast complete to device 2
2024/12/17 17:37:01 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 30.975084ms
    gpu_test.go:1322: Starting Ring AllReduce for size XXLarge...
    gpu_test.go:1343: Ring completed in 160.222708ms
    gpu_test.go:1358: 
        Performance comparison for XXLarge size (400000 elements, 3.05 MB), averaged over 1 iterations:
    gpu_test.go:1360: Naive AllReduce: 30.975084ms
    gpu_test.go:1361: Ring AllReduce:  160.222708ms
    gpu_test.go:1362: Speedup: 0.19x
--- PASS: TestAllReducePerformance (3.50s)
    --- PASS: TestAllReducePerformance/Tiny (0.77s)
    --- PASS: TestAllReducePerformance/Small (0.81s)
    --- PASS: TestAllReducePerformance/Medium (0.64s)
    --- PASS: TestAllReducePerformance/Large (0.45s)
    --- PASS: TestAllReducePerformance/XLarge (0.46s)
    --- PASS: TestAllReducePerformance/XXLarge (0.37s)
PASS
ok  	dsml/pkg/tests	3.988s
=== RUN   TestInitCommunicator
--- PASS: TestInitCommunicator (0.01s)
=== RUN   TestMemcpyToGPUs
--- PASS: TestMemcpyToGPUs (0.00s)
=== RUN   TestGroupOperations
--- PASS: TestGroupOperations (0.01s)
=== RUN   TestAllReduce
--- PASS: TestAllReduce (0.14s)
=== RUN   TestStatusChecking
--- PASS: TestStatusChecking (0.03s)
=== RUN   TestMemcpyFromGPU
--- PASS: TestMemcpyFromGPU (0.03s)
=== RUN   TestCompleteWorkflow
--- PASS: TestCompleteWorkflow (0.14s)
=== RUN   TestNaiveAllReduce
    gpu_test.go:987: Initializing device 0 with value 1.000000
    gpu_test.go:987: Initializing device 1 with value 2.000000
    gpu_test.go:987: Initializing device 2 with value 3.000000
    gpu_test.go:987: Initializing device 3 with value 4.000000
2024/12/17 17:37:03 Naive AllReduce: Gathering all data to device 0 (data size: 64 bytes)
2024/12/17 17:37:03 Gathered and reduced data from device 1
2024/12/17 17:37:03 Gathered and reduced data from device 2
2024/12/17 17:37:03 Gathered and reduced data from device 3
2024/12/17 17:37:03 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:03 Broadcast complete to device 1
2024/12/17 17:37:03 Broadcast complete to device 2
2024/12/17 17:37:03 Broadcast complete to device 3
    gpu_test.go:1048: Device 0 results verified
    gpu_test.go:1048: Device 1 results verified
    gpu_test.go:1048: Device 2 results verified
    gpu_test.go:1048: Device 3 results verified
--- PASS: TestNaiveAllReduce (0.02s)
=== RUN   TestAllReducePerformance
=== RUN   TestAllReducePerformance/Tiny
    gpu_test.go:1267: Running Tiny size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:03 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:03 Gathered and reduced data from device 1
2024/12/17 17:37:03 Gathered and reduced data from device 2
2024/12/17 17:37:03 Gathered and reduced data from device 3
2024/12/17 17:37:03 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:03 Broadcast complete to device 1
2024/12/17 17:37:03 Broadcast complete to device 2
2024/12/17 17:37:03 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.431875ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 27.263458ms
    gpu_test.go:1267: Running Tiny size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:03 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:03 Gathered and reduced data from device 1
2024/12/17 17:37:03 Gathered and reduced data from device 2
2024/12/17 17:37:03 Gathered and reduced data from device 3
2024/12/17 17:37:03 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:03 Broadcast complete to device 1
2024/12/17 17:37:03 Broadcast complete to device 2
2024/12/17 17:37:03 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.511208ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 32.717666ms
    gpu_test.go:1267: Running Tiny size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:03 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:03 Gathered and reduced data from device 1
2024/12/17 17:37:03 Gathered and reduced data from device 2
2024/12/17 17:37:03 Gathered and reduced data from device 3
2024/12/17 17:37:03 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:03 Broadcast complete to device 1
2024/12/17 17:37:03 Broadcast complete to device 2
2024/12/17 17:37:03 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.233209ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 25.633959ms
    gpu_test.go:1267: Running Tiny size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:03 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:03 Gathered and reduced data from device 1
2024/12/17 17:37:03 Gathered and reduced data from device 2
2024/12/17 17:37:03 Gathered and reduced data from device 3
2024/12/17 17:37:03 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:03 Broadcast complete to device 1
2024/12/17 17:37:03 Broadcast complete to device 2
2024/12/17 17:37:03 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.119166ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 31.875291ms
    gpu_test.go:1267: Running Tiny size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:03 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:03 Gathered and reduced data from device 1
2024/12/17 17:37:03 Gathered and reduced data from device 2
2024/12/17 17:37:03 Gathered and reduced data from device 3
2024/12/17 17:37:03 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:03 Broadcast complete to device 1
2024/12/17 17:37:03 Broadcast complete to device 2
2024/12/17 17:37:03 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.221958ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 29.399834ms
    gpu_test.go:1358: 
        Performance comparison for Tiny size (1000 elements, 0.01 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 4.303483ms
    gpu_test.go:1361: Ring AllReduce:  29.378041ms
    gpu_test.go:1362: Speedup: 0.15x
=== RUN   TestAllReducePerformance/Small
    gpu_test.go:1267: Running Small size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:04 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:04 Gathered and reduced data from device 1
2024/12/17 17:37:04 Gathered and reduced data from device 2
2024/12/17 17:37:04 Gathered and reduced data from device 3
2024/12/17 17:37:04 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:04 Broadcast complete to device 1
2024/12/17 17:37:04 Broadcast complete to device 2
2024/12/17 17:37:04 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 12.793ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 44.108916ms
    gpu_test.go:1267: Running Small size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:04 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:04 Gathered and reduced data from device 1
2024/12/17 17:37:04 Gathered and reduced data from device 2
2024/12/17 17:37:04 Gathered and reduced data from device 3
2024/12/17 17:37:04 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:04 Broadcast complete to device 1
2024/12/17 17:37:04 Broadcast complete to device 2
2024/12/17 17:37:04 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.068041ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 26.221458ms
    gpu_test.go:1267: Running Small size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:04 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:04 Gathered and reduced data from device 1
2024/12/17 17:37:04 Gathered and reduced data from device 2
2024/12/17 17:37:04 Gathered and reduced data from device 3
2024/12/17 17:37:04 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:04 Broadcast complete to device 1
2024/12/17 17:37:04 Broadcast complete to device 2
2024/12/17 17:37:04 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.710333ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 28.196084ms
    gpu_test.go:1267: Running Small size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:04 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:04 Gathered and reduced data from device 1
2024/12/17 17:37:04 Gathered and reduced data from device 2
2024/12/17 17:37:04 Gathered and reduced data from device 3
2024/12/17 17:37:04 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:04 Broadcast complete to device 1
2024/12/17 17:37:04 Broadcast complete to device 2
2024/12/17 17:37:04 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 7.908792ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 42.556625ms
    gpu_test.go:1267: Running Small size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:04 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:04 Gathered and reduced data from device 1
2024/12/17 17:37:04 Gathered and reduced data from device 2
2024/12/17 17:37:04 Gathered and reduced data from device 3
2024/12/17 17:37:04 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:04 Broadcast complete to device 1
2024/12/17 17:37:04 Broadcast complete to device 2
2024/12/17 17:37:04 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 6.980167ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 26.227042ms
    gpu_test.go:1358: 
        Performance comparison for Small size (10000 elements, 0.08 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 7.292066ms
    gpu_test.go:1361: Ring AllReduce:  33.462025ms
    gpu_test.go:1362: Speedup: 0.22x
=== RUN   TestAllReducePerformance/Medium
    gpu_test.go:1267: Running Medium size iteration 1/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:04 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:04 Gathered and reduced data from device 1
2024/12/17 17:37:04 Gathered and reduced data from device 2
2024/12/17 17:37:04 Gathered and reduced data from device 3
2024/12/17 17:37:04 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:04 Broadcast complete to device 1
2024/12/17 17:37:04 Broadcast complete to device 2
2024/12/17 17:37:04 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 18.498167ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 32.862917ms
    gpu_test.go:1267: Running Medium size iteration 2/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:05 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:05 Gathered and reduced data from device 1
2024/12/17 17:37:05 Gathered and reduced data from device 2
2024/12/17 17:37:05 Gathered and reduced data from device 3
2024/12/17 17:37:05 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:05 Broadcast complete to device 1
2024/12/17 17:37:05 Broadcast complete to device 2
2024/12/17 17:37:05 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 43.494667ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 46.803458ms
    gpu_test.go:1267: Running Medium size iteration 3/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:05 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:05 Gathered and reduced data from device 1
2024/12/17 17:37:05 Gathered and reduced data from device 2
2024/12/17 17:37:05 Gathered and reduced data from device 3
2024/12/17 17:37:05 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:05 Broadcast complete to device 1
2024/12/17 17:37:05 Broadcast complete to device 2
2024/12/17 17:37:05 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 13.936917ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 26.490375ms
    gpu_test.go:1358: 
        Performance comparison for Medium size (50000 elements, 0.38 MB), averaged over 3 iterations:
    gpu_test.go:1360: Naive AllReduce: 25.309917ms
    gpu_test.go:1361: Ring AllReduce:  35.385583ms
    gpu_test.go:1362: Speedup: 0.72x
=== RUN   TestAllReducePerformance/Large
    gpu_test.go:1267: Running Large size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:37:05 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:37:05 Gathered and reduced data from device 1
2024/12/17 17:37:05 Gathered and reduced data from device 2
2024/12/17 17:37:05 Gathered and reduced data from device 3
2024/12/17 17:37:05 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:05 Broadcast complete to device 1
2024/12/17 17:37:05 Broadcast complete to device 2
2024/12/17 17:37:05 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 16.467667ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 63.059708ms
    gpu_test.go:1267: Running Large size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:37:05 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:37:05 Gathered and reduced data from device 1
2024/12/17 17:37:05 Gathered and reduced data from device 2
2024/12/17 17:37:05 Gathered and reduced data from device 3
2024/12/17 17:37:05 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:05 Broadcast complete to device 1
2024/12/17 17:37:05 Broadcast complete to device 2
2024/12/17 17:37:05 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 20.201375ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 31.762209ms
    gpu_test.go:1358: 
        Performance comparison for Large size (100000 elements, 0.76 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 18.334521ms
    gpu_test.go:1361: Ring AllReduce:  47.410958ms
    gpu_test.go:1362: Speedup: 0.39x
=== RUN   TestAllReducePerformance/XLarge
    gpu_test.go:1267: Running XLarge size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:37:06 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:37:06 Gathered and reduced data from device 1
2024/12/17 17:37:06 Gathered and reduced data from device 2
2024/12/17 17:37:06 Gathered and reduced data from device 3
2024/12/17 17:37:06 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:06 Broadcast complete to device 1
2024/12/17 17:37:06 Broadcast complete to device 2
2024/12/17 17:37:06 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 42.207625ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 34.070542ms
    gpu_test.go:1267: Running XLarge size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:37:06 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:37:06 Gathered and reduced data from device 1
2024/12/17 17:37:06 Gathered and reduced data from device 2
2024/12/17 17:37:06 Gathered and reduced data from device 3
2024/12/17 17:37:06 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:06 Broadcast complete to device 1
2024/12/17 17:37:06 Broadcast complete to device 2
2024/12/17 17:37:06 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 18.806583ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 49.407334ms
    gpu_test.go:1358: 
        Performance comparison for XLarge size (200000 elements, 1.53 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 30.507104ms
    gpu_test.go:1361: Ring AllReduce:  41.738938ms
    gpu_test.go:1362: Speedup: 0.73x
=== RUN   TestAllReducePerformance/XXLarge
    gpu_test.go:1267: Running XXLarge size iteration 1/1...
    gpu_test.go:1305: Starting Naive AllReduce for size XXLarge...
2024/12/17 17:37:06 Naive AllReduce: Gathering all data to device 0 (data size: 3200000 bytes)
2024/12/17 17:37:06 Gathered and reduced data from device 1
2024/12/17 17:37:06 Gathered and reduced data from device 2
2024/12/17 17:37:06 Gathered and reduced data from device 3
2024/12/17 17:37:06 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:06 Broadcast complete to device 1
2024/12/17 17:37:06 Broadcast complete to device 2
2024/12/17 17:37:06 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 113.895666ms
    gpu_test.go:1322: Starting Ring AllReduce for size XXLarge...
    gpu_test.go:1343: Ring completed in 71.466208ms
    gpu_test.go:1358: 
        Performance comparison for XXLarge size (400000 elements, 3.05 MB), averaged over 1 iterations:
    gpu_test.go:1360: Naive AllReduce: 113.895666ms
    gpu_test.go:1361: Ring AllReduce:  71.466208ms
    gpu_test.go:1362: Speedup: 1.59x
--- PASS: TestAllReducePerformance (3.55s)
    --- PASS: TestAllReducePerformance/Tiny (0.79s)
    --- PASS: TestAllReducePerformance/Small (0.85s)
    --- PASS: TestAllReducePerformance/Medium (0.64s)
    --- PASS: TestAllReducePerformance/Large (0.43s)
    --- PASS: TestAllReducePerformance/XLarge (0.41s)
    --- PASS: TestAllReducePerformance/XXLarge (0.43s)
PASS
ok  	dsml/pkg/tests	3.981s
=== RUN   TestInitCommunicator
--- PASS: TestInitCommunicator (0.01s)
=== RUN   TestMemcpyToGPUs
--- PASS: TestMemcpyToGPUs (0.02s)
=== RUN   TestGroupOperations
--- PASS: TestGroupOperations (0.01s)
=== RUN   TestAllReduce
--- PASS: TestAllReduce (0.13s)
=== RUN   TestStatusChecking
--- PASS: TestStatusChecking (0.01s)
=== RUN   TestMemcpyFromGPU
--- PASS: TestMemcpyFromGPU (0.03s)
=== RUN   TestCompleteWorkflow
--- PASS: TestCompleteWorkflow (0.14s)
=== RUN   TestNaiveAllReduce
    gpu_test.go:987: Initializing device 0 with value 1.000000
    gpu_test.go:987: Initializing device 1 with value 2.000000
    gpu_test.go:987: Initializing device 2 with value 3.000000
    gpu_test.go:987: Initializing device 3 with value 4.000000
2024/12/17 17:37:07 Naive AllReduce: Gathering all data to device 0 (data size: 64 bytes)
2024/12/17 17:37:07 Gathered and reduced data from device 1
2024/12/17 17:37:07 Gathered and reduced data from device 2
2024/12/17 17:37:07 Gathered and reduced data from device 3
2024/12/17 17:37:07 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:07 Broadcast complete to device 1
2024/12/17 17:37:07 Broadcast complete to device 2
2024/12/17 17:37:07 Broadcast complete to device 3
    gpu_test.go:1048: Device 0 results verified
    gpu_test.go:1048: Device 1 results verified
    gpu_test.go:1048: Device 2 results verified
    gpu_test.go:1048: Device 3 results verified
--- PASS: TestNaiveAllReduce (0.02s)
=== RUN   TestAllReducePerformance
=== RUN   TestAllReducePerformance/Tiny
    gpu_test.go:1267: Running Tiny size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:07 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:07 Gathered and reduced data from device 1
2024/12/17 17:37:07 Gathered and reduced data from device 2
2024/12/17 17:37:07 Gathered and reduced data from device 3
2024/12/17 17:37:07 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:07 Broadcast complete to device 1
2024/12/17 17:37:07 Broadcast complete to device 2
2024/12/17 17:37:07 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.61475ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 26.870666ms
    gpu_test.go:1267: Running Tiny size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:07 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:07 Gathered and reduced data from device 1
2024/12/17 17:37:07 Gathered and reduced data from device 2
2024/12/17 17:37:07 Gathered and reduced data from device 3
2024/12/17 17:37:07 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:07 Broadcast complete to device 1
2024/12/17 17:37:07 Broadcast complete to device 2
2024/12/17 17:37:07 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.487167ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 31.455792ms
    gpu_test.go:1267: Running Tiny size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:08 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:08 Gathered and reduced data from device 1
2024/12/17 17:37:08 Gathered and reduced data from device 2
2024/12/17 17:37:08 Gathered and reduced data from device 3
2024/12/17 17:37:08 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:08 Broadcast complete to device 1
2024/12/17 17:37:08 Broadcast complete to device 2
2024/12/17 17:37:08 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.508542ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 31.289167ms
    gpu_test.go:1267: Running Tiny size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:08 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:08 Gathered and reduced data from device 1
2024/12/17 17:37:08 Gathered and reduced data from device 2
2024/12/17 17:37:08 Gathered and reduced data from device 3
2024/12/17 17:37:08 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:08 Broadcast complete to device 1
2024/12/17 17:37:08 Broadcast complete to device 2
2024/12/17 17:37:08 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.8745ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 25.178417ms
    gpu_test.go:1267: Running Tiny size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:08 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:08 Gathered and reduced data from device 1
2024/12/17 17:37:08 Gathered and reduced data from device 2
2024/12/17 17:37:08 Gathered and reduced data from device 3
2024/12/17 17:37:08 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:08 Broadcast complete to device 1
2024/12/17 17:37:08 Broadcast complete to device 2
2024/12/17 17:37:08 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.742833ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 25.233084ms
    gpu_test.go:1358: 
        Performance comparison for Tiny size (1000 elements, 0.01 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 4.245558ms
    gpu_test.go:1361: Ring AllReduce:  28.005425ms
    gpu_test.go:1362: Speedup: 0.15x
=== RUN   TestAllReducePerformance/Small
    gpu_test.go:1267: Running Small size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:08 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:08 Gathered and reduced data from device 1
2024/12/17 17:37:08 Gathered and reduced data from device 2
2024/12/17 17:37:08 Gathered and reduced data from device 3
2024/12/17 17:37:08 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:08 Broadcast complete to device 1
2024/12/17 17:37:08 Broadcast complete to device 2
2024/12/17 17:37:08 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 7.871958ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 30.832584ms
    gpu_test.go:1267: Running Small size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:08 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:08 Gathered and reduced data from device 1
2024/12/17 17:37:08 Gathered and reduced data from device 2
2024/12/17 17:37:08 Gathered and reduced data from device 3
2024/12/17 17:37:08 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:08 Broadcast complete to device 1
2024/12/17 17:37:08 Broadcast complete to device 2
2024/12/17 17:37:08 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.124958ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 25.853791ms
    gpu_test.go:1267: Running Small size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:08 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:08 Gathered and reduced data from device 1
2024/12/17 17:37:08 Gathered and reduced data from device 2
2024/12/17 17:37:08 Gathered and reduced data from device 3
2024/12/17 17:37:08 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:08 Broadcast complete to device 1
2024/12/17 17:37:08 Broadcast complete to device 2
2024/12/17 17:37:08 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.108042ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 24.929125ms
    gpu_test.go:1267: Running Small size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:09 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:09 Gathered and reduced data from device 1
2024/12/17 17:37:09 Gathered and reduced data from device 2
2024/12/17 17:37:09 Gathered and reduced data from device 3
2024/12/17 17:37:09 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:09 Broadcast complete to device 1
2024/12/17 17:37:09 Broadcast complete to device 2
2024/12/17 17:37:09 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 15.121042ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 27.824583ms
    gpu_test.go:1267: Running Small size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:09 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:09 Gathered and reduced data from device 1
2024/12/17 17:37:09 Gathered and reduced data from device 2
2024/12/17 17:37:09 Gathered and reduced data from device 3
2024/12/17 17:37:09 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:09 Broadcast complete to device 1
2024/12/17 17:37:09 Broadcast complete to device 2
2024/12/17 17:37:09 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 15.437291ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 41.068041ms
    gpu_test.go:1358: 
        Performance comparison for Small size (10000 elements, 0.08 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 9.532658ms
    gpu_test.go:1361: Ring AllReduce:  30.101624ms
    gpu_test.go:1362: Speedup: 0.32x
=== RUN   TestAllReducePerformance/Medium
    gpu_test.go:1267: Running Medium size iteration 1/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:09 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:09 Gathered and reduced data from device 1
2024/12/17 17:37:09 Gathered and reduced data from device 2
2024/12/17 17:37:09 Gathered and reduced data from device 3
2024/12/17 17:37:09 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:09 Broadcast complete to device 1
2024/12/17 17:37:09 Broadcast complete to device 2
2024/12/17 17:37:09 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 9.669959ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 33.725041ms
    gpu_test.go:1267: Running Medium size iteration 2/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:09 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:09 Gathered and reduced data from device 1
2024/12/17 17:37:09 Gathered and reduced data from device 2
2024/12/17 17:37:09 Gathered and reduced data from device 3
2024/12/17 17:37:09 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:09 Broadcast complete to device 1
2024/12/17 17:37:09 Broadcast complete to device 2
2024/12/17 17:37:09 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 32.726583ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 55.730917ms
    gpu_test.go:1267: Running Medium size iteration 3/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:09 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:09 Gathered and reduced data from device 1
2024/12/17 17:37:09 Gathered and reduced data from device 2
2024/12/17 17:37:09 Gathered and reduced data from device 3
2024/12/17 17:37:09 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:09 Broadcast complete to device 1
2024/12/17 17:37:09 Broadcast complete to device 2
2024/12/17 17:37:09 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.743292ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 28.492ms
    gpu_test.go:1358: 
        Performance comparison for Medium size (50000 elements, 0.38 MB), averaged over 3 iterations:
    gpu_test.go:1360: Naive AllReduce: 15.713278ms
    gpu_test.go:1361: Ring AllReduce:  39.315986ms
    gpu_test.go:1362: Speedup: 0.40x
=== RUN   TestAllReducePerformance/Large
    gpu_test.go:1267: Running Large size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:37:10 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:37:10 Gathered and reduced data from device 1
2024/12/17 17:37:10 Gathered and reduced data from device 2
2024/12/17 17:37:10 Gathered and reduced data from device 3
2024/12/17 17:37:10 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:10 Broadcast complete to device 1
2024/12/17 17:37:10 Broadcast complete to device 2
2024/12/17 17:37:10 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 15.234292ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 49.257125ms
    gpu_test.go:1267: Running Large size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:37:10 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:37:10 Gathered and reduced data from device 1
2024/12/17 17:37:10 Gathered and reduced data from device 2
2024/12/17 17:37:10 Gathered and reduced data from device 3
2024/12/17 17:37:10 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:10 Broadcast complete to device 1
2024/12/17 17:37:10 Broadcast complete to device 2
2024/12/17 17:37:10 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 49.707542ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 116.225ms
    gpu_test.go:1358: 
        Performance comparison for Large size (100000 elements, 0.76 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 32.470917ms
    gpu_test.go:1361: Ring AllReduce:  82.741062ms
    gpu_test.go:1362: Speedup: 0.39x
=== RUN   TestAllReducePerformance/XLarge
    gpu_test.go:1267: Running XLarge size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:37:10 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:37:10 Gathered and reduced data from device 1
2024/12/17 17:37:10 Gathered and reduced data from device 2
2024/12/17 17:37:10 Gathered and reduced data from device 3
2024/12/17 17:37:10 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:10 Broadcast complete to device 1
2024/12/17 17:37:10 Broadcast complete to device 2
2024/12/17 17:37:10 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 61.413167ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 55.089416ms
    gpu_test.go:1267: Running XLarge size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:37:10 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:37:10 Gathered and reduced data from device 1
2024/12/17 17:37:10 Gathered and reduced data from device 2
2024/12/17 17:37:10 Gathered and reduced data from device 3
2024/12/17 17:37:10 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:10 Broadcast complete to device 1
2024/12/17 17:37:10 Broadcast complete to device 2
2024/12/17 17:37:10 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 27.830042ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 62.678458ms
    gpu_test.go:1358: 
        Performance comparison for XLarge size (200000 elements, 1.53 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 44.621604ms
    gpu_test.go:1361: Ring AllReduce:  58.883937ms
    gpu_test.go:1362: Speedup: 0.76x
=== RUN   TestAllReducePerformance/XXLarge
    gpu_test.go:1267: Running XXLarge size iteration 1/1...
    gpu_test.go:1305: Starting Naive AllReduce for size XXLarge...
2024/12/17 17:37:11 Naive AllReduce: Gathering all data to device 0 (data size: 3200000 bytes)
2024/12/17 17:37:11 Gathered and reduced data from device 1
2024/12/17 17:37:11 Gathered and reduced data from device 2
2024/12/17 17:37:11 Gathered and reduced data from device 3
2024/12/17 17:37:11 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:11 Broadcast complete to device 1
2024/12/17 17:37:11 Broadcast complete to device 2
2024/12/17 17:37:11 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 82.470875ms
    gpu_test.go:1322: Starting Ring AllReduce for size XXLarge...
    gpu_test.go:1343: Ring completed in 51.663458ms
    gpu_test.go:1358: 
        Performance comparison for XXLarge size (400000 elements, 3.05 MB), averaged over 1 iterations:
    gpu_test.go:1360: Naive AllReduce: 82.470875ms
    gpu_test.go:1361: Ring AllReduce:  51.663458ms
    gpu_test.go:1362: Speedup: 1.60x
--- PASS: TestAllReducePerformance (3.64s)
    --- PASS: TestAllReducePerformance/Tiny (0.80s)
    --- PASS: TestAllReducePerformance/Small (0.86s)
    --- PASS: TestAllReducePerformance/Medium (0.59s)
    --- PASS: TestAllReducePerformance/Large (0.56s)
    --- PASS: TestAllReducePerformance/XLarge (0.50s)
    --- PASS: TestAllReducePerformance/XXLarge (0.33s)
PASS
ok  	dsml/pkg/tests	4.064s
=== RUN   TestInitCommunicator
--- PASS: TestInitCommunicator (0.01s)
=== RUN   TestMemcpyToGPUs
--- PASS: TestMemcpyToGPUs (0.01s)
=== RUN   TestGroupOperations
--- PASS: TestGroupOperations (0.01s)
=== RUN   TestAllReduce
--- PASS: TestAllReduce (0.14s)
=== RUN   TestStatusChecking
--- PASS: TestStatusChecking (0.02s)
=== RUN   TestMemcpyFromGPU
--- PASS: TestMemcpyFromGPU (0.02s)
=== RUN   TestCompleteWorkflow
--- PASS: TestCompleteWorkflow (0.15s)
=== RUN   TestNaiveAllReduce
    gpu_test.go:987: Initializing device 0 with value 1.000000
    gpu_test.go:987: Initializing device 1 with value 2.000000
    gpu_test.go:987: Initializing device 2 with value 3.000000
    gpu_test.go:987: Initializing device 3 with value 4.000000
2024/12/17 17:37:12 Naive AllReduce: Gathering all data to device 0 (data size: 64 bytes)
2024/12/17 17:37:12 Gathered and reduced data from device 1
2024/12/17 17:37:12 Gathered and reduced data from device 2
2024/12/17 17:37:12 Gathered and reduced data from device 3
2024/12/17 17:37:12 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:12 Broadcast complete to device 1
2024/12/17 17:37:12 Broadcast complete to device 2
2024/12/17 17:37:12 Broadcast complete to device 3
    gpu_test.go:1048: Device 0 results verified
    gpu_test.go:1048: Device 1 results verified
    gpu_test.go:1048: Device 2 results verified
    gpu_test.go:1048: Device 3 results verified
--- PASS: TestNaiveAllReduce (0.01s)
=== RUN   TestAllReducePerformance
=== RUN   TestAllReducePerformance/Tiny
    gpu_test.go:1267: Running Tiny size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:12 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:12 Gathered and reduced data from device 1
2024/12/17 17:37:12 Gathered and reduced data from device 2
2024/12/17 17:37:12 Gathered and reduced data from device 3
2024/12/17 17:37:12 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:12 Broadcast complete to device 1
2024/12/17 17:37:12 Broadcast complete to device 2
2024/12/17 17:37:12 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.044625ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 25.374958ms
    gpu_test.go:1267: Running Tiny size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:12 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:12 Gathered and reduced data from device 1
2024/12/17 17:37:12 Gathered and reduced data from device 2
2024/12/17 17:37:12 Gathered and reduced data from device 3
2024/12/17 17:37:12 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:12 Broadcast complete to device 1
2024/12/17 17:37:12 Broadcast complete to device 2
2024/12/17 17:37:12 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.515ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 28.067125ms
    gpu_test.go:1267: Running Tiny size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:12 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:12 Gathered and reduced data from device 1
2024/12/17 17:37:12 Gathered and reduced data from device 2
2024/12/17 17:37:12 Gathered and reduced data from device 3
2024/12/17 17:37:12 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:12 Broadcast complete to device 1
2024/12/17 17:37:12 Broadcast complete to device 2
2024/12/17 17:37:12 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 10.46825ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 33.146458ms
    gpu_test.go:1267: Running Tiny size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:12 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:12 Gathered and reduced data from device 1
2024/12/17 17:37:12 Gathered and reduced data from device 2
2024/12/17 17:37:12 Gathered and reduced data from device 3
2024/12/17 17:37:12 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:12 Broadcast complete to device 1
2024/12/17 17:37:12 Broadcast complete to device 2
2024/12/17 17:37:12 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.000167ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 26.094875ms
    gpu_test.go:1267: Running Tiny size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:12 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:12 Gathered and reduced data from device 1
2024/12/17 17:37:12 Gathered and reduced data from device 2
2024/12/17 17:37:12 Gathered and reduced data from device 3
2024/12/17 17:37:12 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:12 Broadcast complete to device 1
2024/12/17 17:37:12 Broadcast complete to device 2
2024/12/17 17:37:12 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.079625ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 23.801333ms
    gpu_test.go:1358: 
        Performance comparison for Tiny size (1000 elements, 0.01 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 4.221533ms
    gpu_test.go:1361: Ring AllReduce:  27.296949ms
    gpu_test.go:1362: Speedup: 0.15x
=== RUN   TestAllReducePerformance/Small
    gpu_test.go:1267: Running Small size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:13 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:13 Gathered and reduced data from device 1
2024/12/17 17:37:13 Gathered and reduced data from device 2
2024/12/17 17:37:13 Gathered and reduced data from device 3
2024/12/17 17:37:13 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:13 Broadcast complete to device 1
2024/12/17 17:37:13 Broadcast complete to device 2
2024/12/17 17:37:13 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.26025ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 25.44375ms
    gpu_test.go:1267: Running Small size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:13 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:13 Gathered and reduced data from device 1
2024/12/17 17:37:13 Gathered and reduced data from device 2
2024/12/17 17:37:13 Gathered and reduced data from device 3
2024/12/17 17:37:13 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:13 Broadcast complete to device 1
2024/12/17 17:37:13 Broadcast complete to device 2
2024/12/17 17:37:13 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.897875ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 31.136917ms
    gpu_test.go:1267: Running Small size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:13 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:13 Gathered and reduced data from device 1
2024/12/17 17:37:13 Gathered and reduced data from device 2
2024/12/17 17:37:13 Gathered and reduced data from device 3
2024/12/17 17:37:13 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:13 Broadcast complete to device 1
2024/12/17 17:37:13 Broadcast complete to device 2
2024/12/17 17:37:13 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.514291ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 25.8405ms
    gpu_test.go:1267: Running Small size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:13 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:13 Gathered and reduced data from device 1
2024/12/17 17:37:13 Gathered and reduced data from device 2
2024/12/17 17:37:13 Gathered and reduced data from device 3
2024/12/17 17:37:13 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:13 Broadcast complete to device 1
2024/12/17 17:37:13 Broadcast complete to device 2
2024/12/17 17:37:13 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.674334ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 25.697791ms
    gpu_test.go:1267: Running Small size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:13 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:13 Gathered and reduced data from device 1
2024/12/17 17:37:13 Gathered and reduced data from device 2
2024/12/17 17:37:13 Gathered and reduced data from device 3
2024/12/17 17:37:13 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:13 Broadcast complete to device 1
2024/12/17 17:37:13 Broadcast complete to device 2
2024/12/17 17:37:13 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 9.113417ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 32.957625ms
    gpu_test.go:1358: 
        Performance comparison for Small size (10000 elements, 0.08 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 5.292033ms
    gpu_test.go:1361: Ring AllReduce:  28.215316ms
    gpu_test.go:1362: Speedup: 0.19x
=== RUN   TestAllReducePerformance/Medium
    gpu_test.go:1267: Running Medium size iteration 1/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:13 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:13 Gathered and reduced data from device 1
2024/12/17 17:37:13 Gathered and reduced data from device 2
2024/12/17 17:37:13 Gathered and reduced data from device 3
2024/12/17 17:37:13 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:13 Broadcast complete to device 1
2024/12/17 17:37:13 Broadcast complete to device 2
2024/12/17 17:37:13 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 11.953625ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 52.03975ms
    gpu_test.go:1267: Running Medium size iteration 2/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:14 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:14 Gathered and reduced data from device 1
2024/12/17 17:37:14 Gathered and reduced data from device 2
2024/12/17 17:37:14 Gathered and reduced data from device 3
2024/12/17 17:37:14 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:14 Broadcast complete to device 1
2024/12/17 17:37:14 Broadcast complete to device 2
2024/12/17 17:37:14 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 19.992375ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 36.796584ms
    gpu_test.go:1267: Running Medium size iteration 3/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:14 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:14 Gathered and reduced data from device 1
2024/12/17 17:37:14 Gathered and reduced data from device 2
2024/12/17 17:37:14 Gathered and reduced data from device 3
2024/12/17 17:37:14 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:14 Broadcast complete to device 1
2024/12/17 17:37:14 Broadcast complete to device 2
2024/12/17 17:37:14 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 7.393916ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 26.321584ms
    gpu_test.go:1358: 
        Performance comparison for Medium size (50000 elements, 0.38 MB), averaged over 3 iterations:
    gpu_test.go:1360: Naive AllReduce: 13.113305ms
    gpu_test.go:1361: Ring AllReduce:  38.385972ms
    gpu_test.go:1362: Speedup: 0.34x
=== RUN   TestAllReducePerformance/Large
    gpu_test.go:1267: Running Large size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:37:14 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:37:14 Gathered and reduced data from device 1
2024/12/17 17:37:14 Gathered and reduced data from device 2
2024/12/17 17:37:14 Gathered and reduced data from device 3
2024/12/17 17:37:14 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:14 Broadcast complete to device 1
2024/12/17 17:37:14 Broadcast complete to device 2
2024/12/17 17:37:14 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 27.741375ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 57.684208ms
    gpu_test.go:1267: Running Large size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:37:14 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:37:14 Gathered and reduced data from device 1
2024/12/17 17:37:14 Gathered and reduced data from device 2
2024/12/17 17:37:14 Gathered and reduced data from device 3
2024/12/17 17:37:14 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:14 Broadcast complete to device 1
2024/12/17 17:37:14 Broadcast complete to device 2
2024/12/17 17:37:14 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 58.298251ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 40.560625ms
    gpu_test.go:1358: 
        Performance comparison for Large size (100000 elements, 0.76 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 43.019813ms
    gpu_test.go:1361: Ring AllReduce:  49.122416ms
    gpu_test.go:1362: Speedup: 0.88x
=== RUN   TestAllReducePerformance/XLarge
    gpu_test.go:1267: Running XLarge size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:37:14 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:37:14 Gathered and reduced data from device 1
2024/12/17 17:37:14 Gathered and reduced data from device 2
2024/12/17 17:37:14 Gathered and reduced data from device 3
2024/12/17 17:37:14 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:14 Broadcast complete to device 1
2024/12/17 17:37:14 Broadcast complete to device 2
2024/12/17 17:37:14 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 51.336084ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 65.153333ms
    gpu_test.go:1267: Running XLarge size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:37:15 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:37:15 Gathered and reduced data from device 1
2024/12/17 17:37:15 Gathered and reduced data from device 2
2024/12/17 17:37:15 Gathered and reduced data from device 3
2024/12/17 17:37:15 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:15 Broadcast complete to device 1
2024/12/17 17:37:15 Broadcast complete to device 2
2024/12/17 17:37:15 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 27.460291ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 47.994042ms
    gpu_test.go:1358: 
        Performance comparison for XLarge size (200000 elements, 1.53 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 39.398187ms
    gpu_test.go:1361: Ring AllReduce:  56.573687ms
    gpu_test.go:1362: Speedup: 0.70x
=== RUN   TestAllReducePerformance/XXLarge
    gpu_test.go:1267: Running XXLarge size iteration 1/1...
    gpu_test.go:1305: Starting Naive AllReduce for size XXLarge...
2024/12/17 17:37:15 Naive AllReduce: Gathering all data to device 0 (data size: 3200000 bytes)
2024/12/17 17:37:15 Gathered and reduced data from device 1
2024/12/17 17:37:15 Gathered and reduced data from device 2
2024/12/17 17:37:15 Gathered and reduced data from device 3
2024/12/17 17:37:15 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:15 Broadcast complete to device 1
2024/12/17 17:37:15 Broadcast complete to device 2
2024/12/17 17:37:15 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 107.173375ms
    gpu_test.go:1322: Starting Ring AllReduce for size XXLarge...
    gpu_test.go:1343: Ring completed in 96.050041ms
    gpu_test.go:1358: 
        Performance comparison for XXLarge size (400000 elements, 3.05 MB), averaged over 1 iterations:
    gpu_test.go:1360: Naive AllReduce: 107.173375ms
    gpu_test.go:1361: Ring AllReduce:  96.050041ms
    gpu_test.go:1362: Speedup: 1.12x
--- PASS: TestAllReducePerformance (3.55s)
    --- PASS: TestAllReducePerformance/Tiny (0.79s)
    --- PASS: TestAllReducePerformance/Small (0.79s)
    --- PASS: TestAllReducePerformance/Medium (0.54s)
    --- PASS: TestAllReducePerformance/Large (0.51s)
    --- PASS: TestAllReducePerformance/XLarge (0.48s)
    --- PASS: TestAllReducePerformance/XXLarge (0.44s)
PASS
ok  	dsml/pkg/tests	3.991s
=== RUN   TestInitCommunicator
--- PASS: TestInitCommunicator (0.01s)
=== RUN   TestMemcpyToGPUs
--- PASS: TestMemcpyToGPUs (0.01s)
=== RUN   TestGroupOperations
--- PASS: TestGroupOperations (0.02s)
=== RUN   TestAllReduce
--- PASS: TestAllReduce (0.13s)
=== RUN   TestStatusChecking
--- PASS: TestStatusChecking (0.01s)
=== RUN   TestMemcpyFromGPU
--- PASS: TestMemcpyFromGPU (0.02s)
=== RUN   TestCompleteWorkflow
--- PASS: TestCompleteWorkflow (0.14s)
=== RUN   TestNaiveAllReduce
    gpu_test.go:987: Initializing device 0 with value 1.000000
    gpu_test.go:987: Initializing device 1 with value 2.000000
    gpu_test.go:987: Initializing device 2 with value 3.000000
    gpu_test.go:987: Initializing device 3 with value 4.000000
2024/12/17 17:37:16 Naive AllReduce: Gathering all data to device 0 (data size: 64 bytes)
2024/12/17 17:37:16 Gathered and reduced data from device 1
2024/12/17 17:37:16 Gathered and reduced data from device 2
2024/12/17 17:37:16 Gathered and reduced data from device 3
2024/12/17 17:37:16 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:16 Broadcast complete to device 1
2024/12/17 17:37:16 Broadcast complete to device 2
2024/12/17 17:37:16 Broadcast complete to device 3
    gpu_test.go:1048: Device 0 results verified
    gpu_test.go:1048: Device 1 results verified
    gpu_test.go:1048: Device 2 results verified
    gpu_test.go:1048: Device 3 results verified
--- PASS: TestNaiveAllReduce (0.01s)
=== RUN   TestAllReducePerformance
=== RUN   TestAllReducePerformance/Tiny
    gpu_test.go:1267: Running Tiny size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:16 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:16 Gathered and reduced data from device 1
2024/12/17 17:37:16 Gathered and reduced data from device 2
2024/12/17 17:37:16 Gathered and reduced data from device 3
2024/12/17 17:37:16 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:16 Broadcast complete to device 1
2024/12/17 17:37:16 Broadcast complete to device 2
2024/12/17 17:37:16 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 7.263833ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 25.738625ms
    gpu_test.go:1267: Running Tiny size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:16 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:16 Gathered and reduced data from device 1
2024/12/17 17:37:16 Gathered and reduced data from device 2
2024/12/17 17:37:16 Gathered and reduced data from device 3
2024/12/17 17:37:16 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:16 Broadcast complete to device 1
2024/12/17 17:37:16 Broadcast complete to device 2
2024/12/17 17:37:16 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.166333ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 24.391917ms
    gpu_test.go:1267: Running Tiny size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:17 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:17 Gathered and reduced data from device 1
2024/12/17 17:37:17 Gathered and reduced data from device 2
2024/12/17 17:37:17 Gathered and reduced data from device 3
2024/12/17 17:37:17 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:17 Broadcast complete to device 1
2024/12/17 17:37:17 Broadcast complete to device 2
2024/12/17 17:37:17 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.644375ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 26.722208ms
    gpu_test.go:1267: Running Tiny size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:17 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:17 Gathered and reduced data from device 1
2024/12/17 17:37:17 Gathered and reduced data from device 2
2024/12/17 17:37:17 Gathered and reduced data from device 3
2024/12/17 17:37:17 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:17 Broadcast complete to device 1
2024/12/17 17:37:17 Broadcast complete to device 2
2024/12/17 17:37:17 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.341917ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 29.289917ms
    gpu_test.go:1267: Running Tiny size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:17 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:17 Gathered and reduced data from device 1
2024/12/17 17:37:17 Gathered and reduced data from device 2
2024/12/17 17:37:17 Gathered and reduced data from device 3
2024/12/17 17:37:17 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:17 Broadcast complete to device 1
2024/12/17 17:37:17 Broadcast complete to device 2
2024/12/17 17:37:17 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.313875ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 25.452125ms
    gpu_test.go:1358: 
        Performance comparison for Tiny size (1000 elements, 0.01 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 3.546066ms
    gpu_test.go:1361: Ring AllReduce:  26.318958ms
    gpu_test.go:1362: Speedup: 0.13x
=== RUN   TestAllReducePerformance/Small
    gpu_test.go:1267: Running Small size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:17 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:17 Gathered and reduced data from device 1
2024/12/17 17:37:17 Gathered and reduced data from device 2
2024/12/17 17:37:17 Gathered and reduced data from device 3
2024/12/17 17:37:17 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:17 Broadcast complete to device 1
2024/12/17 17:37:17 Broadcast complete to device 2
2024/12/17 17:37:17 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.629ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 26.153083ms
    gpu_test.go:1267: Running Small size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:17 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:17 Gathered and reduced data from device 1
2024/12/17 17:37:17 Gathered and reduced data from device 2
2024/12/17 17:37:17 Gathered and reduced data from device 3
2024/12/17 17:37:17 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:17 Broadcast complete to device 1
2024/12/17 17:37:17 Broadcast complete to device 2
2024/12/17 17:37:17 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 8.909959ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 34.142375ms
    gpu_test.go:1267: Running Small size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:17 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:17 Gathered and reduced data from device 1
2024/12/17 17:37:17 Gathered and reduced data from device 2
2024/12/17 17:37:17 Gathered and reduced data from device 3
2024/12/17 17:37:17 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:17 Broadcast complete to device 1
2024/12/17 17:37:17 Broadcast complete to device 2
2024/12/17 17:37:17 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.118333ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 22.715125ms
    gpu_test.go:1267: Running Small size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:18 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:18 Gathered and reduced data from device 1
2024/12/17 17:37:18 Gathered and reduced data from device 2
2024/12/17 17:37:18 Gathered and reduced data from device 3
2024/12/17 17:37:18 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:18 Broadcast complete to device 1
2024/12/17 17:37:18 Broadcast complete to device 2
2024/12/17 17:37:18 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.51025ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 30.523792ms
    gpu_test.go:1267: Running Small size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:18 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:18 Gathered and reduced data from device 1
2024/12/17 17:37:18 Gathered and reduced data from device 2
2024/12/17 17:37:18 Gathered and reduced data from device 3
2024/12/17 17:37:18 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:18 Broadcast complete to device 1
2024/12/17 17:37:18 Broadcast complete to device 2
2024/12/17 17:37:18 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.813292ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 21.902459ms
    gpu_test.go:1358: 
        Performance comparison for Small size (10000 elements, 0.08 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 5.196166ms
    gpu_test.go:1361: Ring AllReduce:  27.087366ms
    gpu_test.go:1362: Speedup: 0.19x
=== RUN   TestAllReducePerformance/Medium
    gpu_test.go:1267: Running Medium size iteration 1/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:18 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:18 Gathered and reduced data from device 1
2024/12/17 17:37:18 Gathered and reduced data from device 2
2024/12/17 17:37:18 Gathered and reduced data from device 3
2024/12/17 17:37:18 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:18 Broadcast complete to device 1
2024/12/17 17:37:18 Broadcast complete to device 2
2024/12/17 17:37:18 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 26.738667ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 26.622125ms
    gpu_test.go:1267: Running Medium size iteration 2/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:18 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:18 Gathered and reduced data from device 1
2024/12/17 17:37:18 Gathered and reduced data from device 2
2024/12/17 17:37:18 Gathered and reduced data from device 3
2024/12/17 17:37:18 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:18 Broadcast complete to device 1
2024/12/17 17:37:18 Broadcast complete to device 2
2024/12/17 17:37:18 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 14.875ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 55.719959ms
    gpu_test.go:1267: Running Medium size iteration 3/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:18 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:18 Gathered and reduced data from device 1
2024/12/17 17:37:18 Gathered and reduced data from device 2
2024/12/17 17:37:18 Gathered and reduced data from device 3
2024/12/17 17:37:18 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:18 Broadcast complete to device 1
2024/12/17 17:37:18 Broadcast complete to device 2
2024/12/17 17:37:18 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 13.536416ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 44.338334ms
    gpu_test.go:1358: 
        Performance comparison for Medium size (50000 elements, 0.38 MB), averaged over 3 iterations:
    gpu_test.go:1360: Naive AllReduce: 18.383361ms
    gpu_test.go:1361: Ring AllReduce:  42.226806ms
    gpu_test.go:1362: Speedup: 0.44x
=== RUN   TestAllReducePerformance/Large
    gpu_test.go:1267: Running Large size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:37:19 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:37:19 Gathered and reduced data from device 1
2024/12/17 17:37:19 Gathered and reduced data from device 2
2024/12/17 17:37:19 Gathered and reduced data from device 3
2024/12/17 17:37:19 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:19 Broadcast complete to device 1
2024/12/17 17:37:19 Broadcast complete to device 2
2024/12/17 17:37:19 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 45.441791ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 51.09625ms
    gpu_test.go:1267: Running Large size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:37:19 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:37:19 Gathered and reduced data from device 1
2024/12/17 17:37:19 Gathered and reduced data from device 2
2024/12/17 17:37:19 Gathered and reduced data from device 3
2024/12/17 17:37:19 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:19 Broadcast complete to device 1
2024/12/17 17:37:19 Broadcast complete to device 2
2024/12/17 17:37:19 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 31.285583ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 41.494834ms
    gpu_test.go:1358: 
        Performance comparison for Large size (100000 elements, 0.76 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 38.363687ms
    gpu_test.go:1361: Ring AllReduce:  46.295542ms
    gpu_test.go:1362: Speedup: 0.83x
=== RUN   TestAllReducePerformance/XLarge
    gpu_test.go:1267: Running XLarge size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:37:19 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:37:19 Gathered and reduced data from device 1
2024/12/17 17:37:19 Gathered and reduced data from device 2
2024/12/17 17:37:19 Gathered and reduced data from device 3
2024/12/17 17:37:19 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:19 Broadcast complete to device 1
2024/12/17 17:37:19 Broadcast complete to device 2
2024/12/17 17:37:19 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 28.051042ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 49.984166ms
    gpu_test.go:1267: Running XLarge size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:37:19 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:37:19 Gathered and reduced data from device 1
2024/12/17 17:37:19 Gathered and reduced data from device 2
2024/12/17 17:37:19 Gathered and reduced data from device 3
2024/12/17 17:37:19 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:19 Broadcast complete to device 1
2024/12/17 17:37:19 Broadcast complete to device 2
2024/12/17 17:37:19 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 53.341791ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 47.1805ms
    gpu_test.go:1358: 
        Performance comparison for XLarge size (200000 elements, 1.53 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 40.696416ms
    gpu_test.go:1361: Ring AllReduce:  48.582333ms
    gpu_test.go:1362: Speedup: 0.84x
=== RUN   TestAllReducePerformance/XXLarge
    gpu_test.go:1267: Running XXLarge size iteration 1/1...
    gpu_test.go:1305: Starting Naive AllReduce for size XXLarge...
2024/12/17 17:37:19 Naive AllReduce: Gathering all data to device 0 (data size: 3200000 bytes)
2024/12/17 17:37:19 Gathered and reduced data from device 1
2024/12/17 17:37:19 Gathered and reduced data from device 2
2024/12/17 17:37:19 Gathered and reduced data from device 3
2024/12/17 17:37:19 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:19 Broadcast complete to device 1
2024/12/17 17:37:19 Broadcast complete to device 2
2024/12/17 17:37:19 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 54.296917ms
    gpu_test.go:1322: Starting Ring AllReduce for size XXLarge...
    gpu_test.go:1343: Ring completed in 70.516084ms
    gpu_test.go:1358: 
        Performance comparison for XXLarge size (400000 elements, 3.05 MB), averaged over 1 iterations:
    gpu_test.go:1360: Naive AllReduce: 54.296917ms
    gpu_test.go:1361: Ring AllReduce:  70.516084ms
    gpu_test.go:1362: Speedup: 0.77x
--- PASS: TestAllReducePerformance (3.37s)
    --- PASS: TestAllReducePerformance/Tiny (0.75s)
    --- PASS: TestAllReducePerformance/Small (0.77s)
    --- PASS: TestAllReducePerformance/Medium (0.63s)
    --- PASS: TestAllReducePerformance/Large (0.47s)
    --- PASS: TestAllReducePerformance/XLarge (0.48s)
    --- PASS: TestAllReducePerformance/XXLarge (0.27s)
PASS
ok  	dsml/pkg/tests	3.785s
=== RUN   TestInitCommunicator
--- PASS: TestInitCommunicator (0.01s)
=== RUN   TestMemcpyToGPUs
--- PASS: TestMemcpyToGPUs (0.02s)
=== RUN   TestGroupOperations
--- PASS: TestGroupOperations (0.00s)
=== RUN   TestAllReduce
--- PASS: TestAllReduce (0.14s)
=== RUN   TestStatusChecking
--- PASS: TestStatusChecking (0.02s)
=== RUN   TestMemcpyFromGPU
--- PASS: TestMemcpyFromGPU (0.00s)
=== RUN   TestCompleteWorkflow
--- PASS: TestCompleteWorkflow (0.13s)
=== RUN   TestNaiveAllReduce
    gpu_test.go:987: Initializing device 0 with value 1.000000
    gpu_test.go:987: Initializing device 1 with value 2.000000
    gpu_test.go:987: Initializing device 2 with value 3.000000
    gpu_test.go:987: Initializing device 3 with value 4.000000
2024/12/17 17:37:21 Naive AllReduce: Gathering all data to device 0 (data size: 64 bytes)
2024/12/17 17:37:21 Gathered and reduced data from device 1
2024/12/17 17:37:21 Gathered and reduced data from device 2
2024/12/17 17:37:21 Gathered and reduced data from device 3
2024/12/17 17:37:21 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:21 Broadcast complete to device 1
2024/12/17 17:37:21 Broadcast complete to device 2
2024/12/17 17:37:21 Broadcast complete to device 3
    gpu_test.go:1048: Device 0 results verified
    gpu_test.go:1048: Device 1 results verified
    gpu_test.go:1048: Device 2 results verified
    gpu_test.go:1048: Device 3 results verified
--- PASS: TestNaiveAllReduce (0.02s)
=== RUN   TestAllReducePerformance
=== RUN   TestAllReducePerformance/Tiny
    gpu_test.go:1267: Running Tiny size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:21 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:21 Gathered and reduced data from device 1
2024/12/17 17:37:21 Gathered and reduced data from device 2
2024/12/17 17:37:21 Gathered and reduced data from device 3
2024/12/17 17:37:21 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:21 Broadcast complete to device 1
2024/12/17 17:37:21 Broadcast complete to device 2
2024/12/17 17:37:21 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 1.904541ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 27.066917ms
    gpu_test.go:1267: Running Tiny size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:21 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:21 Gathered and reduced data from device 1
2024/12/17 17:37:21 Gathered and reduced data from device 2
2024/12/17 17:37:21 Gathered and reduced data from device 3
2024/12/17 17:37:21 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:21 Broadcast complete to device 1
2024/12/17 17:37:21 Broadcast complete to device 2
2024/12/17 17:37:21 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.256334ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 21.411792ms
    gpu_test.go:1267: Running Tiny size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:21 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:21 Gathered and reduced data from device 1
2024/12/17 17:37:21 Gathered and reduced data from device 2
2024/12/17 17:37:21 Gathered and reduced data from device 3
2024/12/17 17:37:21 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:21 Broadcast complete to device 1
2024/12/17 17:37:21 Broadcast complete to device 2
2024/12/17 17:37:21 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.850125ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 27.409875ms
    gpu_test.go:1267: Running Tiny size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:21 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:21 Gathered and reduced data from device 1
2024/12/17 17:37:21 Gathered and reduced data from device 2
2024/12/17 17:37:21 Gathered and reduced data from device 3
2024/12/17 17:37:21 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:21 Broadcast complete to device 1
2024/12/17 17:37:21 Broadcast complete to device 2
2024/12/17 17:37:21 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.611541ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 84.753958ms
    gpu_test.go:1267: Running Tiny size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:21 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:21 Gathered and reduced data from device 1
2024/12/17 17:37:21 Gathered and reduced data from device 2
2024/12/17 17:37:21 Gathered and reduced data from device 3
2024/12/17 17:37:21 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:21 Broadcast complete to device 1
2024/12/17 17:37:21 Broadcast complete to device 2
2024/12/17 17:37:21 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.000291ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 26.166084ms
    gpu_test.go:1358: 
        Performance comparison for Tiny size (1000 elements, 0.01 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 3.524566ms
    gpu_test.go:1361: Ring AllReduce:  37.361725ms
    gpu_test.go:1362: Speedup: 0.09x
=== RUN   TestAllReducePerformance/Small
    gpu_test.go:1267: Running Small size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:21 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:21 Gathered and reduced data from device 1
2024/12/17 17:37:21 Gathered and reduced data from device 2
2024/12/17 17:37:21 Gathered and reduced data from device 3
2024/12/17 17:37:21 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:21 Broadcast complete to device 1
2024/12/17 17:37:21 Broadcast complete to device 2
2024/12/17 17:37:21 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.504042ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 26.351333ms
    gpu_test.go:1267: Running Small size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:22 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:22 Gathered and reduced data from device 1
2024/12/17 17:37:22 Gathered and reduced data from device 2
2024/12/17 17:37:22 Gathered and reduced data from device 3
2024/12/17 17:37:22 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:22 Broadcast complete to device 1
2024/12/17 17:37:22 Broadcast complete to device 2
2024/12/17 17:37:22 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.361709ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 25.151333ms
    gpu_test.go:1267: Running Small size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:22 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:22 Gathered and reduced data from device 1
2024/12/17 17:37:22 Gathered and reduced data from device 2
2024/12/17 17:37:22 Gathered and reduced data from device 3
2024/12/17 17:37:22 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:22 Broadcast complete to device 1
2024/12/17 17:37:22 Broadcast complete to device 2
2024/12/17 17:37:22 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.470667ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 24.852375ms
    gpu_test.go:1267: Running Small size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:22 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:22 Gathered and reduced data from device 1
2024/12/17 17:37:22 Gathered and reduced data from device 2
2024/12/17 17:37:22 Gathered and reduced data from device 3
2024/12/17 17:37:22 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:22 Broadcast complete to device 1
2024/12/17 17:37:22 Broadcast complete to device 2
2024/12/17 17:37:22 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 6.48575ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 26.845167ms
    gpu_test.go:1267: Running Small size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:22 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:22 Gathered and reduced data from device 1
2024/12/17 17:37:22 Gathered and reduced data from device 2
2024/12/17 17:37:22 Gathered and reduced data from device 3
2024/12/17 17:37:22 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:22 Broadcast complete to device 1
2024/12/17 17:37:22 Broadcast complete to device 2
2024/12/17 17:37:22 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 6.778958ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 31.369041ms
    gpu_test.go:1358: 
        Performance comparison for Small size (10000 elements, 0.08 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 5.320225ms
    gpu_test.go:1361: Ring AllReduce:  26.913849ms
    gpu_test.go:1362: Speedup: 0.20x
=== RUN   TestAllReducePerformance/Medium
    gpu_test.go:1267: Running Medium size iteration 1/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:22 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:22 Gathered and reduced data from device 1
2024/12/17 17:37:22 Gathered and reduced data from device 2
2024/12/17 17:37:22 Gathered and reduced data from device 3
2024/12/17 17:37:22 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:22 Broadcast complete to device 1
2024/12/17 17:37:22 Broadcast complete to device 2
2024/12/17 17:37:22 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 31.882375ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 37.878791ms
    gpu_test.go:1267: Running Medium size iteration 2/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:22 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:22 Gathered and reduced data from device 1
2024/12/17 17:37:22 Gathered and reduced data from device 2
2024/12/17 17:37:22 Gathered and reduced data from device 3
2024/12/17 17:37:22 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:22 Broadcast complete to device 1
2024/12/17 17:37:22 Broadcast complete to device 2
2024/12/17 17:37:22 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 14.108083ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 52.980791ms
    gpu_test.go:1267: Running Medium size iteration 3/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:23 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:23 Gathered and reduced data from device 1
2024/12/17 17:37:23 Gathered and reduced data from device 2
2024/12/17 17:37:23 Gathered and reduced data from device 3
2024/12/17 17:37:23 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:23 Broadcast complete to device 1
2024/12/17 17:37:23 Broadcast complete to device 2
2024/12/17 17:37:23 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.311875ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 24.960667ms
    gpu_test.go:1358: 
        Performance comparison for Medium size (50000 elements, 0.38 MB), averaged over 3 iterations:
    gpu_test.go:1360: Naive AllReduce: 17.100777ms
    gpu_test.go:1361: Ring AllReduce:  38.606749ms
    gpu_test.go:1362: Speedup: 0.44x
=== RUN   TestAllReducePerformance/Large
    gpu_test.go:1267: Running Large size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:37:23 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:37:23 Gathered and reduced data from device 1
2024/12/17 17:37:23 Gathered and reduced data from device 2
2024/12/17 17:37:23 Gathered and reduced data from device 3
2024/12/17 17:37:23 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:23 Broadcast complete to device 1
2024/12/17 17:37:23 Broadcast complete to device 2
2024/12/17 17:37:23 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 21.640458ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 56.234708ms
    gpu_test.go:1267: Running Large size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:37:23 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:37:23 Gathered and reduced data from device 1
2024/12/17 17:37:23 Gathered and reduced data from device 2
2024/12/17 17:37:23 Gathered and reduced data from device 3
2024/12/17 17:37:23 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:23 Broadcast complete to device 1
2024/12/17 17:37:23 Broadcast complete to device 2
2024/12/17 17:37:23 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 15.999208ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 33.679458ms
    gpu_test.go:1358: 
        Performance comparison for Large size (100000 elements, 0.76 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 18.819833ms
    gpu_test.go:1361: Ring AllReduce:  44.957083ms
    gpu_test.go:1362: Speedup: 0.42x
=== RUN   TestAllReducePerformance/XLarge
    gpu_test.go:1267: Running XLarge size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:37:23 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:37:23 Gathered and reduced data from device 1
2024/12/17 17:37:23 Gathered and reduced data from device 2
2024/12/17 17:37:23 Gathered and reduced data from device 3
2024/12/17 17:37:23 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:23 Broadcast complete to device 1
2024/12/17 17:37:23 Broadcast complete to device 2
2024/12/17 17:37:23 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 33.987625ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 29.826125ms
    gpu_test.go:1267: Running XLarge size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:37:23 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:37:23 Gathered and reduced data from device 1
2024/12/17 17:37:23 Gathered and reduced data from device 2
2024/12/17 17:37:23 Gathered and reduced data from device 3
2024/12/17 17:37:23 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:23 Broadcast complete to device 1
2024/12/17 17:37:23 Broadcast complete to device 2
2024/12/17 17:37:23 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 17.737875ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 59.488292ms
    gpu_test.go:1358: 
        Performance comparison for XLarge size (200000 elements, 1.53 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 25.86275ms
    gpu_test.go:1361: Ring AllReduce:  44.657208ms
    gpu_test.go:1362: Speedup: 0.58x
=== RUN   TestAllReducePerformance/XXLarge
    gpu_test.go:1267: Running XXLarge size iteration 1/1...
    gpu_test.go:1305: Starting Naive AllReduce for size XXLarge...
2024/12/17 17:37:24 Naive AllReduce: Gathering all data to device 0 (data size: 3200000 bytes)
2024/12/17 17:37:24 Gathered and reduced data from device 1
2024/12/17 17:37:24 Gathered and reduced data from device 2
2024/12/17 17:37:24 Gathered and reduced data from device 3
2024/12/17 17:37:24 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:24 Broadcast complete to device 1
2024/12/17 17:37:24 Broadcast complete to device 2
2024/12/17 17:37:24 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 92.126667ms
    gpu_test.go:1322: Starting Ring AllReduce for size XXLarge...
    gpu_test.go:1343: Ring completed in 85.223875ms
    gpu_test.go:1358: 
        Performance comparison for XXLarge size (400000 elements, 3.05 MB), averaged over 1 iterations:
    gpu_test.go:1360: Naive AllReduce: 92.126667ms
    gpu_test.go:1361: Ring AllReduce:  85.223875ms
    gpu_test.go:1362: Speedup: 1.08x
--- PASS: TestAllReducePerformance (3.44s)
    --- PASS: TestAllReducePerformance/Tiny (0.83s)
    --- PASS: TestAllReducePerformance/Small (0.76s)
    --- PASS: TestAllReducePerformance/Medium (0.56s)
    --- PASS: TestAllReducePerformance/Large (0.46s)
    --- PASS: TestAllReducePerformance/XLarge (0.41s)
    --- PASS: TestAllReducePerformance/XXLarge (0.41s)
PASS
ok  	dsml/pkg/tests	3.858s
=== RUN   TestInitCommunicator
--- PASS: TestInitCommunicator (0.01s)
=== RUN   TestMemcpyToGPUs
--- PASS: TestMemcpyToGPUs (0.01s)
=== RUN   TestGroupOperations
--- PASS: TestGroupOperations (0.00s)
=== RUN   TestAllReduce
--- PASS: TestAllReduce (0.14s)
=== RUN   TestStatusChecking
--- PASS: TestStatusChecking (0.02s)
=== RUN   TestMemcpyFromGPU
--- PASS: TestMemcpyFromGPU (0.02s)
=== RUN   TestCompleteWorkflow
--- PASS: TestCompleteWorkflow (0.16s)
=== RUN   TestNaiveAllReduce
    gpu_test.go:987: Initializing device 0 with value 1.000000
    gpu_test.go:987: Initializing device 1 with value 2.000000
    gpu_test.go:987: Initializing device 2 with value 3.000000
    gpu_test.go:987: Initializing device 3 with value 4.000000
2024/12/17 17:37:25 Naive AllReduce: Gathering all data to device 0 (data size: 64 bytes)
2024/12/17 17:37:25 Gathered and reduced data from device 1
2024/12/17 17:37:25 Gathered and reduced data from device 2
2024/12/17 17:37:25 Gathered and reduced data from device 3
2024/12/17 17:37:25 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:25 Broadcast complete to device 1
2024/12/17 17:37:25 Broadcast complete to device 2
2024/12/17 17:37:25 Broadcast complete to device 3
    gpu_test.go:1048: Device 0 results verified
    gpu_test.go:1048: Device 1 results verified
    gpu_test.go:1048: Device 2 results verified
    gpu_test.go:1048: Device 3 results verified
--- PASS: TestNaiveAllReduce (0.02s)
=== RUN   TestAllReducePerformance
=== RUN   TestAllReducePerformance/Tiny
    gpu_test.go:1267: Running Tiny size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:25 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:25 Gathered and reduced data from device 1
2024/12/17 17:37:25 Gathered and reduced data from device 2
2024/12/17 17:37:25 Gathered and reduced data from device 3
2024/12/17 17:37:25 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:25 Broadcast complete to device 1
2024/12/17 17:37:25 Broadcast complete to device 2
2024/12/17 17:37:25 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.284375ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 25.471667ms
    gpu_test.go:1267: Running Tiny size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:25 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:25 Gathered and reduced data from device 1
2024/12/17 17:37:25 Gathered and reduced data from device 2
2024/12/17 17:37:25 Gathered and reduced data from device 3
2024/12/17 17:37:25 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:25 Broadcast complete to device 1
2024/12/17 17:37:25 Broadcast complete to device 2
2024/12/17 17:37:25 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.748709ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 27.156833ms
    gpu_test.go:1267: Running Tiny size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:25 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:25 Gathered and reduced data from device 1
2024/12/17 17:37:25 Gathered and reduced data from device 2
2024/12/17 17:37:25 Gathered and reduced data from device 3
2024/12/17 17:37:25 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:25 Broadcast complete to device 1
2024/12/17 17:37:25 Broadcast complete to device 2
2024/12/17 17:37:25 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.360667ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 53.256251ms
    gpu_test.go:1267: Running Tiny size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:25 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:25 Gathered and reduced data from device 1
2024/12/17 17:37:25 Gathered and reduced data from device 2
2024/12/17 17:37:25 Gathered and reduced data from device 3
2024/12/17 17:37:25 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:25 Broadcast complete to device 1
2024/12/17 17:37:25 Broadcast complete to device 2
2024/12/17 17:37:25 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.462209ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 25.244917ms
    gpu_test.go:1267: Running Tiny size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:26 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:26 Gathered and reduced data from device 1
2024/12/17 17:37:26 Gathered and reduced data from device 2
2024/12/17 17:37:26 Gathered and reduced data from device 3
2024/12/17 17:37:26 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:26 Broadcast complete to device 1
2024/12/17 17:37:26 Broadcast complete to device 2
2024/12/17 17:37:26 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 11.674833ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 28.570167ms
    gpu_test.go:1358: 
        Performance comparison for Tiny size (1000 elements, 0.01 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 5.306158ms
    gpu_test.go:1361: Ring AllReduce:  31.939967ms
    gpu_test.go:1362: Speedup: 0.17x
=== RUN   TestAllReducePerformance/Small
    gpu_test.go:1267: Running Small size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:26 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:26 Gathered and reduced data from device 1
2024/12/17 17:37:26 Gathered and reduced data from device 2
2024/12/17 17:37:26 Gathered and reduced data from device 3
2024/12/17 17:37:26 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:26 Broadcast complete to device 1
2024/12/17 17:37:26 Broadcast complete to device 2
2024/12/17 17:37:26 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.737708ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 35.363417ms
    gpu_test.go:1267: Running Small size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:26 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:26 Gathered and reduced data from device 1
2024/12/17 17:37:26 Gathered and reduced data from device 2
2024/12/17 17:37:26 Gathered and reduced data from device 3
2024/12/17 17:37:26 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:26 Broadcast complete to device 1
2024/12/17 17:37:26 Broadcast complete to device 2
2024/12/17 17:37:26 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.130709ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 25.700125ms
    gpu_test.go:1267: Running Small size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:26 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:26 Gathered and reduced data from device 1
2024/12/17 17:37:26 Gathered and reduced data from device 2
2024/12/17 17:37:26 Gathered and reduced data from device 3
2024/12/17 17:37:26 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:26 Broadcast complete to device 1
2024/12/17 17:37:26 Broadcast complete to device 2
2024/12/17 17:37:26 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 32.353833ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 37.4325ms
    gpu_test.go:1267: Running Small size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:26 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:26 Gathered and reduced data from device 1
2024/12/17 17:37:26 Gathered and reduced data from device 2
2024/12/17 17:37:26 Gathered and reduced data from device 3
2024/12/17 17:37:26 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:26 Broadcast complete to device 1
2024/12/17 17:37:26 Broadcast complete to device 2
2024/12/17 17:37:26 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.962375ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 24.780208ms
    gpu_test.go:1267: Running Small size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:26 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:26 Gathered and reduced data from device 1
2024/12/17 17:37:26 Gathered and reduced data from device 2
2024/12/17 17:37:26 Gathered and reduced data from device 3
2024/12/17 17:37:26 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:26 Broadcast complete to device 1
2024/12/17 17:37:26 Broadcast complete to device 2
2024/12/17 17:37:26 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.448333ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 31.772875ms
    gpu_test.go:1358: 
        Performance comparison for Small size (10000 elements, 0.08 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 9.726591ms
    gpu_test.go:1361: Ring AllReduce:  31.009825ms
    gpu_test.go:1362: Speedup: 0.31x
=== RUN   TestAllReducePerformance/Medium
    gpu_test.go:1267: Running Medium size iteration 1/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:27 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:27 Gathered and reduced data from device 1
2024/12/17 17:37:27 Gathered and reduced data from device 2
2024/12/17 17:37:27 Gathered and reduced data from device 3
2024/12/17 17:37:27 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:27 Broadcast complete to device 1
2024/12/17 17:37:27 Broadcast complete to device 2
2024/12/17 17:37:27 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 13.783125ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 41.251792ms
    gpu_test.go:1267: Running Medium size iteration 2/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:27 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:27 Gathered and reduced data from device 1
2024/12/17 17:37:27 Gathered and reduced data from device 2
2024/12/17 17:37:27 Gathered and reduced data from device 3
2024/12/17 17:37:27 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:27 Broadcast complete to device 1
2024/12/17 17:37:27 Broadcast complete to device 2
2024/12/17 17:37:27 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 29.69475ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 77.772916ms
    gpu_test.go:1267: Running Medium size iteration 3/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:27 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:27 Gathered and reduced data from device 1
2024/12/17 17:37:27 Gathered and reduced data from device 2
2024/12/17 17:37:27 Gathered and reduced data from device 3
2024/12/17 17:37:27 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:27 Broadcast complete to device 1
2024/12/17 17:37:27 Broadcast complete to device 2
2024/12/17 17:37:27 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.039709ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 40.005583ms
    gpu_test.go:1358: 
        Performance comparison for Medium size (50000 elements, 0.38 MB), averaged over 3 iterations:
    gpu_test.go:1360: Naive AllReduce: 16.172528ms
    gpu_test.go:1361: Ring AllReduce:  53.010097ms
    gpu_test.go:1362: Speedup: 0.31x
=== RUN   TestAllReducePerformance/Large
    gpu_test.go:1267: Running Large size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:37:27 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:37:27 Gathered and reduced data from device 1
2024/12/17 17:37:27 Gathered and reduced data from device 2
2024/12/17 17:37:27 Gathered and reduced data from device 3
2024/12/17 17:37:27 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:27 Broadcast complete to device 1
2024/12/17 17:37:27 Broadcast complete to device 2
2024/12/17 17:37:27 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 17.562042ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 61.630375ms
    gpu_test.go:1267: Running Large size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:37:27 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:37:28 Gathered and reduced data from device 1
2024/12/17 17:37:28 Gathered and reduced data from device 2
2024/12/17 17:37:28 Gathered and reduced data from device 3
2024/12/17 17:37:28 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:28 Broadcast complete to device 1
2024/12/17 17:37:28 Broadcast complete to device 2
2024/12/17 17:37:28 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 35.655708ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 39.949833ms
    gpu_test.go:1358: 
        Performance comparison for Large size (100000 elements, 0.76 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 26.608875ms
    gpu_test.go:1361: Ring AllReduce:  50.790104ms
    gpu_test.go:1362: Speedup: 0.52x
=== RUN   TestAllReducePerformance/XLarge
    gpu_test.go:1267: Running XLarge size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:37:28 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:37:28 Gathered and reduced data from device 1
2024/12/17 17:37:28 Gathered and reduced data from device 2
2024/12/17 17:37:28 Gathered and reduced data from device 3
2024/12/17 17:37:28 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:28 Broadcast complete to device 1
2024/12/17 17:37:28 Broadcast complete to device 2
2024/12/17 17:37:28 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 56.517292ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 70.125583ms
    gpu_test.go:1267: Running XLarge size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:37:28 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:37:28 Gathered and reduced data from device 1
2024/12/17 17:37:28 Gathered and reduced data from device 2
2024/12/17 17:37:28 Gathered and reduced data from device 3
2024/12/17 17:37:28 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:28 Broadcast complete to device 1
2024/12/17 17:37:28 Broadcast complete to device 2
2024/12/17 17:37:28 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 18.10375ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 64.488167ms
    gpu_test.go:1358: 
        Performance comparison for XLarge size (200000 elements, 1.53 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 37.310521ms
    gpu_test.go:1361: Ring AllReduce:  67.306875ms
    gpu_test.go:1362: Speedup: 0.55x
=== RUN   TestAllReducePerformance/XXLarge
    gpu_test.go:1267: Running XXLarge size iteration 1/1...
    gpu_test.go:1305: Starting Naive AllReduce for size XXLarge...
2024/12/17 17:37:28 Naive AllReduce: Gathering all data to device 0 (data size: 3200000 bytes)
2024/12/17 17:37:28 Gathered and reduced data from device 1
2024/12/17 17:37:28 Gathered and reduced data from device 2
2024/12/17 17:37:28 Gathered and reduced data from device 3
2024/12/17 17:37:28 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:28 Broadcast complete to device 1
2024/12/17 17:37:28 Broadcast complete to device 2
2024/12/17 17:37:28 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 133.475833ms
    gpu_test.go:1322: Starting Ring AllReduce for size XXLarge...
    gpu_test.go:1343: Ring completed in 131.029333ms
    gpu_test.go:1358: 
        Performance comparison for XXLarge size (400000 elements, 3.05 MB), averaged over 1 iterations:
    gpu_test.go:1360: Naive AllReduce: 133.475833ms
    gpu_test.go:1361: Ring AllReduce:  131.029333ms
    gpu_test.go:1362: Speedup: 1.02x
--- PASS: TestAllReducePerformance (3.71s)
    --- PASS: TestAllReducePerformance/Tiny (0.82s)
    --- PASS: TestAllReducePerformance/Small (0.79s)
    --- PASS: TestAllReducePerformance/Medium (0.62s)
    --- PASS: TestAllReducePerformance/Large (0.49s)
    --- PASS: TestAllReducePerformance/XLarge (0.48s)
    --- PASS: TestAllReducePerformance/XXLarge (0.51s)
PASS
ok  	dsml/pkg/tests	4.177s
=== RUN   TestInitCommunicator
--- PASS: TestInitCommunicator (0.01s)
=== RUN   TestMemcpyToGPUs
--- PASS: TestMemcpyToGPUs (0.00s)
=== RUN   TestGroupOperations
--- PASS: TestGroupOperations (0.01s)
=== RUN   TestAllReduce
--- PASS: TestAllReduce (0.14s)
=== RUN   TestStatusChecking
--- PASS: TestStatusChecking (0.02s)
=== RUN   TestMemcpyFromGPU
--- PASS: TestMemcpyFromGPU (0.02s)
=== RUN   TestCompleteWorkflow
--- PASS: TestCompleteWorkflow (0.13s)
=== RUN   TestNaiveAllReduce
    gpu_test.go:987: Initializing device 0 with value 1.000000
    gpu_test.go:987: Initializing device 1 with value 2.000000
    gpu_test.go:987: Initializing device 2 with value 3.000000
    gpu_test.go:987: Initializing device 3 with value 4.000000
2024/12/17 17:37:30 Naive AllReduce: Gathering all data to device 0 (data size: 64 bytes)
2024/12/17 17:37:30 Gathered and reduced data from device 1
2024/12/17 17:37:30 Gathered and reduced data from device 2
2024/12/17 17:37:30 Gathered and reduced data from device 3
2024/12/17 17:37:30 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:30 Broadcast complete to device 1
2024/12/17 17:37:30 Broadcast complete to device 2
2024/12/17 17:37:30 Broadcast complete to device 3
    gpu_test.go:1048: Device 0 results verified
    gpu_test.go:1048: Device 1 results verified
    gpu_test.go:1048: Device 2 results verified
    gpu_test.go:1048: Device 3 results verified
--- PASS: TestNaiveAllReduce (0.02s)
=== RUN   TestAllReducePerformance
=== RUN   TestAllReducePerformance/Tiny
    gpu_test.go:1267: Running Tiny size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:30 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:30 Gathered and reduced data from device 1
2024/12/17 17:37:30 Gathered and reduced data from device 2
2024/12/17 17:37:30 Gathered and reduced data from device 3
2024/12/17 17:37:30 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:30 Broadcast complete to device 1
2024/12/17 17:37:30 Broadcast complete to device 2
2024/12/17 17:37:30 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 7.523292ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 25.653459ms
    gpu_test.go:1267: Running Tiny size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:30 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:30 Gathered and reduced data from device 1
2024/12/17 17:37:30 Gathered and reduced data from device 2
2024/12/17 17:37:30 Gathered and reduced data from device 3
2024/12/17 17:37:30 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:30 Broadcast complete to device 1
2024/12/17 17:37:30 Broadcast complete to device 2
2024/12/17 17:37:30 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.686833ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 26.906ms
    gpu_test.go:1267: Running Tiny size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:30 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:30 Gathered and reduced data from device 1
2024/12/17 17:37:30 Gathered and reduced data from device 2
2024/12/17 17:37:30 Gathered and reduced data from device 3
2024/12/17 17:37:30 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:30 Broadcast complete to device 1
2024/12/17 17:37:30 Broadcast complete to device 2
2024/12/17 17:37:30 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.49625ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 25.26075ms
    gpu_test.go:1267: Running Tiny size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:30 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:30 Gathered and reduced data from device 1
2024/12/17 17:37:30 Gathered and reduced data from device 2
2024/12/17 17:37:30 Gathered and reduced data from device 3
2024/12/17 17:37:30 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:30 Broadcast complete to device 1
2024/12/17 17:37:30 Broadcast complete to device 2
2024/12/17 17:37:30 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.719208ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 24.340291ms
    gpu_test.go:1267: Running Tiny size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:30 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:30 Gathered and reduced data from device 1
2024/12/17 17:37:30 Gathered and reduced data from device 2
2024/12/17 17:37:30 Gathered and reduced data from device 3
2024/12/17 17:37:30 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:30 Broadcast complete to device 1
2024/12/17 17:37:30 Broadcast complete to device 2
2024/12/17 17:37:30 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.829666ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 35.953458ms
    gpu_test.go:1358: 
        Performance comparison for Tiny size (1000 elements, 0.01 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 4.051049ms
    gpu_test.go:1361: Ring AllReduce:  27.622791ms
    gpu_test.go:1362: Speedup: 0.15x
=== RUN   TestAllReducePerformance/Small
    gpu_test.go:1267: Running Small size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:30 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:30 Gathered and reduced data from device 1
2024/12/17 17:37:30 Gathered and reduced data from device 2
2024/12/17 17:37:30 Gathered and reduced data from device 3
2024/12/17 17:37:30 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:30 Broadcast complete to device 1
2024/12/17 17:37:30 Broadcast complete to device 2
2024/12/17 17:37:30 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 6.644083ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 52.614125ms
    gpu_test.go:1267: Running Small size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:31 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:31 Gathered and reduced data from device 1
2024/12/17 17:37:31 Gathered and reduced data from device 2
2024/12/17 17:37:31 Gathered and reduced data from device 3
2024/12/17 17:37:31 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:31 Broadcast complete to device 1
2024/12/17 17:37:31 Broadcast complete to device 2
2024/12/17 17:37:31 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.538625ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 27.178ms
    gpu_test.go:1267: Running Small size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:31 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:31 Gathered and reduced data from device 1
2024/12/17 17:37:31 Gathered and reduced data from device 2
2024/12/17 17:37:31 Gathered and reduced data from device 3
2024/12/17 17:37:31 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:31 Broadcast complete to device 1
2024/12/17 17:37:31 Broadcast complete to device 2
2024/12/17 17:37:31 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 16.74425ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 70.241541ms
    gpu_test.go:1267: Running Small size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:31 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:31 Gathered and reduced data from device 1
2024/12/17 17:37:31 Gathered and reduced data from device 2
2024/12/17 17:37:31 Gathered and reduced data from device 3
2024/12/17 17:37:31 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:31 Broadcast complete to device 1
2024/12/17 17:37:31 Broadcast complete to device 2
2024/12/17 17:37:31 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.55825ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 30.045458ms
    gpu_test.go:1267: Running Small size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:31 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:31 Gathered and reduced data from device 1
2024/12/17 17:37:31 Gathered and reduced data from device 2
2024/12/17 17:37:31 Gathered and reduced data from device 3
2024/12/17 17:37:31 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:31 Broadcast complete to device 1
2024/12/17 17:37:31 Broadcast complete to device 2
2024/12/17 17:37:31 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.656917ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 27.688916ms
    gpu_test.go:1358: 
        Performance comparison for Small size (10000 elements, 0.08 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 7.428425ms
    gpu_test.go:1361: Ring AllReduce:  41.553608ms
    gpu_test.go:1362: Speedup: 0.18x
=== RUN   TestAllReducePerformance/Medium
    gpu_test.go:1267: Running Medium size iteration 1/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:31 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:31 Gathered and reduced data from device 1
2024/12/17 17:37:31 Gathered and reduced data from device 2
2024/12/17 17:37:31 Gathered and reduced data from device 3
2024/12/17 17:37:31 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:31 Broadcast complete to device 1
2024/12/17 17:37:31 Broadcast complete to device 2
2024/12/17 17:37:31 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 15.907542ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 29.022167ms
    gpu_test.go:1267: Running Medium size iteration 2/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:31 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:31 Gathered and reduced data from device 1
2024/12/17 17:37:31 Gathered and reduced data from device 2
2024/12/17 17:37:31 Gathered and reduced data from device 3
2024/12/17 17:37:31 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:31 Broadcast complete to device 1
2024/12/17 17:37:31 Broadcast complete to device 2
2024/12/17 17:37:31 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 19.890708ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 36.271792ms
    gpu_test.go:1267: Running Medium size iteration 3/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:32 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:32 Gathered and reduced data from device 1
2024/12/17 17:37:32 Gathered and reduced data from device 2
2024/12/17 17:37:32 Gathered and reduced data from device 3
2024/12/17 17:37:32 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:32 Broadcast complete to device 1
2024/12/17 17:37:32 Broadcast complete to device 2
2024/12/17 17:37:32 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 34.693791ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 55.468666ms
    gpu_test.go:1358: 
        Performance comparison for Medium size (50000 elements, 0.38 MB), averaged over 3 iterations:
    gpu_test.go:1360: Naive AllReduce: 23.497347ms
    gpu_test.go:1361: Ring AllReduce:  40.254208ms
    gpu_test.go:1362: Speedup: 0.58x
=== RUN   TestAllReducePerformance/Large
    gpu_test.go:1267: Running Large size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:37:32 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:37:32 Gathered and reduced data from device 1
2024/12/17 17:37:32 Gathered and reduced data from device 2
2024/12/17 17:37:32 Gathered and reduced data from device 3
2024/12/17 17:37:32 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:32 Broadcast complete to device 1
2024/12/17 17:37:32 Broadcast complete to device 2
2024/12/17 17:37:32 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 40.6585ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 39.357208ms
    gpu_test.go:1267: Running Large size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:37:32 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:37:32 Gathered and reduced data from device 1
2024/12/17 17:37:32 Gathered and reduced data from device 2
2024/12/17 17:37:32 Gathered and reduced data from device 3
2024/12/17 17:37:32 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:32 Broadcast complete to device 1
2024/12/17 17:37:32 Broadcast complete to device 2
2024/12/17 17:37:32 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 28.548ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 25.079292ms
    gpu_test.go:1358: 
        Performance comparison for Large size (100000 elements, 0.76 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 34.60325ms
    gpu_test.go:1361: Ring AllReduce:  32.21825ms
    gpu_test.go:1362: Speedup: 1.07x
=== RUN   TestAllReducePerformance/XLarge
    gpu_test.go:1267: Running XLarge size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:37:32 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:37:32 Gathered and reduced data from device 1
2024/12/17 17:37:32 Gathered and reduced data from device 2
2024/12/17 17:37:32 Gathered and reduced data from device 3
2024/12/17 17:37:32 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:32 Broadcast complete to device 1
2024/12/17 17:37:32 Broadcast complete to device 2
2024/12/17 17:37:32 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 19.335375ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 52.669583ms
    gpu_test.go:1267: Running XLarge size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:37:33 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:37:33 Gathered and reduced data from device 1
2024/12/17 17:37:33 Gathered and reduced data from device 2
2024/12/17 17:37:33 Gathered and reduced data from device 3
2024/12/17 17:37:33 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:33 Broadcast complete to device 1
2024/12/17 17:37:33 Broadcast complete to device 2
2024/12/17 17:37:33 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 52.878834ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 55.035666ms
    gpu_test.go:1358: 
        Performance comparison for XLarge size (200000 elements, 1.53 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 36.107104ms
    gpu_test.go:1361: Ring AllReduce:  53.852624ms
    gpu_test.go:1362: Speedup: 0.67x
=== RUN   TestAllReducePerformance/XXLarge
    gpu_test.go:1267: Running XXLarge size iteration 1/1...
    gpu_test.go:1305: Starting Naive AllReduce for size XXLarge...
2024/12/17 17:37:33 Naive AllReduce: Gathering all data to device 0 (data size: 3200000 bytes)
2024/12/17 17:37:33 Gathered and reduced data from device 1
2024/12/17 17:37:33 Gathered and reduced data from device 2
2024/12/17 17:37:33 Gathered and reduced data from device 3
2024/12/17 17:37:33 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:33 Broadcast complete to device 1
2024/12/17 17:37:33 Broadcast complete to device 2
2024/12/17 17:37:33 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 99.556292ms
    gpu_test.go:1322: Starting Ring AllReduce for size XXLarge...
    gpu_test.go:1343: Ring completed in 101.492625ms
    gpu_test.go:1358: 
        Performance comparison for XXLarge size (400000 elements, 3.05 MB), averaged over 1 iterations:
    gpu_test.go:1360: Naive AllReduce: 99.556292ms
    gpu_test.go:1361: Ring AllReduce:  101.492625ms
    gpu_test.go:1362: Speedup: 0.98x
--- PASS: TestAllReducePerformance (3.67s)
    --- PASS: TestAllReducePerformance/Tiny (0.79s)
    --- PASS: TestAllReducePerformance/Small (0.85s)
    --- PASS: TestAllReducePerformance/Medium (0.62s)
    --- PASS: TestAllReducePerformance/Large (0.43s)
    --- PASS: TestAllReducePerformance/XLarge (0.50s)
    --- PASS: TestAllReducePerformance/XXLarge (0.46s)
PASS
ok  	dsml/pkg/tests	4.083s
=== RUN   TestInitCommunicator
--- PASS: TestInitCommunicator (0.01s)
=== RUN   TestMemcpyToGPUs
--- PASS: TestMemcpyToGPUs (0.01s)
=== RUN   TestGroupOperations
--- PASS: TestGroupOperations (0.01s)
=== RUN   TestAllReduce
--- PASS: TestAllReduce (0.16s)
=== RUN   TestStatusChecking
--- PASS: TestStatusChecking (0.03s)
=== RUN   TestMemcpyFromGPU
--- PASS: TestMemcpyFromGPU (0.01s)
=== RUN   TestCompleteWorkflow
--- PASS: TestCompleteWorkflow (0.14s)
=== RUN   TestNaiveAllReduce
    gpu_test.go:987: Initializing device 0 with value 1.000000
    gpu_test.go:987: Initializing device 1 with value 2.000000
    gpu_test.go:987: Initializing device 2 with value 3.000000
    gpu_test.go:987: Initializing device 3 with value 4.000000
2024/12/17 17:37:34 Naive AllReduce: Gathering all data to device 0 (data size: 64 bytes)
2024/12/17 17:37:34 Gathered and reduced data from device 1
2024/12/17 17:37:34 Gathered and reduced data from device 2
2024/12/17 17:37:34 Gathered and reduced data from device 3
2024/12/17 17:37:34 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:34 Broadcast complete to device 1
2024/12/17 17:37:34 Broadcast complete to device 2
2024/12/17 17:37:34 Broadcast complete to device 3
    gpu_test.go:1048: Device 0 results verified
    gpu_test.go:1048: Device 1 results verified
    gpu_test.go:1048: Device 2 results verified
    gpu_test.go:1048: Device 3 results verified
--- PASS: TestNaiveAllReduce (0.02s)
=== RUN   TestAllReducePerformance
=== RUN   TestAllReducePerformance/Tiny
    gpu_test.go:1267: Running Tiny size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:34 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:34 Gathered and reduced data from device 1
2024/12/17 17:37:34 Gathered and reduced data from device 2
2024/12/17 17:37:34 Gathered and reduced data from device 3
2024/12/17 17:37:34 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:34 Broadcast complete to device 1
2024/12/17 17:37:34 Broadcast complete to device 2
2024/12/17 17:37:34 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.373708ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 24.765292ms
    gpu_test.go:1267: Running Tiny size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:34 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:34 Gathered and reduced data from device 1
2024/12/17 17:37:34 Gathered and reduced data from device 2
2024/12/17 17:37:34 Gathered and reduced data from device 3
2024/12/17 17:37:34 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:34 Broadcast complete to device 1
2024/12/17 17:37:34 Broadcast complete to device 2
2024/12/17 17:37:34 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.964ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 22.225959ms
    gpu_test.go:1267: Running Tiny size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:35 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:35 Gathered and reduced data from device 1
2024/12/17 17:37:35 Gathered and reduced data from device 2
2024/12/17 17:37:35 Gathered and reduced data from device 3
2024/12/17 17:37:35 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:35 Broadcast complete to device 1
2024/12/17 17:37:35 Broadcast complete to device 2
2024/12/17 17:37:35 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.308042ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 28.338292ms
    gpu_test.go:1267: Running Tiny size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:35 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:35 Gathered and reduced data from device 1
2024/12/17 17:37:35 Gathered and reduced data from device 2
2024/12/17 17:37:35 Gathered and reduced data from device 3
2024/12/17 17:37:35 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:35 Broadcast complete to device 1
2024/12/17 17:37:35 Broadcast complete to device 2
2024/12/17 17:37:35 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.399167ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 27.557875ms
    gpu_test.go:1267: Running Tiny size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:35 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:35 Gathered and reduced data from device 1
2024/12/17 17:37:35 Gathered and reduced data from device 2
2024/12/17 17:37:35 Gathered and reduced data from device 3
2024/12/17 17:37:35 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:35 Broadcast complete to device 1
2024/12/17 17:37:35 Broadcast complete to device 2
2024/12/17 17:37:35 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.41425ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 26.106625ms
    gpu_test.go:1358: 
        Performance comparison for Tiny size (1000 elements, 0.01 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 4.491833ms
    gpu_test.go:1361: Ring AllReduce:  25.798808ms
    gpu_test.go:1362: Speedup: 0.17x
=== RUN   TestAllReducePerformance/Small
    gpu_test.go:1267: Running Small size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:35 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:35 Gathered and reduced data from device 1
2024/12/17 17:37:35 Gathered and reduced data from device 2
2024/12/17 17:37:35 Gathered and reduced data from device 3
2024/12/17 17:37:35 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:35 Broadcast complete to device 1
2024/12/17 17:37:35 Broadcast complete to device 2
2024/12/17 17:37:35 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 7.518833ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 32.7765ms
    gpu_test.go:1267: Running Small size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:35 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:35 Gathered and reduced data from device 1
2024/12/17 17:37:35 Gathered and reduced data from device 2
2024/12/17 17:37:35 Gathered and reduced data from device 3
2024/12/17 17:37:35 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:35 Broadcast complete to device 1
2024/12/17 17:37:35 Broadcast complete to device 2
2024/12/17 17:37:35 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.102875ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 30.695916ms
    gpu_test.go:1267: Running Small size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:35 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:35 Gathered and reduced data from device 1
2024/12/17 17:37:35 Gathered and reduced data from device 2
2024/12/17 17:37:35 Gathered and reduced data from device 3
2024/12/17 17:37:35 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:35 Broadcast complete to device 1
2024/12/17 17:37:35 Broadcast complete to device 2
2024/12/17 17:37:35 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 20.857583ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 38.2465ms
    gpu_test.go:1267: Running Small size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:36 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:36 Gathered and reduced data from device 1
2024/12/17 17:37:36 Gathered and reduced data from device 2
2024/12/17 17:37:36 Gathered and reduced data from device 3
2024/12/17 17:37:36 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:36 Broadcast complete to device 1
2024/12/17 17:37:36 Broadcast complete to device 2
2024/12/17 17:37:36 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 9.4395ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 29.901834ms
    gpu_test.go:1267: Running Small size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:36 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:36 Gathered and reduced data from device 1
2024/12/17 17:37:36 Gathered and reduced data from device 2
2024/12/17 17:37:36 Gathered and reduced data from device 3
2024/12/17 17:37:36 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:36 Broadcast complete to device 1
2024/12/17 17:37:36 Broadcast complete to device 2
2024/12/17 17:37:36 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.297292ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 26.110708ms
    gpu_test.go:1358: 
        Performance comparison for Small size (10000 elements, 0.08 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 9.643216ms
    gpu_test.go:1361: Ring AllReduce:  31.546291ms
    gpu_test.go:1362: Speedup: 0.31x
=== RUN   TestAllReducePerformance/Medium
    gpu_test.go:1267: Running Medium size iteration 1/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:36 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:36 Gathered and reduced data from device 1
2024/12/17 17:37:36 Gathered and reduced data from device 2
2024/12/17 17:37:36 Gathered and reduced data from device 3
2024/12/17 17:37:36 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:36 Broadcast complete to device 1
2024/12/17 17:37:36 Broadcast complete to device 2
2024/12/17 17:37:36 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 22.767375ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 32.909125ms
    gpu_test.go:1267: Running Medium size iteration 2/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:36 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:36 Gathered and reduced data from device 1
2024/12/17 17:37:36 Gathered and reduced data from device 2
2024/12/17 17:37:36 Gathered and reduced data from device 3
2024/12/17 17:37:36 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:36 Broadcast complete to device 1
2024/12/17 17:37:36 Broadcast complete to device 2
2024/12/17 17:37:36 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 25.663958ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 74.593625ms
    gpu_test.go:1267: Running Medium size iteration 3/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:36 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:36 Gathered and reduced data from device 1
2024/12/17 17:37:36 Gathered and reduced data from device 2
2024/12/17 17:37:36 Gathered and reduced data from device 3
2024/12/17 17:37:36 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:36 Broadcast complete to device 1
2024/12/17 17:37:36 Broadcast complete to device 2
2024/12/17 17:37:36 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.738833ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 28.908791ms
    gpu_test.go:1358: 
        Performance comparison for Medium size (50000 elements, 0.38 MB), averaged over 3 iterations:
    gpu_test.go:1360: Naive AllReduce: 18.056722ms
    gpu_test.go:1361: Ring AllReduce:  45.470513ms
    gpu_test.go:1362: Speedup: 0.40x
=== RUN   TestAllReducePerformance/Large
    gpu_test.go:1267: Running Large size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:37:37 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:37:37 Gathered and reduced data from device 1
2024/12/17 17:37:37 Gathered and reduced data from device 2
2024/12/17 17:37:37 Gathered and reduced data from device 3
2024/12/17 17:37:37 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:37 Broadcast complete to device 1
2024/12/17 17:37:37 Broadcast complete to device 2
2024/12/17 17:37:37 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 12.655458ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 58.768459ms
    gpu_test.go:1267: Running Large size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:37:37 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:37:37 Gathered and reduced data from device 1
2024/12/17 17:37:37 Gathered and reduced data from device 2
2024/12/17 17:37:37 Gathered and reduced data from device 3
2024/12/17 17:37:37 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:37 Broadcast complete to device 1
2024/12/17 17:37:37 Broadcast complete to device 2
2024/12/17 17:37:37 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 23.257208ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 34.153416ms
    gpu_test.go:1358: 
        Performance comparison for Large size (100000 elements, 0.76 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 17.956333ms
    gpu_test.go:1361: Ring AllReduce:  46.460937ms
    gpu_test.go:1362: Speedup: 0.39x
=== RUN   TestAllReducePerformance/XLarge
    gpu_test.go:1267: Running XLarge size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:37:37 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:37:37 Gathered and reduced data from device 1
2024/12/17 17:37:37 Gathered and reduced data from device 2
2024/12/17 17:37:37 Gathered and reduced data from device 3
2024/12/17 17:37:37 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:37 Broadcast complete to device 1
2024/12/17 17:37:37 Broadcast complete to device 2
2024/12/17 17:37:37 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 59.027084ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 36.602292ms
    gpu_test.go:1267: Running XLarge size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:37:37 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:37:37 Gathered and reduced data from device 1
2024/12/17 17:37:37 Gathered and reduced data from device 2
2024/12/17 17:37:37 Gathered and reduced data from device 3
2024/12/17 17:37:37 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:37 Broadcast complete to device 1
2024/12/17 17:37:37 Broadcast complete to device 2
2024/12/17 17:37:37 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 18.36175ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 55.993667ms
    gpu_test.go:1358: 
        Performance comparison for XLarge size (200000 elements, 1.53 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 38.694417ms
    gpu_test.go:1361: Ring AllReduce:  46.297979ms
    gpu_test.go:1362: Speedup: 0.84x
=== RUN   TestAllReducePerformance/XXLarge
    gpu_test.go:1267: Running XXLarge size iteration 1/1...
    gpu_test.go:1305: Starting Naive AllReduce for size XXLarge...
2024/12/17 17:37:37 Naive AllReduce: Gathering all data to device 0 (data size: 3200000 bytes)
2024/12/17 17:37:37 Gathered and reduced data from device 1
2024/12/17 17:37:37 Gathered and reduced data from device 2
2024/12/17 17:37:37 Gathered and reduced data from device 3
2024/12/17 17:37:37 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:37 Broadcast complete to device 1
2024/12/17 17:37:38 Broadcast complete to device 2
2024/12/17 17:37:38 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 96.099375ms
    gpu_test.go:1322: Starting Ring AllReduce for size XXLarge...
    gpu_test.go:1343: Ring completed in 38.739625ms
    gpu_test.go:1358: 
        Performance comparison for XXLarge size (400000 elements, 3.05 MB), averaged over 1 iterations:
    gpu_test.go:1360: Naive AllReduce: 96.099375ms
    gpu_test.go:1361: Ring AllReduce:  38.739625ms
    gpu_test.go:1362: Speedup: 2.48x
--- PASS: TestAllReducePerformance (3.50s)
    --- PASS: TestAllReducePerformance/Tiny (0.78s)
    --- PASS: TestAllReducePerformance/Small (0.89s)
    --- PASS: TestAllReducePerformance/Medium (0.60s)
    --- PASS: TestAllReducePerformance/Large (0.44s)
    --- PASS: TestAllReducePerformance/XLarge (0.45s)
    --- PASS: TestAllReducePerformance/XXLarge (0.33s)
PASS
ok  	dsml/pkg/tests	3.915s
=== RUN   TestInitCommunicator
--- PASS: TestInitCommunicator (0.01s)
=== RUN   TestMemcpyToGPUs
--- PASS: TestMemcpyToGPUs (0.00s)
=== RUN   TestGroupOperations
--- PASS: TestGroupOperations (0.00s)
=== RUN   TestAllReduce
--- PASS: TestAllReduce (0.14s)
=== RUN   TestStatusChecking
--- PASS: TestStatusChecking (0.02s)
=== RUN   TestMemcpyFromGPU
--- PASS: TestMemcpyFromGPU (0.02s)
=== RUN   TestCompleteWorkflow
--- PASS: TestCompleteWorkflow (0.13s)
=== RUN   TestNaiveAllReduce
    gpu_test.go:987: Initializing device 0 with value 1.000000
    gpu_test.go:987: Initializing device 1 with value 2.000000
    gpu_test.go:987: Initializing device 2 with value 3.000000
    gpu_test.go:987: Initializing device 3 with value 4.000000
2024/12/17 17:37:39 Naive AllReduce: Gathering all data to device 0 (data size: 64 bytes)
2024/12/17 17:37:39 Gathered and reduced data from device 1
2024/12/17 17:37:39 Gathered and reduced data from device 2
2024/12/17 17:37:39 Gathered and reduced data from device 3
2024/12/17 17:37:39 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:39 Broadcast complete to device 1
2024/12/17 17:37:39 Broadcast complete to device 2
2024/12/17 17:37:39 Broadcast complete to device 3
    gpu_test.go:1048: Device 0 results verified
    gpu_test.go:1048: Device 1 results verified
    gpu_test.go:1048: Device 2 results verified
    gpu_test.go:1048: Device 3 results verified
--- PASS: TestNaiveAllReduce (0.02s)
=== RUN   TestAllReducePerformance
=== RUN   TestAllReducePerformance/Tiny
    gpu_test.go:1267: Running Tiny size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:39 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:39 Gathered and reduced data from device 1
2024/12/17 17:37:39 Gathered and reduced data from device 2
2024/12/17 17:37:39 Gathered and reduced data from device 3
2024/12/17 17:37:39 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:39 Broadcast complete to device 1
2024/12/17 17:37:39 Broadcast complete to device 2
2024/12/17 17:37:39 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 3.091583ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 35.666084ms
    gpu_test.go:1267: Running Tiny size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:39 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:39 Gathered and reduced data from device 1
2024/12/17 17:37:39 Gathered and reduced data from device 2
2024/12/17 17:37:39 Gathered and reduced data from device 3
2024/12/17 17:37:39 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:39 Broadcast complete to device 1
2024/12/17 17:37:39 Broadcast complete to device 2
2024/12/17 17:37:39 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.782625ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 27.723083ms
    gpu_test.go:1267: Running Tiny size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:39 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:39 Gathered and reduced data from device 1
2024/12/17 17:37:39 Gathered and reduced data from device 2
2024/12/17 17:37:39 Gathered and reduced data from device 3
2024/12/17 17:37:39 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:39 Broadcast complete to device 1
2024/12/17 17:37:39 Broadcast complete to device 2
2024/12/17 17:37:39 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.5005ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 30.312459ms
    gpu_test.go:1267: Running Tiny size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:39 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:39 Gathered and reduced data from device 1
2024/12/17 17:37:39 Gathered and reduced data from device 2
2024/12/17 17:37:39 Gathered and reduced data from device 3
2024/12/17 17:37:39 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:39 Broadcast complete to device 1
2024/12/17 17:37:39 Broadcast complete to device 2
2024/12/17 17:37:39 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.095667ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 24.854625ms
    gpu_test.go:1267: Running Tiny size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Tiny...
2024/12/17 17:37:39 Naive AllReduce: Gathering all data to device 0 (data size: 8000 bytes)
2024/12/17 17:37:39 Gathered and reduced data from device 1
2024/12/17 17:37:39 Gathered and reduced data from device 2
2024/12/17 17:37:39 Gathered and reduced data from device 3
2024/12/17 17:37:39 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:39 Broadcast complete to device 1
2024/12/17 17:37:39 Broadcast complete to device 2
2024/12/17 17:37:39 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 2.869125ms
    gpu_test.go:1322: Starting Ring AllReduce for size Tiny...
    gpu_test.go:1343: Ring completed in 22.226416ms
    gpu_test.go:1358: 
        Performance comparison for Tiny size (1000 elements, 0.01 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 3.8679ms
    gpu_test.go:1361: Ring AllReduce:  28.156533ms
    gpu_test.go:1362: Speedup: 0.14x
=== RUN   TestAllReducePerformance/Small
    gpu_test.go:1267: Running Small size iteration 1/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:39 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:39 Gathered and reduced data from device 1
2024/12/17 17:37:39 Gathered and reduced data from device 2
2024/12/17 17:37:39 Gathered and reduced data from device 3
2024/12/17 17:37:39 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:39 Broadcast complete to device 1
2024/12/17 17:37:39 Broadcast complete to device 2
2024/12/17 17:37:39 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 13.158375ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 26.732084ms
    gpu_test.go:1267: Running Small size iteration 2/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:40 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:40 Gathered and reduced data from device 1
2024/12/17 17:37:40 Gathered and reduced data from device 2
2024/12/17 17:37:40 Gathered and reduced data from device 3
2024/12/17 17:37:40 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:40 Broadcast complete to device 1
2024/12/17 17:37:40 Broadcast complete to device 2
2024/12/17 17:37:40 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.277208ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 30.990417ms
    gpu_test.go:1267: Running Small size iteration 3/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:40 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:40 Gathered and reduced data from device 1
2024/12/17 17:37:40 Gathered and reduced data from device 2
2024/12/17 17:37:40 Gathered and reduced data from device 3
2024/12/17 17:37:40 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:40 Broadcast complete to device 1
2024/12/17 17:37:40 Broadcast complete to device 2
2024/12/17 17:37:40 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 4.392458ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 28.33925ms
    gpu_test.go:1267: Running Small size iteration 4/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:40 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:40 Gathered and reduced data from device 1
2024/12/17 17:37:40 Gathered and reduced data from device 2
2024/12/17 17:37:40 Gathered and reduced data from device 3
2024/12/17 17:37:40 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:40 Broadcast complete to device 1
2024/12/17 17:37:40 Broadcast complete to device 2
2024/12/17 17:37:40 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.878875ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 22.250208ms
    gpu_test.go:1267: Running Small size iteration 5/5...
    gpu_test.go:1305: Starting Naive AllReduce for size Small...
2024/12/17 17:37:40 Naive AllReduce: Gathering all data to device 0 (data size: 80000 bytes)
2024/12/17 17:37:40 Gathered and reduced data from device 1
2024/12/17 17:37:40 Gathered and reduced data from device 2
2024/12/17 17:37:40 Gathered and reduced data from device 3
2024/12/17 17:37:40 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:40 Broadcast complete to device 1
2024/12/17 17:37:40 Broadcast complete to device 2
2024/12/17 17:37:40 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 5.195042ms
    gpu_test.go:1322: Starting Ring AllReduce for size Small...
    gpu_test.go:1343: Ring completed in 27.561542ms
    gpu_test.go:1358: 
        Performance comparison for Small size (10000 elements, 0.08 MB), averaged over 5 iterations:
    gpu_test.go:1360: Naive AllReduce: 6.580391ms
    gpu_test.go:1361: Ring AllReduce:  27.1747ms
    gpu_test.go:1362: Speedup: 0.24x
=== RUN   TestAllReducePerformance/Medium
    gpu_test.go:1267: Running Medium size iteration 1/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:40 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:40 Gathered and reduced data from device 1
2024/12/17 17:37:40 Gathered and reduced data from device 2
2024/12/17 17:37:40 Gathered and reduced data from device 3
2024/12/17 17:37:40 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:40 Broadcast complete to device 1
2024/12/17 17:37:40 Broadcast complete to device 2
2024/12/17 17:37:40 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 20.25ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 39.040459ms
    gpu_test.go:1267: Running Medium size iteration 2/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:40 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:40 Gathered and reduced data from device 1
2024/12/17 17:37:40 Gathered and reduced data from device 2
2024/12/17 17:37:40 Gathered and reduced data from device 3
2024/12/17 17:37:40 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:40 Broadcast complete to device 1
2024/12/17 17:37:40 Broadcast complete to device 2
2024/12/17 17:37:40 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 13.037125ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 41.125291ms
    gpu_test.go:1267: Running Medium size iteration 3/3...
    gpu_test.go:1305: Starting Naive AllReduce for size Medium...
2024/12/17 17:37:41 Naive AllReduce: Gathering all data to device 0 (data size: 400000 bytes)
2024/12/17 17:37:41 Gathered and reduced data from device 1
2024/12/17 17:37:41 Gathered and reduced data from device 2
2024/12/17 17:37:41 Gathered and reduced data from device 3
2024/12/17 17:37:41 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:41 Broadcast complete to device 1
2024/12/17 17:37:41 Broadcast complete to device 2
2024/12/17 17:37:41 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 6.212459ms
    gpu_test.go:1322: Starting Ring AllReduce for size Medium...
    gpu_test.go:1343: Ring completed in 24.7165ms
    gpu_test.go:1358: 
        Performance comparison for Medium size (50000 elements, 0.38 MB), averaged over 3 iterations:
    gpu_test.go:1360: Naive AllReduce: 13.166528ms
    gpu_test.go:1361: Ring AllReduce:  34.96075ms
    gpu_test.go:1362: Speedup: 0.38x
=== RUN   TestAllReducePerformance/Large
    gpu_test.go:1267: Running Large size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:37:41 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:37:41 Gathered and reduced data from device 1
2024/12/17 17:37:41 Gathered and reduced data from device 2
2024/12/17 17:37:41 Gathered and reduced data from device 3
2024/12/17 17:37:41 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:41 Broadcast complete to device 1
2024/12/17 17:37:41 Broadcast complete to device 2
2024/12/17 17:37:41 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 30.791375ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 63.262583ms
    gpu_test.go:1267: Running Large size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size Large...
2024/12/17 17:37:41 Naive AllReduce: Gathering all data to device 0 (data size: 800000 bytes)
2024/12/17 17:37:41 Gathered and reduced data from device 1
2024/12/17 17:37:41 Gathered and reduced data from device 2
2024/12/17 17:37:41 Gathered and reduced data from device 3
2024/12/17 17:37:41 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:41 Broadcast complete to device 1
2024/12/17 17:37:41 Broadcast complete to device 2
2024/12/17 17:37:41 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 38.844708ms
    gpu_test.go:1322: Starting Ring AllReduce for size Large...
    gpu_test.go:1343: Ring completed in 32.685375ms
    gpu_test.go:1358: 
        Performance comparison for Large size (100000 elements, 0.76 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 34.818041ms
    gpu_test.go:1361: Ring AllReduce:  47.973979ms
    gpu_test.go:1362: Speedup: 0.73x
=== RUN   TestAllReducePerformance/XLarge
    gpu_test.go:1267: Running XLarge size iteration 1/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:37:41 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:37:41 Gathered and reduced data from device 1
2024/12/17 17:37:41 Gathered and reduced data from device 2
2024/12/17 17:37:41 Gathered and reduced data from device 3
2024/12/17 17:37:41 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:41 Broadcast complete to device 1
2024/12/17 17:37:41 Broadcast complete to device 2
2024/12/17 17:37:41 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 35.30425ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 39.015042ms
    gpu_test.go:1267: Running XLarge size iteration 2/2...
    gpu_test.go:1305: Starting Naive AllReduce for size XLarge...
2024/12/17 17:37:41 Naive AllReduce: Gathering all data to device 0 (data size: 1600000 bytes)
2024/12/17 17:37:41 Gathered and reduced data from device 1
2024/12/17 17:37:41 Gathered and reduced data from device 2
2024/12/17 17:37:41 Gathered and reduced data from device 3
2024/12/17 17:37:41 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:41 Broadcast complete to device 1
2024/12/17 17:37:41 Broadcast complete to device 2
2024/12/17 17:37:41 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 20.948959ms
    gpu_test.go:1322: Starting Ring AllReduce for size XLarge...
    gpu_test.go:1343: Ring completed in 46.129708ms
    gpu_test.go:1358: 
        Performance comparison for XLarge size (200000 elements, 1.53 MB), averaged over 2 iterations:
    gpu_test.go:1360: Naive AllReduce: 28.126604ms
    gpu_test.go:1361: Ring AllReduce:  42.572375ms
    gpu_test.go:1362: Speedup: 0.66x
=== RUN   TestAllReducePerformance/XXLarge
    gpu_test.go:1267: Running XXLarge size iteration 1/1...
    gpu_test.go:1305: Starting Naive AllReduce for size XXLarge...
2024/12/17 17:37:42 Naive AllReduce: Gathering all data to device 0 (data size: 3200000 bytes)
2024/12/17 17:37:42 Gathered and reduced data from device 1
2024/12/17 17:37:42 Gathered and reduced data from device 2
2024/12/17 17:37:42 Gathered and reduced data from device 3
2024/12/17 17:37:42 Naive AllReduce: Broadcasting reduced result to all devices
2024/12/17 17:37:42 Broadcast complete to device 1
2024/12/17 17:37:42 Broadcast complete to device 2
2024/12/17 17:37:42 Broadcast complete to device 3
    gpu_test.go:1318: Naive completed in 94.515125ms
    gpu_test.go:1322: Starting Ring AllReduce for size XXLarge...
    gpu_test.go:1343: Ring completed in 81.662709ms
    gpu_test.go:1358: 
        Performance comparison for XXLarge size (400000 elements, 3.05 MB), averaged over 1 iterations:
    gpu_test.go:1360: Naive AllReduce: 94.515125ms
    gpu_test.go:1361: Ring AllReduce:  81.662709ms
    gpu_test.go:1362: Speedup: 1.16x
--- PASS: TestAllReducePerformance (3.39s)
    --- PASS: TestAllReducePerformance/Tiny (0.77s)
    --- PASS: TestAllReducePerformance/Small (0.78s)
    --- PASS: TestAllReducePerformance/Medium (0.58s)
    --- PASS: TestAllReducePerformance/Large (0.45s)
    --- PASS: TestAllReducePerformance/XLarge (0.41s)
    --- PASS: TestAllReducePerformance/XXLarge (0.39s)
PASS
ok  	dsml/pkg/tests	3.807s
